
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Random Input &#8212; Quantum Simulation Cookbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css?v=ca93fcec" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'random_input';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Quantum Simulation Cookbook - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Quantum Simulation Cookbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Quantum Simulation Cookbook
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Basics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="state.html">States</a></li>
<li class="toctree-l1"><a class="reference internal" href="operator.html">Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="quantities.html">Quantities</a></li>
<li class="toctree-l1"><a class="reference internal" href="channel.html">Channels</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Hamiltonians</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="spin.html">Spin</a></li>
<li class="toctree-l1"><a class="reference internal" href="fermion.html">Fermion</a></li>
<li class="toctree-l1"><a class="reference internal" href="field.html">Gauge Field</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Product Formula</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="grouping.html">Grouping</a></li>
<li class="toctree-l1"><a class="reference internal" href="ordering.html">Ordering</a></li>
<li class="toctree-l1"><a class="reference internal" href="interference.html">Error interference</a></li>
<li class="toctree-l1"><a class="reference internal" href="localization.html">Error Localization</a></li>
<li class="toctree-l1"><a class="reference internal" href="average.html">Average error</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">LCU</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="anticommute.html">Anti-commutation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Classical simulation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="tensor_network.html">Tensor-network</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ground.html">Ground state</a></li>
<li class="toctree-l1"><a class="reference internal" href="phase_transition.html">Phase transition</a></li>
<li class="toctree-l1"><a class="reference internal" href="phase_estimation.html">Phase estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="open.html">Open system</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Frandom_input.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/random_input.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Random Input</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#power-law-interaction">Power-law interaction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nearest-neighbor-interaction">Nearest-neighbor interaction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transver-field-ising-tfi">Transver-field Ising (TFI)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#worst-input-largest-singular-value">Worst input (largest singular value)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#error-vs-time">Error VS time</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chemistry">Chemistry</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ising-model-with-three-kinds-of-observables-qiskit-code">Ising model with three kinds of observables (Qiskit code)</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="random-input">
<h1>Random Input<a class="headerlink" href="#random-input" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">spin_ham</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">bounds</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">trotter</span> <span class="kn">import</span> <span class="o">*</span>

<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">from</span> <span class="nn">qiskit.quantum_info</span> <span class="kn">import</span> <span class="n">random_statevector</span>

<span class="n">figs_dir</span><span class="p">,</span> <span class="n">data_dir</span> <span class="o">=</span> <span class="s1">&#39;./figs&#39;</span><span class="p">,</span> <span class="s1">&#39;./data&#39;</span>
</pre></div>
</div>
</div>
</div>
<section id="power-law-interaction">
<h2>Power-law interaction<a class="headerlink" href="#power-law-interaction" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pow_test</span> <span class="o">=</span> <span class="n">Power_law</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">Jx</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">Jy</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">Jz</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">hx</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">hy</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">hz</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">pbc</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">pow_test</span><span class="o">.</span><span class="n">ham</span>
<span class="n">pow_test</span><span class="o">.</span><span class="n">ham_xyz</span>
<span class="c1"># commutator(pow_test.ham_xyz[0], pow_test.ham_xyz[1]).simplify()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[SparsePauliOp([&#39;IIIXX&#39;, &#39;IIXIX&#39;, &#39;IXIIX&#39;, &#39;XIIIX&#39;, &#39;IIXXI&#39;, &#39;IXIXI&#39;, &#39;XIIXI&#39;, &#39;IXXII&#39;, &#39;XIXII&#39;, &#39;XXIII&#39;],
               coeffs=[-1.      +0.j, -0.0625  +0.j, -0.012346+0.j, -0.003906+0.j, -1.      +0.j,
  -0.0625  +0.j, -0.012346+0.j, -1.      +0.j, -0.0625  +0.j, -1.      +0.j]),
 SparsePauliOp([&#39;IIIYY&#39;, &#39;IIYIY&#39;, &#39;IYIIY&#39;, &#39;YIIIY&#39;, &#39;IIYYI&#39;, &#39;IYIYI&#39;, &#39;YIIYI&#39;, &#39;IYYII&#39;, &#39;YIYII&#39;, &#39;YYIII&#39;],
               coeffs=[-1.      +0.j, -0.0625  +0.j, -0.012346+0.j, -0.003906+0.j, -1.      +0.j,
  -0.0625  +0.j, -0.012346+0.j, -1.      +0.j, -0.0625  +0.j, -1.      +0.j]),
 SparsePauliOp([&#39;IIIZZ&#39;, &#39;IIZIZ&#39;, &#39;IZIIZ&#39;, &#39;ZIIIZ&#39;, &#39;IIZZI&#39;, &#39;IZIZI&#39;, &#39;ZIIZI&#39;, &#39;IZZII&#39;, &#39;ZIZII&#39;, &#39;ZZIII&#39;, &#39;IIIIZ&#39;, &#39;IIIZI&#39;, &#39;IIZII&#39;, &#39;IZIII&#39;, &#39;ZIIII&#39;],
               coeffs=[-1.      +0.j, -0.0625  +0.j, -0.012346+0.j, -0.003906+0.j, -1.      +0.j,
  -0.0625  +0.j, -0.012346+0.j, -1.      +0.j, -0.0625  +0.j, -1.      +0.j,
  -0.5     +0.j, -0.5     +0.j, -0.5     +0.j, -0.5     +0.j, -0.5     +0.j])]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">SparsePauliOp</span><span class="o">.</span><span class="n">from_sparse_list</span><span class="p">([(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)],</span> <span class="n">n</span><span class="p">),</span> <span class="nb">ord</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="nn">----&gt; 1 np.linalg.norm(SparsePauliOp.from_sparse_list([(&#39;Z&#39;, [i], 1) for i</span> in <span class="ni">range</span><span class="nt">(0, n)], n), ord=2)</span>

<span class="ne">NameError</span>: name &#39;n&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prefix</span><span class="p">,</span> <span class="n">suffix</span> <span class="o">=</span> <span class="s1">&#39;Pow&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span>
<span class="n">n_max</span> <span class="o">=</span> <span class="mi">9</span> 
<span class="n">r</span> <span class="o">=</span> <span class="mi">10000</span> <span class="c1"># 5000</span>
<span class="n">eps</span> <span class="o">=</span> <span class="mf">1e-3</span>
<span class="n">n_sample</span><span class="p">,</span> <span class="n">n_round</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">10</span>
<span class="n">m_sample</span> <span class="o">=</span> <span class="n">n_sample</span> <span class="o">*</span> <span class="n">n_round</span>
<span class="n">n_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">n_max</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="n">data_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;emp_worst&#39;</span><span class="p">,</span> <span class="s1">&#39;emp_averg&#39;</span><span class="p">,</span> <span class="s1">&#39;emp_averg_std&#39;</span><span class="p">,</span> <span class="s1">&#39;emp_averg_magn&#39;</span><span class="p">,</span> <span class="s1">&#39;emp_averg_corr&#39;</span><span class="p">,</span> <span class="s1">&#39;emp_averg_magn_std&#39;</span><span class="p">,</span> <span class="s1">&#39;emp_averg_corr_std&#39;</span><span class="p">,</span> <span class="s1">&#39;bnd_worst&#39;</span><span class="p">,</span> <span class="s1">&#39;bnd_averg&#39;</span><span class="p">,</span> <span class="s1">&#39;bnd_averg_magn&#39;</span><span class="p">,</span> <span class="s1">&#39;bnd_averg_corr&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">k</span><span class="p">,</span> <span class="p">[])</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">data_keys</span><span class="p">])</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_list</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">n_list</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;------ n = </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s1"> ------&#39;</span><span class="p">)</span>
    <span class="n">pow_law</span> <span class="o">=</span> <span class="n">Power_law</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">Jx</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">Jy</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">Jz</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">hx</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">hy</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">hz</span><span class="o">=-</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">pbc</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># print(&#39;xyz group: &#39;, pow_law.ham_xyz)</span>
    <span class="c1"># norm4 = nested_commutator_4norm([pow_law.ham_xyz[0], pow_law.ham_xyz[2]], p=2)</span>
    <span class="c1"># print(&#39;eeee:&#39;, norm4)</span>
    <span class="c1"># norm4_list.append(norm4)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">n</span>
    <span class="n">corr_op</span> <span class="o">=</span> <span class="n">SparsePauliOp</span><span class="o">.</span><span class="n">from_sparse_list</span><span class="p">([(</span><span class="s1">&#39;ZZ&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span> <span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span>
    <span class="n">magn_op</span> <span class="o">=</span> <span class="n">SparsePauliOp</span><span class="o">.</span><span class="n">from_sparse_list</span><span class="p">([(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)],</span> <span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span>
    <span class="c1"># xyz_group = [h.to_matrix() for h in pow_law.ham_xyz]</span>
    <span class="n">xyz_group</span> <span class="o">=</span> <span class="p">[</span><span class="n">h</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">pow_law</span><span class="o">.</span><span class="n">ham_xyz</span><span class="p">]</span>
    <span class="c1"># rand_states = [random_statevector(2**n) for _ in range(n_sample)]</span>
    <span class="c1"># print(rand_states)</span>
    <span class="n">exact_U</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">([</span><span class="n">h</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">pow_law</span><span class="o">.</span><span class="n">ham_xyz</span><span class="p">]))</span>

    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_worst&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">measure_error</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">xyz_group</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">exact_U</span><span class="p">,</span> <span class="s1">&#39;worst_empirical&#39;</span><span class="p">))</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bnd_worst&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">measure_error</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">xyz_group</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">exact_U</span><span class="p">,</span> <span class="s1">&#39;worst_bound&#39;</span><span class="p">))</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bnd_averg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">measure_error</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">xyz_group</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">exact_U</span><span class="p">,</span> <span class="s1">&#39;average_bound&#39;</span><span class="p">))</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bnd_averg_magn&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">measure_error</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">xyz_group</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">exact_U</span><span class="p">,</span> <span class="s1">&#39;average_ob_bound&#39;</span><span class="p">,</span> <span class="n">ob</span><span class="o">=</span><span class="n">magn_op</span><span class="p">))</span>
    <span class="c1"># data[&#39;bnd_averg_magn_nc&#39;].append(measure_error(r, xyz_group, t, exact_U, &#39;average_ob_bound_nc&#39;, ob=magn_op))</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bnd_averg_corr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">measure_error</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">xyz_group</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">exact_U</span><span class="p">,</span> <span class="s1">&#39;average_ob_bound&#39;</span><span class="p">,</span> <span class="n">ob</span><span class="o">=</span><span class="n">corr_op</span><span class="p">))</span>

    <span class="n">magn_list</span><span class="p">,</span> <span class="n">corr_list</span><span class="p">,</span> <span class="n">stat_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----empirical observable error----&#39;</span><span class="p">)</span>
    <span class="n">rand_states</span> <span class="o">=</span> <span class="p">[</span><span class="n">random_statevector</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m_sample</span><span class="p">)]</span>
    <span class="n">stat_list</span> <span class="o">=</span> <span class="n">measure_error</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">xyz_group</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">exact_U</span><span class="p">,</span> <span class="s1">&#39;average_empirical&#39;</span><span class="p">,</span> <span class="n">rand_states</span><span class="o">=</span><span class="n">rand_states</span><span class="p">,</span> <span class="n">return_error_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ob</span><span class="o">=</span><span class="n">magn_op</span><span class="p">)</span>
    <span class="c1"># stat_list = n * measure_error(r, xyz_group, t, exact_U, &#39;average_empirical&#39;, rand_states=rand_states, return_error_list=True)</span>
    <span class="n">magn_list</span> <span class="o">=</span> <span class="n">measure_error</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">xyz_group</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">exact_U</span><span class="p">,</span> <span class="s1">&#39;average_ob_empirical&#39;</span><span class="p">,</span> <span class="n">rand_states</span><span class="o">=</span><span class="n">rand_states</span><span class="p">,</span> <span class="n">ob</span><span class="o">=</span><span class="n">magn_op</span><span class="p">,</span> <span class="n">return_error_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">corr_list</span> <span class="o">=</span> <span class="n">measure_error</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">xyz_group</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">exact_U</span><span class="p">,</span> <span class="s1">&#39;average_ob_empirical&#39;</span><span class="p">,</span> <span class="n">rand_states</span><span class="o">=</span><span class="n">rand_states</span><span class="p">,</span> <span class="n">ob</span><span class="o">=</span><span class="n">corr_op</span><span class="p">,</span> <span class="n">return_error_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># for _ in range(n_round):</span>
    <span class="c1">#     print(&#39;+&#39;, end=&#39;&#39;)</span>
        <span class="c1"># rand_states = [random_statevector(2**n) for _ in range(n_sample)]</span>

        <span class="c1"># stat_list.append(n * measure_error(r, xyz_group, t, exact_U, &#39;average_empirical&#39;, rand_states=rand_states))</span>
        <span class="c1"># magn_list.append(measure_error(r, xyz_group, t, exact_U, &#39;average_ob_empirical&#39;, rand_states=rand_states, ob=magn_op))</span>
        <span class="c1"># corr_list.append(measure_error(r, xyz_group, t, exact_U, &#39;average_ob_empirical&#39;, rand_states=rand_states, ob=corr_op))</span>

    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_averg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">stat_list</span><span class="p">))</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_averg_magn&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">magn_list</span><span class="p">))</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_averg_corr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">corr_list</span><span class="p">))</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_averg_std&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">stat_list</span><span class="p">))</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_averg_magn_std&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">magn_list</span><span class="p">))</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_averg_corr_std&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">corr_list</span><span class="p">))</span>
<span class="c1"># save to csv</span>
<span class="c1"># print(pd.DataFrame(data))</span>
<span class="c1"># pd.DataFrame(data).to_csv(f&#39;{data_dir}/{prefix}_data_max={n_max}_sample={n_sample}_{suffix}_4norm.csv&#39;, index=False)</span>
<span class="c1"># save as npy</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">data_dir</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">_data_max=</span><span class="si">{</span><span class="n">n_max</span><span class="si">}</span><span class="s1">_sample=</span><span class="si">{</span><span class="n">n_sample</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">suffix</span><span class="si">}</span><span class="s1">_4norm.npy&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

<span class="c1"># # plot results</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">layout</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="c1"># ax.plot(n_list, norm4_list, &#39;s&#39;, label=&#39;Norm4&#39;)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_list</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bnd_worst&#39;</span><span class="p">],</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Worst-case (Theoretical)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#E64B35FF&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_list</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bnd_averg&#39;</span><span class="p">],</span> <span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Average w/o observable (Theoretical)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#0A75C7FF&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_list</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bnd_averg_magn&#39;</span><span class="p">],</span> <span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Average with observable (Theoretical)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#F39B7FFF&quot;</span><span class="p">)</span>
<span class="c1"># ax.plot(n_list, data[&#39;bnd_averg_magn_nc&#39;], &#39;^&#39;, label=&#39;Average with observable (Theoretical 4norm)&#39;, color=&quot;#47B167FF&quot;)</span>
<span class="c1"># ax.plot(n_list, data[&#39;emp_worst&#39;], &#39;D&#39;, label=&#39;Worst-case (Empirical)&#39;, color=&quot;#E64B35FF&quot;)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">n_list</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_averg&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_averg_std&#39;</span><span class="p">],</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Average w/o observable (Empirical)&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#0A75C7FF&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">n_list</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_averg_magn&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_averg_magn_std&#39;</span><span class="p">],</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Average with observable (Empirical)&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#F39B7FFF&quot;</span><span class="p">)</span>

<span class="n">plot_fit</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">n_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bnd_worst&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">var</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span> <span class="n">x_offset</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="c1"># plot_fit(ax, n_list[1:], data[&#39;emp_worst&#39;][1:], var=suffix, x_offset=1.02, y_offset=0.90)</span>
<span class="n">plot_fit</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">n_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bnd_averg&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">var</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span> <span class="n">x_offset</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="n">plot_fit</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">n_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_averg&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">var</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span> <span class="n">x_offset</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="n">plot_fit</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">n_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bnd_averg_magn&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">var</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span> <span class="n">x_offset</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="c1"># plot_fit(ax, n_list[1:], data[&#39;bnd_averg_magn_nc&#39;][1:], var=suffix, x_offset=1.02)</span>
<span class="n">plot_fit</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">n_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_averg_magn&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">var</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span> <span class="n">x_offset</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">rf</span><span class="s1">&#39;Number of qubits $n$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">rf</span><span class="s1">&#39;Error&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">();</span> <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">n_list</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">ScalarFormatter</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;legend&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">MEDIUM_SIZE</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> 
<span class="c1"># ax.legend(loc=&#39;center right&#39;, bbox_to_anchor=(1.0, 0.32))</span>
<span class="c1"># fig.savefig(f&#39;{figs_dir}/random_{prefix}_max={n_list[-1]}_{suffix}_sample={n_sample}_6lines.pdf&#39;, dpi=150, bbox_inches=&#39;tight&#39;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>------ n = 4 ------
----empirical observable error----
------ n = 5 ------
----empirical observable error----
------ n = 6 ------
----empirical observable error----
------ n = 7 ------
----empirical observable error----
------ n = 8 ------
----empirical observable error----
------ n = 9 ------
----empirical observable error----
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/homebrew/Caskroom/miniforge/base/lib/python3.10/site-packages/matplotlib/cbook.py:1699: ComplexWarning: Casting complex values to real discards the imaginary part
  return math.isfinite(val)
/opt/homebrew/Caskroom/miniforge/base/lib/python3.10/site-packages/matplotlib/cbook.py:1345: ComplexWarning: Casting complex values to real discards the imaginary part
  return np.asarray(x, float)
/opt/homebrew/Caskroom/miniforge/base/lib/python3.10/site-packages/numpy/lib/function_base.py:628: ComplexWarning: Casting complex values to real discards the imaginary part
  a = asarray(a, dtype=dtype, order=order)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a_em: 5.350555531755437; b_em: -17.13891724981422
a_em: 4.832245234392589; b_em: -17.131508082421988
a_em: 4.78238755958146; b_em: -18.99392143462999
a_em: 4.307688743138242; b_em: -16.53288658538728
a_em: 1.0223008088813093; b_em: -16.33367318871486
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/75caac991e5adcd992657b19f3d7f3b8192ed1717eaa879ae09ae294be1cf23b.png"><img alt="_images/75caac991e5adcd992657b19f3d7f3b8192ed1717eaa879ae09ae294be1cf23b.png" src="_images/75caac991e5adcd992657b19f3d7f3b8192ed1717eaa879ae09ae294be1cf23b.png" style="width: 862px; height: 562px;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># pd.DataFrame(data).to_csv(f&#39;{data_dir}/{prefix}_data_max={n_max}_sample={n_sample}_{suffix}.csv&#39;, index=False)</span>
<span class="n">prefix</span><span class="p">,</span> <span class="n">suffix</span> <span class="o">=</span> <span class="s1">&#39;Pow&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span>
<span class="n">n_max</span> <span class="o">=</span> <span class="mi">11</span>
<span class="n">r</span> <span class="o">=</span> <span class="mi">10000</span> <span class="c1"># 5000</span>
<span class="n">eps</span> <span class="o">=</span> <span class="mf">1e-3</span>
<span class="n">n_sample</span><span class="p">,</span> <span class="n">n_round</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span>
<span class="n">n_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">n_max</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># read from csv</span>
<span class="c1"># data = pd.read_csv(f&#39;{data_dir}/{prefix}_data_max={n_max}_sample={n_sample}_{suffix}.csv&#39;)</span>
<span class="c1"># read from npy</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">data_dir</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">_data_max=</span><span class="si">{</span><span class="n">n_max</span><span class="si">}</span><span class="s1">_sample=</span><span class="si">{</span><span class="n">n_sample</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">suffix</span><span class="si">}</span><span class="s1">_4norm.npy&#39;</span><span class="p">,</span> <span class="n">allow_pickle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

<span class="c1"># # plot results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;legend&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">MEDIUM_SIZE</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> 
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">layout</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="c1"># ax.plot(n_list, norm4_list, &#39;s&#39;, label=&#39;Norm4&#39;)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bnd_worst&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Worst-case (Theoretical)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#E64B35FF&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bnd_averg&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Average w/o observable (Theoretical)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#0A75C7&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bnd_averg_magn&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Average with observable (Theoretical)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#F39B7FFF&quot;</span><span class="p">)</span>
<span class="c1"># ax.plot(n_list[1:], data[&#39;emp_worst&#39;][1:], &#39;D&#39;, label=&#39;Worst-case (Empirical)&#39;, color=&quot;#E64B35FF&quot;)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">n_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_averg&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_averg_std&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Average w/o observable (Empirical)&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#0A75C7&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">n_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_averg_magn&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_averg_magn_std&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Average with observable (Empirical)&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#F39B7FFF&quot;</span><span class="p">)</span>

<span class="n">plot_fit</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">n_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bnd_worst&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">var</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span> <span class="n">x_offset</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="c1"># plot_fit(ax, n_list[1:], data[&#39;emp_worst&#39;][1:], var=suffix, x_offset=1.02, y_offset=0.90)</span>
<span class="n">plot_fit</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">n_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bnd_averg&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">var</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span> <span class="n">x_offset</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="n">plot_fit</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">n_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_averg&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">var</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span> <span class="n">x_offset</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="n">plot_fit</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">n_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bnd_averg_magn&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">var</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span> <span class="n">x_offset</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="n">plot_fit</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">n_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_averg_magn&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">var</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span> <span class="n">x_offset</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">rf</span><span class="s1">&#39;Number of qubits&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">rf</span><span class="s1">&#39;Error&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">();</span> <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">n_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">ScalarFormatter</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center right&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.99</span><span class="p">,</span> <span class="mf">0.32</span><span class="p">))</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;legend&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">MEDIUM_SIZE</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> 
<span class="c1"># ax.legend(loc=&#39;center right&#39;, bbox_to_anchor=(1.0, 0.32))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">figs_dir</span><span class="si">}</span><span class="s1">/random_</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">_max=</span><span class="si">{</span><span class="n">n_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">suffix</span><span class="si">}</span><span class="s1">_sample=</span><span class="si">{</span><span class="n">n_sample</span><span class="si">}</span><span class="s1">_6lines.pdf&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/homebrew/Caskroom/miniforge/base/lib/python3.10/site-packages/matplotlib/cbook.py:1699: ComplexWarning: Casting complex values to real discards the imaginary part
  return math.isfinite(val)
/opt/homebrew/Caskroom/miniforge/base/lib/python3.10/site-packages/matplotlib/cbook.py:1345: ComplexWarning: Casting complex values to real discards the imaginary part
  return np.asarray(x, float)
/opt/homebrew/Caskroom/miniforge/base/lib/python3.10/site-packages/numpy/lib/function_base.py:628: ComplexWarning: Casting complex values to real discards the imaginary part
  a = asarray(a, dtype=dtype, order=order)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a_em: 5.307956203756592; b_em: -17.060822597203764
a_em: 4.787308227941483; b_em: -17.049310334991098
a_em: 4.719564676862009; b_em: -18.876667087009114
a_em: 4.270241047121607; b_em: -16.464379989942078
a_em: 0.7317891419316699; b_em: -15.777239014225623
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/c8c289ab94c459edebc2719e0b95ca6b538a5899812594ff92fa81e9ca23f76d.png"><img alt="_images/c8c289ab94c459edebc2719e0b95ca6b538a5899812594ff92fa81e9ca23f76d.png" src="_images/c8c289ab94c459edebc2719e0b95ca6b538a5899812594ff92fa81e9ca23f76d.png" style="width: 862px; height: 562px;" /></a>
</div>
</div>
</section>
<section id="nearest-neighbor-interaction">
<h2>Nearest-neighbor interaction<a class="headerlink" href="#nearest-neighbor-interaction" title="Link to this heading">#</a></h2>
<section id="transver-field-ising-tfi">
<h3>Transver-field Ising (TFI)<a class="headerlink" href="#transver-field-ising-tfi" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">spin_ham</span> <span class="kn">import</span> <span class="n">TF_Ising_1d</span>
<span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">h</span><span class="o">=</span><span class="mf">0.2</span><span class="p">;</span> 
<span class="c1"># n = 8; </span>
<span class="c1"># t = 0.5</span>
<span class="n">r</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">n_list_emp</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">rand_err_list</span><span class="p">,</span> <span class="n">EEEE_err_list</span><span class="p">,</span> <span class="n">E_norm_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">n_list_emp</span><span class="p">:</span>
    <span class="n">tfI</span> <span class="o">=</span> <span class="n">TF_Ising_1d</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">n</span>
    <span class="n">exact_U</span> <span class="o">=</span> <span class="n">expm</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">t</span><span class="o">/</span><span class="n">r</span> <span class="o">*</span> <span class="n">tfI</span><span class="o">.</span><span class="n">ham</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">())</span>
    <span class="n">appro_U_xyz</span> <span class="o">=</span> <span class="n">standard_trotter</span><span class="p">([</span><span class="n">h</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">tfI</span><span class="o">.</span><span class="n">ham_xyz</span><span class="p">],</span> <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
    <span class="n">appro_U_parity</span> <span class="o">=</span> <span class="n">standard_trotter</span><span class="p">([</span><span class="n">h</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">tfI</span><span class="o">.</span><span class="n">ham_parity</span><span class="p">],</span> <span class="n">t</span><span class="o">/</span><span class="n">r</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">magn_op</span> <span class="o">=</span> <span class="n">SparsePauliOp</span><span class="o">.</span><span class="n">from_sparse_list</span><span class="p">([(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)],</span> <span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
    <span class="n">err_op</span> <span class="o">=</span> <span class="n">exact_U</span> <span class="o">-</span> <span class="n">appro_U_parity</span>
    <span class="n">rand_err</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">r</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">err_op</span> <span class="o">@</span> <span class="n">err_op</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">err_op</span> <span class="o">@</span> <span class="n">err_op</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">**</span><span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">magn_op</span> <span class="o">@</span> <span class="n">magn_op</span> <span class="o">@</span> <span class="n">magn_op</span> <span class="o">@</span> <span class="n">magn_op</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">**</span><span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">EEEE_err</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">err_op</span> <span class="o">@</span> <span class="n">err_op</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">err_op</span> <span class="o">@</span> <span class="n">err_op</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">**</span><span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> 
    <span class="n">rand_err_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rand_err</span><span class="p">)</span>
    <span class="n">EEEE_err_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">EEEE_err</span><span class="p">)</span>
    <span class="n">E_norm_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">err_op</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mf">1e-3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_list_emp</span><span class="p">,</span> <span class="n">rand_err_list</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;random error bound&#39;</span><span class="p">)</span>
<span class="n">plot_fit</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">n_list_emp</span><span class="p">,</span> <span class="n">rand_err_list</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_list_emp</span><span class="p">,</span> <span class="n">EEEE_err_list</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;(tr(EEEE)/2^n)^1/4&#39;</span><span class="p">)</span>
<span class="n">plot_fit</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">n_list_emp</span><span class="p">,</span> <span class="n">EEEE_err_list</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_list_emp</span><span class="p">,</span> <span class="n">E_norm_list</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;E norm&#39;</span><span class="p">)</span>
<span class="n">plot_fit</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">n_list_emp</span><span class="p">,</span> <span class="n">E_norm_list</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Random err bound&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;PF2, TFI (J=</span><span class="si">{</span><span class="n">J</span><span class="si">}</span><span class="s1">, h=</span><span class="si">{</span><span class="n">h</span><span class="si">}</span><span class="s1">), t=n, r=</span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">ScalarFormatter</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">n_list_emp</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span> <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">18</span><span class="p">],</span> <span class="n">line</span> <span class="mi">13</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span> <span class="n">t</span> <span class="o">=</span> <span class="n">n</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span> <span class="n">exact_U</span> <span class="o">=</span> <span class="n">expm</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">t</span><span class="o">/</span><span class="n">r</span> <span class="o">*</span> <span class="n">tfI</span><span class="o">.</span><span class="n">ham</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">())</span>
<span class="ne">---&gt; </span><span class="mi">13</span> <span class="n">appro_U_xyz</span> <span class="o">=</span> <span class="n">standard_trotter</span><span class="p">([</span><span class="n">h</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">tfI</span><span class="o">.</span><span class="n">ham_xyz</span><span class="p">],</span> <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span> <span class="n">appro_U_parity</span> <span class="o">=</span> <span class="n">standard_trotter</span><span class="p">([</span><span class="n">h</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">tfI</span><span class="o">.</span><span class="n">ham_parity</span><span class="p">],</span> <span class="n">t</span><span class="o">/</span><span class="n">r</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">15</span> <span class="n">magn_op</span> <span class="o">=</span> <span class="n">SparsePauliOp</span><span class="o">.</span><span class="n">from_sparse_list</span><span class="p">([(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)],</span> <span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>

<span class="ne">NameError</span>: name &#39;standard_trotter&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit.quantum_info</span> <span class="kn">import</span> <span class="n">random_statevector</span>

<span class="n">prefix</span><span class="p">,</span> <span class="n">suffix</span> <span class="o">=</span> <span class="s1">&#39;TFI&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span>
<span class="n">n_max</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">J</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span>
<span class="n">eps</span> <span class="o">=</span> <span class="mf">1e-3</span>
<span class="n">n_sample</span><span class="p">,</span> <span class="n">n_round</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span>
<span class="n">n_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">n_max</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="n">data_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;emp_worst&#39;</span><span class="p">,</span> <span class="s1">&#39;emp_averg&#39;</span><span class="p">,</span> <span class="s1">&#39;emp_averg_std&#39;</span><span class="p">,</span> <span class="s1">&#39;emp_averg_magn&#39;</span><span class="p">,</span> <span class="s1">&#39;emp_averg_corr&#39;</span><span class="p">,</span> <span class="s1">&#39;emp_averg_magn_std&#39;</span><span class="p">,</span> <span class="s1">&#39;emp_averg_corr_std&#39;</span><span class="p">,</span> <span class="s1">&#39;bnd_worst&#39;</span><span class="p">,</span> <span class="s1">&#39;bnd_averg&#39;</span><span class="p">,</span> <span class="s1">&#39;bnd_averg_magn&#39;</span><span class="p">,</span> <span class="s1">&#39;bnd_averg_corr&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span>
<span class="c1"># data = dict([(k, {key: [] for key in [&#39;emp&#39;, &#39;bnd&#39;]} ) for k in ob_keys])</span>
<span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">k</span><span class="p">,</span> <span class="p">[])</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">data_keys</span><span class="p">])</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_list</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># emp_worst_list, emp_averg_list, emp_obser_list, emp_corre_list = [], [], [], []</span>
<span class="c1"># bnd_worst_list, bnd_averg_list, bnd_averg_magn_list = [], [], []</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">n_list</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;------ n = </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s1"> ------&#39;</span><span class="p">)</span>
    <span class="n">tfi</span> <span class="o">=</span> <span class="n">TF_Ising_1d</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">J</span><span class="o">=-</span><span class="n">J</span><span class="p">,</span> <span class="n">h</span><span class="o">=-</span><span class="n">h</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">n</span>
    <span class="n">corr_op</span> <span class="o">=</span> <span class="n">SparsePauliOp</span><span class="o">.</span><span class="n">from_sparse_list</span><span class="p">([(</span><span class="s1">&#39;ZZ&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span> <span class="n">num_qubits</span><span class="o">=</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span>
    <span class="n">magn_op</span> <span class="o">=</span> <span class="n">SparsePauliOp</span><span class="o">.</span><span class="n">from_sparse_list</span><span class="p">([(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">1</span><span class="o">/</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)],</span> <span class="n">num_qubits</span><span class="o">=</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span>
    <span class="n">par_group</span> <span class="o">=</span> <span class="p">[</span><span class="n">h</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">tfi</span><span class="o">.</span><span class="n">ham_parity</span><span class="p">]</span>
    <span class="n">xyz_group</span> <span class="o">=</span> <span class="p">[</span><span class="n">h</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">tfi</span><span class="o">.</span><span class="n">ham_xyz</span><span class="p">]</span>

    <span class="c1"># rand_states = [random_statevector(2**n) for _ in range(n_sample)]</span>
    <span class="c1"># print(rand_states)</span>
    <span class="n">exact_U</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">([</span><span class="n">h</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">tfi</span><span class="o">.</span><span class="n">ham_parity</span><span class="p">]))</span>
    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">exact_U</span><span class="p">,</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">([</span><span class="n">h</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">tfi</span><span class="o">.</span><span class="n">ham_xyz</span><span class="p">])))</span>

    <span class="n">empirical_worst_op_error_r</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">measure_error</span><span class="p">,</span> <span class="n">h_list</span><span class="o">=</span><span class="n">par_group</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">exact_U</span><span class="o">=</span><span class="n">exact_U</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;worst_empirical&#39;</span><span class="p">)</span>
    <span class="n">bound_worst_op_error_r</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">measure_error</span><span class="p">,</span> <span class="n">h_list</span><span class="o">=</span><span class="n">par_group</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">exact_U</span><span class="o">=</span><span class="n">exact_U</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;worst_bound&#39;</span><span class="p">)</span>
    <span class="n">bound_averg_op_error_r</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">measure_error</span><span class="p">,</span> <span class="n">h_list</span><span class="o">=</span><span class="n">par_group</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">exact_U</span><span class="o">=</span><span class="n">exact_U</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;average_bound&#39;</span><span class="p">)</span>
    <span class="n">empirical_averg_st_error_r</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">measure_error</span><span class="p">,</span> <span class="n">h_list</span><span class="o">=</span><span class="n">par_group</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">exact_U</span><span class="o">=</span><span class="n">exact_U</span><span class="p">,</span> <span class="n">rand_states</span><span class="o">=</span><span class="n">rand_states</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;average_empirical&#39;</span><span class="p">)</span>
    <span class="n">bound_averg_magn_op_error_r</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">measure_error</span><span class="p">,</span> <span class="n">h_list</span><span class="o">=</span><span class="n">par_group</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">exact_U</span><span class="o">=</span><span class="n">exact_U</span><span class="p">,</span> <span class="n">ob</span><span class="o">=</span><span class="n">magn_op</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;average_ob_bound&#39;</span><span class="p">)</span>
    <span class="n">bound_averg_corr_op_error_r</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">measure_error</span><span class="p">,</span> <span class="n">h_list</span><span class="o">=</span><span class="n">par_group</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">exact_U</span><span class="o">=</span><span class="n">exact_U</span><span class="p">,</span> <span class="n">ob</span><span class="o">=</span><span class="n">corr_op</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;average_ob_bound&#39;</span><span class="p">)</span>
    <span class="c1"># empirical_error_r(10)</span>
    <span class="n">r_start</span><span class="p">,</span> <span class="n">r_end</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1000</span>

    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_worst&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">binary_search_r</span><span class="p">(</span><span class="n">r_start</span><span class="p">,</span> <span class="n">r_end</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="n">empirical_worst_op_error_r</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bnd_worst&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">binary_search_r</span><span class="p">(</span><span class="n">r_start</span><span class="p">,</span> <span class="n">r_end</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="n">bound_worst_op_error_r</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bnd_averg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">binary_search_r</span><span class="p">(</span><span class="n">r_start</span><span class="p">,</span> <span class="n">r_end</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="n">bound_averg_op_error_r</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bnd_averg_magn&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">binary_search_r</span><span class="p">(</span><span class="n">r_start</span><span class="p">,</span> <span class="n">r_end</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="n">bound_averg_magn_op_error_r</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bnd_averg_corr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">binary_search_r</span><span class="p">(</span><span class="n">r_start</span><span class="p">,</span> <span class="n">r_end</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="n">bound_averg_corr_op_error_r</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

    <span class="n">magn_list</span><span class="p">,</span> <span class="n">corr_list</span><span class="p">,</span> <span class="n">stat_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----empirical observable error----&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_round</span><span class="p">):</span>
        <span class="n">rand_states</span> <span class="o">=</span> <span class="p">[</span><span class="n">random_statevector</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_sample</span><span class="p">)]</span>
        <span class="n">empirical_averg_mg_error_r</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">measure_error</span><span class="p">,</span> <span class="n">h_list</span><span class="o">=</span><span class="n">par_group</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">exact_U</span><span class="o">=</span><span class="n">exact_U</span><span class="p">,</span> <span class="n">rand_states</span><span class="o">=</span><span class="n">rand_states</span><span class="p">,</span> <span class="n">ob</span><span class="o">=</span><span class="n">magn_op</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;observable_empirical&#39;</span><span class="p">)</span>
        <span class="n">empirical_averg_zz_error_r</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">measure_error</span><span class="p">,</span> <span class="n">h_list</span><span class="o">=</span><span class="n">par_group</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">exact_U</span><span class="o">=</span><span class="n">exact_U</span><span class="p">,</span> <span class="n">rand_states</span><span class="o">=</span><span class="n">rand_states</span><span class="p">,</span> <span class="n">ob</span><span class="o">=</span><span class="n">corr_op</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;observable_empirical&#39;</span><span class="p">)</span>
        <span class="n">empirical_averg_st_error_r</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">measure_error</span><span class="p">,</span> <span class="n">h_list</span><span class="o">=</span><span class="n">par_group</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">exact_U</span><span class="o">=</span><span class="n">exact_U</span><span class="p">,</span> <span class="n">rand_states</span><span class="o">=</span><span class="n">rand_states</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;average_empirical&#39;</span><span class="p">)</span>
        <span class="n">magn_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">binary_search_r</span><span class="p">(</span><span class="n">r_start</span><span class="p">,</span> <span class="n">r_end</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="n">empirical_averg_mg_error_r</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
        <span class="n">corr_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">binary_search_r</span><span class="p">(</span><span class="n">r_start</span><span class="p">,</span> <span class="n">r_end</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="n">empirical_averg_zz_error_r</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
        <span class="n">stat_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">binary_search_r</span><span class="p">(</span><span class="n">r_start</span><span class="p">,</span> <span class="n">r_end</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="n">empirical_averg_st_error_r</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_averg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">stat_list</span><span class="p">))</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_averg_std&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">stat_list</span><span class="p">))</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_averg_magn&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">magn_list</span><span class="p">))</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_averg_corr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">corr_list</span><span class="p">))</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_averg_magn_std&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">magn_list</span><span class="p">))</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_averg_corr_std&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">corr_list</span><span class="p">))</span>
<span class="c1"># save to csv</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">data_dir</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">_data_max=</span><span class="si">{</span><span class="n">n_max</span><span class="si">}</span><span class="s1">_sample=</span><span class="si">{</span><span class="n">n_sample</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">suffix</span><span class="si">}</span><span class="s1">.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>------ n = 4 ------
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----empirical observable error----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
------ n = 5 ------
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----empirical observable error----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
------ n = 6 ------
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----empirical observable error----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
------ n = 7 ------
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----empirical observable error----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
------ n = 8 ------
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----empirical observable error----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
----binary search r----
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;./data/</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">_data_max=</span><span class="si">{</span><span class="n">n_max</span><span class="si">}</span><span class="s1">_sample=</span><span class="si">{</span><span class="n">n_sample</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">suffix</span><span class="si">}</span><span class="s1">.csv&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">layout</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_list</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bnd_worst&#39;</span><span class="p">],</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Worst-case (Theoretical)&#39;</span><span class="p">)</span>
<span class="c1"># ax.plot(n_list, data[&#39;bnd_averg_corr&#39;], &#39;^&#39;, label=&#39;Our observable average bound (Correlation)&#39;)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_list</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bnd_averg&#39;</span><span class="p">],</span> <span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Average w/o observable (Theoretical)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#0A75C7&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_list</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bnd_averg_magn&#39;</span><span class="p">],</span> <span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Average with observable (Theoretical)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#F39B7FFF&quot;</span><span class="p">)</span>
<span class="c1"># ax.plot(n_list, data[&#39;emp_worst&#39;], &#39;o&#39;, label=&#39;Empirical worst (spectral norm)&#39;)</span>
<span class="c1"># ax.plot(n_list, data[&#39;emp_averg&#39;], &#39;o&#39;, label=&#39;Empirical Haar average (l2 norm)&#39;)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">n_list</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_averg&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_averg_std&#39;</span><span class="p">],</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Average w/o observable (Empirical)&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#0A75C7&quot;</span><span class="p">)</span>
<span class="c1"># ax.plot(n_list, data[&#39;emp_averg_magn&#39;], &#39;*&#39;, label=&#39;Empirical observable (Magnetization)&#39;, markersize=12)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">n_list</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_averg_magn&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_averg_magn_std&#39;</span><span class="p">],</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Average with observable (Empirical)&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#F39B7FFF&quot;</span><span class="p">)</span>
<span class="c1"># ax.errorbar(n_list, data[&#39;emp_averg_corr&#39;], data[&#39;emp_averg_corr_std&#39;], fmt=&#39;*&#39;, label=&#39;Empirical average (Correlation)&#39;, capsize=5)</span>
<span class="c1"># ax.plot(n_list, data[&#39;emp_averg_corr&#39;], &#39;*&#39;, label=&#39;Empirical average (Correlation)&#39;, markersize=12)</span>

<span class="c1"># plot_fit(ax, n_list[1:], data[&#39;emp_worst&#39;][1:], var=suffix, offset=1.05)</span>
<span class="n">plot_fit</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">n_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bnd_worst&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">var</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="n">plot_fit</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">n_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bnd_averg&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">var</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="n">plot_fit</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">n_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_averg&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">var</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="n">plot_fit</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">n_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bnd_averg_magn&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">var</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="c1"># ax.set_title(rf&#39;{prefix} (J={J}, h={h}), $\epsilon = {eps}$, $t = n$&#39;)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">rf</span><span class="s1">&#39;n (qubits)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">rf</span><span class="s1">&#39;r (Trotter steps)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">();</span> <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">n_list</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">ScalarFormatter</span><span class="p">())</span>
<span class="c1"># ax.legend()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;legend&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">MEDIUM_SIZE</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center right&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.32</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">figs_dir</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">_max=</span><span class="si">{</span><span class="n">n_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">suffix</span><span class="si">}</span><span class="s1">_sample=</span><span class="si">{</span><span class="n">n_sample</span><span class="si">}</span><span class="s1">.pdf&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a_em: 2.078929637138007; b_em: 2.363936672643134
a_em: 1.8026500267612264; b_em: 2.657255132140315
a_em: 1.8083171744672164; b_em: 1.9192924222628656
a_em: 1.6072419601768255; b_em: 2.9729499923309515
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/204a6a09c74d46479800908e79b9f5306d779d6e505095e770a1091715ada83a.png"><img alt="_images/204a6a09c74d46479800908e79b9f5306d779d6e505095e770a1091715ada83a.png" src="_images/204a6a09c74d46479800908e79b9f5306d779d6e505095e770a1091715ada83a.png" style="width: 874px; height: 575px;" /></a>
</div>
</div>
</section>
<section id="worst-input-largest-singular-value">
<h3>Worst input (largest singular value)<a class="headerlink" href="#worst-input-largest-singular-value" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">appro_U</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="mi">1</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">([</span><span class="n">h</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">tfi</span><span class="o">.</span><span class="n">ham_parity</span><span class="p">]))</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">exact_U</span> <span class="o">-</span> <span class="n">appro_U</span>
<span class="c1"># np.linalg.eigh(M)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;spectral norm by definition: &#39;</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">M</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;largest eigenval: &#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">M</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="c1"># np.linalg.norm(np.linalg.eigh(exact_U - appro_U)[1][-1], ord=2)</span>
<span class="c1"># np.linalg.norm(exact_U - appro_U, ord=-2)</span>
<span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;largest singular value: &#39;</span><span class="p">,</span> <span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="c1"># print(V[0])</span>
<span class="n">norm</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">M</span> <span class="o">@</span> <span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">M</span> <span class="o">@</span> <span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="c1"># print(norm(M @ np.linalg.eigh(M)[1][-1]).conj().T)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;spectral norm by numpy: &#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="c1"># sorted(S)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>spectral norm by definition:  (1.9998095531513846+0j)
largest eigenval:  2.8340126451426553
largest singular value:  1.9998095531513838
1.9998095531513842
1.9998095531513846
spectral norm by numpy:  1.9998095531513846
</pre></div>
</div>
</div>
</div>
</section>
<section id="error-vs-time">
<h3>Error VS time<a class="headerlink" href="#error-vs-time" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openfermion.linalg</span> <span class="kn">import</span> <span class="n">get_ground_state</span><span class="p">,</span> <span class="n">get_sparse_operator</span>
<span class="kn">from</span> <span class="nn">qiskit.quantum_info</span> <span class="kn">import</span> <span class="n">random_statevector</span><span class="p">,</span> <span class="n">Statevector</span><span class="p">,</span> <span class="n">SparsePauliOp</span>

<span class="n">prefix</span><span class="p">,</span> <span class="n">suffix</span> <span class="o">=</span> <span class="s1">&#39;Ising&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span>

<span class="n">r</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_sample</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">t_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

<span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;worst_err&#39;</span><span class="p">,</span> <span class="s1">&#39;averg_err&#39;</span><span class="p">,</span> <span class="s1">&#39;averg_err_std&#39;</span><span class="p">,</span> <span class="s1">&#39;typic_err&#39;</span><span class="p">,</span> <span class="s1">&#39;worst_ob_err&#39;</span><span class="p">,</span> <span class="s1">&#39;averg_ob_err&#39;</span><span class="p">,</span> <span class="s1">&#39;averg_ob_err_std&#39;</span><span class="p">,</span> <span class="s1">&#39;typic_ob_err&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">k</span><span class="p">,</span> <span class="p">[])</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">])</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t_list</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">J</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span>   
<span class="n">tfi</span> <span class="o">=</span> <span class="n">TF_Ising_1d</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">J</span><span class="o">=-</span><span class="n">J</span><span class="p">,</span> <span class="n">h</span><span class="o">=-</span><span class="n">h</span><span class="p">)</span>
<span class="c1"># init_st = Statevector.from_label(&#39;r&#39;*n).data</span>
<span class="c1"># print(init_st)</span>
<span class="c1"># init_st = get_ground_state(tfi.ham.to_matrix())[1]</span>
<span class="n">init_st</span> <span class="o">=</span> <span class="n">random_statevector</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">data</span>
<span class="c1"># init_st = np.linalg.eigh(exact_U - pf_AB(par_group, 3, r, ord=2))[1][-1]</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">t_list</span><span class="p">:</span>
    <span class="c1"># print(f&#39;------ t = {t} ------&#39;)</span>
    <span class="n">magn_op</span> <span class="o">=</span> <span class="n">SparsePauliOp</span><span class="o">.</span><span class="n">from_sparse_list</span><span class="p">([(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">1</span><span class="o">/</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)],</span> <span class="n">num_qubits</span><span class="o">=</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span>
    <span class="c1"># magn_op = SparsePauliOp(&#39;XYIIIIII&#39;).to_matrix()</span>
    <span class="c1"># magn_op = SparsePauliOp(&#39;XYZYIXYX&#39;).to_matrix()</span>
    <span class="n">corr_op</span> <span class="o">=</span> <span class="n">SparsePauliOp</span><span class="o">.</span><span class="n">from_sparse_list</span><span class="p">([(</span><span class="s1">&#39;ZZ&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span> <span class="n">num_qubits</span><span class="o">=</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span>
    <span class="n">ob</span> <span class="o">=</span> <span class="n">magn_op</span>
    <span class="n">par_group</span> <span class="o">=</span> <span class="p">[</span><span class="n">h</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">tfi</span><span class="o">.</span><span class="n">ham_parity</span><span class="p">]</span>
    <span class="n">xyz_group</span> <span class="o">=</span> <span class="p">[</span><span class="n">h</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">tfi</span><span class="o">.</span><span class="n">ham_xyz</span><span class="p">]</span>
    <span class="n">appro_U</span> <span class="o">=</span> <span class="n">pf_r</span><span class="p">(</span><span class="n">par_group</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">use_jax</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># init_st = np.linalg.eigh(exact_U - appro_U)[1][-1]</span>

    <span class="c1"># rand_states = [random_statevector(2**n) for _ in range(n_sample)]</span>
    <span class="c1"># print(rand_states)</span>
    <span class="n">exact_U</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">([</span><span class="n">h</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">tfi</span><span class="o">.</span><span class="n">ham_parity</span><span class="p">]))</span>
    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">exact_U</span><span class="p">,</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">([</span><span class="n">h</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">tfi</span><span class="o">.</span><span class="n">ham_xyz</span><span class="p">])))</span>
    <span class="n">rand_states</span> <span class="o">=</span> <span class="p">[</span><span class="n">random_statevector</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">exact_U</span><span class="p">))</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_sample</span><span class="p">)]</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">exact_U</span> <span class="o">-</span> <span class="n">appro_U</span>
    <span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
    <span class="c1"># init_st = V[0].conj().T</span>
    <span class="c1"># init_st = np.linalg.eigh(exact_U - appro_U)[1][-1]</span>
    <span class="c1"># init_st = np.linalg.eigh(M.conj().T @ M)[1][-1]</span>
    <span class="c1"># op_norm = sqrt(np.linalg.eigh(M.conj().T @ M)[0][-1])</span>
    <span class="c1"># print(&#39;operator norm: &#39;, op_norm, np.linalg.norm(M, ord=2))</span>
    <span class="c1"># op_norm = np.linalg.norm(tfi.ham.to_matrix(), ord=2)</span>
    <span class="c1"># ob = tfi.ham.to_matrix()/np.linalg.norm(tfi.ham.to_matrix(), ord=2)</span>

    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;worst_err&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">exact_U</span> <span class="o">-</span> <span class="n">appro_U</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">averg_st_err</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">exact_U</span> <span class="o">@</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span> <span class="o">-</span> <span class="n">appro_U</span> <span class="o">@</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">rand_states</span><span class="p">]</span>
    <span class="c1"># print(averg_ob_err)</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;averg_err&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">averg_st_err</span><span class="p">))</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;averg_err_std&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">averg_st_err</span><span class="p">))</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;typic_err&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">exact_U</span> <span class="o">@</span> <span class="n">init_st</span> <span class="o">-</span> <span class="n">appro_U</span> <span class="o">@</span> <span class="n">init_st</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
    <span class="c1"># exact_st = exact_U @ init_st</span>
    <span class="c1"># appro_st = appro_U @ init_st</span>
    <span class="c1"># data[&#39;typic_err&#39;].append(0.5* np.linalg.norm(np.outer(exact_st.conj().T, exact_st) - np.outer(appro_st.conj().T, appro_st), ord=&#39;nuc&#39;))</span>
    <span class="c1"># print(ground_state.conj().T @ exact_U.conj().T @ h_ob @ exact_U @ ground_state)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">init_st</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">exact_U</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">ob</span> <span class="o">@</span> <span class="n">exact_U</span> <span class="o">@</span> <span class="n">init_st</span><span class="p">)</span>
    <span class="c1"># print(exact_U @ init_st)</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;worst_ob_err&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">exact_U</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">ob</span> <span class="o">@</span> <span class="n">exact_U</span> <span class="o">-</span> <span class="n">appro_U</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">ob</span> <span class="o">@</span> <span class="n">appro_U</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>    <span class="p">)</span>
    <span class="n">averg_ob_err</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">data</span> <span class="o">@</span> <span class="n">exact_U</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">ob</span> <span class="o">@</span> <span class="n">exact_U</span> <span class="o">@</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="o">-</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span> <span class="o">@</span> <span class="n">appro_U</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">ob</span> <span class="o">@</span> <span class="n">appro_U</span> <span class="o">@</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">rand_states</span><span class="p">]</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;averg_ob_err&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">averg_ob_err</span><span class="p">))</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;averg_ob_err_std&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">averg_ob_err</span><span class="p">))</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;typic_ob_err&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">init_st</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">exact_U</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">ob</span> <span class="o">@</span> <span class="n">exact_U</span> <span class="o">@</span> <span class="n">init_st</span> <span class="o">-</span> <span class="n">init_st</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">appro_U</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">ob</span> <span class="o">@</span> <span class="n">appro_U</span> <span class="o">@</span> <span class="n">init_st</span><span class="p">))</span>
    <span class="c1"># print(&quot;energy: &quot;, init_st.conj().T @ exact_U.conj().T @ ob @ exact_U @ init_st, init_st.conj().T @ appro_U.conj().T @ ob @ appro_U @ init_st)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">layout</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;worst_err&#39;</span><span class="p">],</span> <span class="s1">&#39;s-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Worst-case (state)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;worst_ob_err&#39;</span><span class="p">],</span> <span class="s1">&#39;s--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Worst-case (observable)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;typic_err&#39;</span><span class="p">],</span> <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Empirical-case (state)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;typic_ob_err&#39;</span><span class="p">],</span> <span class="s1">&#39;o--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Empirical-case (observable)&#39;</span><span class="p">)</span>

<span class="c1"># ax.plot(data[&#39;t&#39;], data[&#39;averg_err&#39;], &#39;^-&#39;, label=&#39;Average-case (state)&#39;)</span>
<span class="c1"># ax.plot(data[&#39;t&#39;], data[&#39;averg_ob_err&#39;], &#39;^--&#39;, label=&#39;Average-case (observable)&#39;)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;averg_err&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;averg_err_std&#39;</span><span class="p">],</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;^-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Average-case (state)&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;averg_ob_err&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;averg_ob_err_std&#39;</span><span class="p">],</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;^--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Average-case (observable)&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># ax.set_title(rf&#39;H2 chain, init d={d}, H=H2(2d), ob=H2(d), r={r}&#39;)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">rf</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">rf</span><span class="s1">&#39;Error&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="c1"># ax.loglog()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">figs_dir</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">_n=</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s1">_r=</span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s1">_sample=</span><span class="si">{</span><span class="n">n_sample</span><span class="si">}</span><span class="s1">.pdf&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-0.007389517548360071-8.673617379884035e-18j)
(-0.006819394843982057-5.204170427930421e-18j)
(-0.0054964813642306085-5.204170427930421e-18j)
(-0.003512707872542112-1.214306433183765e-17j)
(-0.0010157170847666722-4.336808689942018e-18j)
(0.0017979653499583317+1.431146867680866e-17j)
(0.004697630219914137+1.3010426069826053e-17j)
(0.007440012268610387+2.168404344971009e-17j)
(0.009795037802223149-1.9949319973733282e-17j)
(0.011571833631471698+8.565197162635485e-18j)
(0.012641117997625455+1.4094628242311558e-17j)
(0.012950912931106381-1.2685165418080402e-17j)
(0.01253372487066276+3.469446951953614e-18j)
(0.011504474447333775-2.0599841277224584e-18j)
(0.01004926723115572+2.3852447794681098e-18j)
(0.008405632552517937-2.3852447794681098e-18j)
(0.006835377877981677-8.51098705401121e-18j)
(0.005591989778501512-4.445228907190568e-18j)
(0.0048856566052379174+1.235990476633475e-17j)
(0.00485030373402142+1.3010426069826053e-17j)
(0.005518073621803649-2.2985086056692694e-17j)
(0.006806892796544103-6.5052130349130266e-18j)
(0.008525685874302268+2.0816681711721685e-17j)
(0.010399259735276195+1.3010426069826053e-17j)
(0.012111151930796607-1.9949319973733282e-17j)
(0.01335851472900014-8.673617379884035e-18j)
(0.01390940058058597+8.239936510889834e-18j)
(0.013650715808758693-2.3852447794681098e-17j)
(0.012615495725289715+1.734723475976807e-18j)
(0.010981411146047212-2.47198095326695e-17j)
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/c6183afad368b314400b20ca4ce6e358a7fa2372a7dafdebd844333c99d31db7.png"><img alt="_images/c6183afad368b314400b20ca4ce6e358a7fa2372a7dafdebd844333c99d31db7.png" src="_images/c6183afad368b314400b20ca4ce6e358a7fa2372a7dafdebd844333c99d31db7.png" style="width: 875px; height: 575px;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">exact_st</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">exact_st</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">appro_st</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">appro_st</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">exact_st</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">exact_st</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">appro_st</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">appro_st</span><span class="p">),</span> <span class="nb">ord</span><span class="o">=</span><span class="s1">&#39;nuc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">15</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">exact_st</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">exact_st</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">appro_st</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">appro_st</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">exact_st</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">exact_st</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">appro_st</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">appro_st</span><span class="p">),</span> <span class="nb">ord</span><span class="o">=</span><span class="s1">&#39;nuc&#39;</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;exact_st&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.sparse.linalg</span> <span class="kn">import</span> <span class="n">expm</span>
<span class="c1"># X = np.array([[6, 2], [2, 6]])</span>
<span class="c1"># X = np.array([[10, 12], [12, 10]])</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">62</span><span class="p">],</span> <span class="p">[</span><span class="mi">62</span><span class="p">,</span> <span class="mi">50</span><span class="p">]])</span>
<span class="c1"># X = np.array([[6.1, 52.0], [16, 1.6]])</span>
<span class="n">Id</span> <span class="o">=</span> <span class="n">expm</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">X</span><span class="p">)</span> <span class="o">@</span> <span class="n">expm</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">X</span><span class="p">)</span>
<span class="c1"># Id = np.dot(expm(X),expm(-X))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Id</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;scipy: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">expm</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">X</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;jax: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">jax</span><span class="o">.</span><span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">X</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;differ: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">expm</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">X</span><span class="p">)</span> <span class="o">-</span> <span class="n">jax</span><span class="o">.</span><span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">X</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1.000000e+00-5.382740e-17j 5.613949e-15+5.431801e-17j]
 [5.741244e-15-8.183057e-17j 1.000000e+00+5.769487e-17j]]
scipy: 
 [[ 0.649912-0.176711j -0.193942-0.713284j]
 [-0.193942-0.713284j  0.649912-0.176711j]]
jax: 
 [[ 0.646726-0.178327j -0.197126-0.714903j]
 [-0.197126-0.714903j  0.646726-0.178327j]]
differ: 
 [[0.003186+0.001616j 0.003184+0.001619j]
 [0.003184+0.001619j 0.003186+0.001616j]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.sparse.linalg</span> <span class="kn">import</span> <span class="n">expm</span>
<span class="c1"># X = np.array([[6.1, 52], [16, 1.6]])</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">60</span><span class="p">,</span> <span class="mi">52</span><span class="p">],</span> <span class="p">[</span><span class="mi">52</span><span class="p">,</span> <span class="mi">60</span><span class="p">]])</span>
<span class="n">Id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">jax</span><span class="o">.</span><span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">X</span><span class="p">),</span><span class="n">jax</span><span class="o">.</span><span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">X</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Id</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[9.999996e-01+9.329750e-08j 3.597887e-07+3.941467e-07j]
 [3.299864e-07-3.847489e-07j 9.999995e-01-8.006879e-08j]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># generate 4by4 random hermitian matrix</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">A</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">jax</span><span class="o">.</span><span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="n">H</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="n">H</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="n">H</span><span class="p">)</span> <span class="o">-</span> <span class="n">jax</span><span class="o">.</span><span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="n">H</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[-0.095848+0.311804j  0.225012-0.61771j   0.412086+0.47338j
   0.250644+0.068484j]
 [ 0.529645+0.717153j  0.124158+0.363135j  0.013719+0.051973j
  -0.086415+0.218051j]
 [ 0.24166 -0.031142j -0.256781-0.474368j -0.348675+0.212443j
  -0.677598+0.154421j]
 [ 0.036466+0.195143j -0.209819-0.292497j -0.630072-0.198825j
   0.595638+0.199333j]]
[[-0.09568 +0.31196j   0.224831-0.617531j  0.412287+0.473379j
   0.250739+0.068511j]
 [ 0.529801+0.716955j  0.124342+0.363306j  0.013726+0.051752j
  -0.086397+0.217953j]
 [ 0.24168 -0.030935j -0.256995-0.474348j -0.348537+0.212569j
  -0.677532+0.154493j]
 [ 0.036487+0.195231j -0.209922-0.292462j -0.629992-0.198773j
   0.595659+0.199354j]]
[[ 1.681671e-04+1.562834e-04j -1.809597e-04+1.780987e-04j
   2.008080e-04-2.086163e-07j  9.444356e-05+2.623349e-05j]
 [ 1.555681e-04-1.978278e-04j  1.840815e-04+1.704991e-04j
   6.598420e-06-2.211183e-04j  1.865625e-05-9.770691e-05j]
 [ 2.014637e-05+2.060942e-04j -2.132356e-04+1.934171e-05j
   1.383722e-04+1.262426e-04j  6.628036e-05+7.204711e-05j]
 [ 2.130121e-05+8.793175e-05j -1.034141e-04+3.466010e-05j
   7.981062e-05+5.106628e-05j  2.056360e-05+2.105534e-05j]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jax_expm</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">([</span><span class="n">h</span>  <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">h2_finl</span><span class="o">.</span><span class="n">hamiltonian_list</span><span class="p">]))</span>
<span class="n">spa_expm</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sparse</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">([</span><span class="n">h</span>  <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">h2_finl</span><span class="o">.</span><span class="n">hamiltonian_list</span><span class="p">]))</span>
<span class="n">sci_expm</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">([</span><span class="n">h</span>  <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">h2_finl</span><span class="o">.</span><span class="n">hamiltonian_list</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">jax_expm</span> <span class="o">-</span> <span class="n">sci_expm</span><span class="p">)</span>
<span class="c1"># print(jax_expm)</span>
<span class="c1"># print(spa_expm-sci_expm)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[-5.364418e-07-1.132488e-06j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j -4.768372e-07-5.662441e-07j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
  -4.768372e-07-5.662441e-07j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  1.460314e-06-4.768372e-06j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
  -1.490116e-06+7.867813e-06j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
  -3.725290e-07-1.788139e-07j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j -9.000301e-06-9.715557e-06j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
  -3.583729e-06-4.649162e-06j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j -4.351139e-06-3.784895e-06j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j -4.172325e-07-5.066395e-07j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
  -3.725290e-07-1.788139e-07j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
  -4.470348e-06-3.844500e-06j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j -3.524125e-06-4.589558e-06j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
  -9.000301e-06-9.715557e-06j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j -4.172325e-07-5.066395e-07j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j -1.370907e-06+7.927418e-06j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   2.831221e-06-1.195073e-05j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  2.086163e-07-2.384186e-07j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   2.086163e-07-2.384186e-07j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j -2.086163e-07-2.980232e-07j]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">h_list</span> <span class="o">=</span> <span class="n">h2_finl</span><span class="o">.</span><span class="n">qubit_terms</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h_list</span><span class="p">))</span>
<span class="n">jax_appro_U</span> <span class="o">=</span> <span class="n">pf_r</span><span class="p">(</span><span class="n">h_list</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">use_jax</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">jax_appro_U</span><span class="p">)</span>
<span class="c1"># exact_U = jax.scipy.linalg.expm(-1j * t * sum([h  for h in h2_finl.hamiltonian_list]))</span>
<span class="n">h_list</span> <span class="o">=</span> <span class="n">h2_finl</span><span class="o">.</span><span class="n">hamiltonian_list</span>
<span class="n">sci_appro_U</span> <span class="o">=</span> <span class="n">pf_r</span><span class="p">(</span><span class="n">h_list</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">use_jax</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># print(sci_appro_U)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">jax_appro_U</span><span class="o">-</span><span class="n">sci_appro_U</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15
[[-4.004703e-01+9.163097e-01j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  4.047313e-18+1.434732e-19j]
 [ 0.000000e+00+0.000000e+00j -8.682366e-01-4.961505e-01j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   3.150363e-18+5.443906e-18j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
  -8.682366e-01-4.961505e-01j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  8.493346e-18+2.174461e-17j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j -2.870732e-01+5.013173e-01j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
  -7.996451e-01+1.638218e-01j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
  -1.523889e-01+9.883206e-01j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j -4.137284e-17-1.517635e-17j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  7.533735e-01-6.575928e-01j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
  -2.034261e-17-2.180453e-17j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
  -5.153608e-02-5.869150e-01j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  8.049096e-01-7.067784e-02j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j -9.381308e-01+3.462811e-01j
  -9.866871e-17-7.502322e-17j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  1.394014e-16+1.126852e-16j
  -1.523889e-01+9.883206e-01j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   8.049096e-01-7.067784e-02j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j -5.153608e-02-5.869150e-01j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j -4.050811e-17-4.672594e-17j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   7.533735e-01-6.575928e-01j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
  -1.473932e-17-2.671767e-17j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j -9.381308e-01+3.462811e-01j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j -7.996451e-01+1.638218e-01j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   4.610804e-01+3.480444e-01j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
  -2.408410e-17-5.748473e-17j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j -2.842977e-01+9.587360e-01j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  1.453840e-17+3.409414e-17j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
  -2.842977e-01+9.587360e-01j  0.000000e+00+0.000000e+00j]
 [ 1.525927e-17+1.469833e-18j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  3.197300e-01+9.475087e-01j]]
[[-6.956625e-05+1.642255e-04j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  4.351788e-09+3.649803e-10j]
 [ 0.000000e+00+0.000000e+00j -1.578484e-04-8.708069e-05j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
  -5.866873e-09-1.381839e-08j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
  -1.775775e-04-1.012666e-04j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j -4.708585e-10-7.544801e-10j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j -6.875983e-05+3.321179e-05j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
  -2.638427e-05+3.754761e-05j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
  -3.246012e-05+2.314600e-04j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j -3.242924e-09+4.100782e-11j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  1.745013e-04-1.562620e-04j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
  -4.185028e-08-4.552614e-08j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   2.453880e-06+2.043229e-05j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j -4.598264e-05+3.878006e-06j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j -2.185119e-04+8.267062e-05j
  -1.819945e-09+3.302569e-09j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j -5.096087e-09+5.535171e-10j
   2.520738e-05-1.464334e-04j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
  -4.604224e-05+3.840753e-06j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  4.618274e-06+4.808884e-05j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  1.404576e-07+1.545303e-07j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
  -9.586536e-05+8.477921e-05j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   7.528024e-09-3.992882e-09j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  1.366722e-04-4.562837e-05j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j -2.632467e-05+3.750291e-05j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
  -3.968950e-05+2.210663e-05j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
  -6.694134e-11-4.929469e-11j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  3.656061e-05-1.133217e-04j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j]
 [ 0.000000e+00+0.000000e+00j -9.841601e-09-2.520385e-08j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   4.863055e-05-1.596941e-04j  0.000000e+00+0.000000e+00j]
 [ 4.195272e-09+5.087646e-10j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j  0.000000e+00+0.000000e+00j
   0.000000e+00+0.000000e+00j -6.362595e-05-1.854230e-04j]]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="chemistry">
<h2>Chemistry<a class="headerlink" href="#chemistry" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit.quantum_info</span> <span class="kn">import</span> <span class="n">random_statevector</span><span class="p">,</span> <span class="n">Statevector</span><span class="p">,</span> <span class="n">random_unitary</span>
<span class="n">init_st</span> <span class="o">=</span> <span class="n">Statevector</span><span class="o">.</span><span class="n">from_label</span><span class="p">(</span><span class="s1">&#39;0000&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">data</span>
<span class="c1">## tensor product of four random unitaries</span>
<span class="k">def</span> <span class="nf">tensor_random_unitaries</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">rand_U_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">random_unitary</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">data</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
    <span class="n">global_random_U</span> <span class="o">=</span> <span class="n">rand_U_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">global_random_U</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">global_random_U</span><span class="p">,</span> <span class="n">rand_U_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> 
    <span class="k">return</span> <span class="n">global_random_U</span>
<span class="c1"># tensor_random_unitaries(4) @ init_st</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">fermion_ham</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">openfermion</span> <span class="kn">import</span> <span class="n">MolecularData</span>
<span class="kn">from</span> <span class="nn">openfermion.transforms</span> <span class="kn">import</span> <span class="n">get_fermion_operator</span><span class="p">,</span> <span class="n">jordan_wigner</span>
<span class="kn">from</span> <span class="nn">openfermion.linalg</span> <span class="kn">import</span> <span class="n">get_ground_state</span><span class="p">,</span> <span class="n">get_sparse_operator</span>
<span class="kn">from</span> <span class="nn">qiskit.quantum_info</span> <span class="kn">import</span> <span class="n">random_statevector</span><span class="p">,</span> <span class="n">Statevector</span><span class="p">,</span> <span class="n">random_unitary</span>

<span class="n">test_H</span> <span class="o">=</span> <span class="n">hydrogen_chain_hamiltonian</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># np.linalg.norm(sum(test_H.hamiltonian_list), ord=2)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># pstr: 185, [&#39;IIIIIIII&#39;, &#39;ZIIIIIII&#39;, &#39;YZZZYIII&#39;, &#39;XZZZXIII&#39;, &#39;IZIIIIII&#39;, &#39;IYZZZYII&#39;, &#39;IXZZZXII&#39;, &#39;IIZIIIII&#39;, &#39;IIYZZZYI&#39;, &#39;IIXZZZXI&#39;, &#39;IIIZIIII&#39;, &#39;IIIYZZZY&#39;, &#39;IIIXZZZX&#39;, &#39;IIIIZIII&#39;, &#39;IIIIIZII&#39;, &#39;IIIIIIZI&#39;, &#39;IIIIIIIZ&#39;, &#39;ZZIIIIII&#39;, &#39;YIZZYIII&#39;, &#39;XIZZXIII&#39;, &#39;YXXYIIII&#39;, &#39;YYXXIIII&#39;, &#39;XXYYIIII&#39;, &#39;XYYXIIII&#39;, &#39;YXIXZZYI&#39;, &#39;YYIYZZYI&#39;, &#39;XXIXZZXI&#39;, &#39;XYIYZZXI&#39;, &#39;ZYZZZYII&#39;, &#39;ZXZZZXII&#39;, &#39;YXIIXYII&#39;, &#39;YYIIXXII&#39;, &#39;XXIIYYII&#39;, &#39;XYIIYXII&#39;, &#39;YXXZZZZY&#39;, &#39;YYXZZZZX&#39;, &#39;XXYZZZZY&#39;, &#39;XYYZZZZX&#39;, &#39;YXIIIIXY&#39;, &#39;YYIIIIXX&#39;, &#39;XXIIIIYY&#39;, &#39;XYIIIIYX&#39;, &#39;ZIZIIIII&#39;, &#39;ZIYZZZYI&#39;, &#39;ZIXZZZXI&#39;, &#39;YZIZYIII&#39;, &#39;XZIZXIII&#39;, &#39;YZXIXZYI&#39;, &#39;YZYIYZYI&#39;, &#39;YZYIXZXI&#39;, &#39;XZXIYZYI&#39;, &#39;XZXIXZXI&#39;, &#39;XZYIYZXI&#39;, &#39;ZIIZIIII&#39;, &#39;YZZIYIII&#39;, &#39;XZZIXIII&#39;, &#39;YZYYZYII&#39;, &#39;YZYXZXII&#39;, &#39;XZXYZYII&#39;, &#39;XZXXZXII&#39;, &#39;YZZXIXYI&#39;, &#39;YZZYIYYI&#39;, &#39;XZZXIXXI&#39;, &#39;XZZYIYXI&#39;, &#39;ZIIYZZZY&#39;, &#39;ZIIXZZZX&#39;, &#39;YZZXXZZY&#39;, &#39;YZZYXZZX&#39;, &#39;XZZXYZZY&#39;, &#39;XZZYYZZX&#39;, &#39;ZIIIZIII&#39;, &#39;ZIIIIZII&#39;, &#39;YZZZYZII&#39;, &#39;XZZZXZII&#39;, &#39;YZYIIYZY&#39;, &#39;YZYIIXZX&#39;, &#39;XZXIIYZY&#39;, &#39;XZXIIXZX&#39;, &#39;YZZZZXXY&#39;, &#39;YZZZZYXX&#39;, &#39;XZZZZXYY&#39;, &#39;XZZZZYYX&#39;, &#39;ZIIIIIZI&#39;, &#39;YZZZYIZI&#39;, &#39;XZZZXIZI&#39;, &#39;ZIIIIIIZ&#39;, &#39;YZZZYIIZ&#39;, &#39;XZZZXIIZ&#39;, &#39;IZZIIIII&#39;, &#39;IYIZZYII&#39;, &#39;IXIZZXII&#39;, &#39;IYXXYIII&#39;, &#39;IYYXXIII&#39;, &#39;IXXYYIII&#39;, &#39;IXYYXIII&#39;, &#39;IYXIXZZY&#39;, &#39;IYYIYZZY&#39;, &#39;IXXIXZZX&#39;, &#39;IXYIYZZX&#39;, &#39;IZYZZZYI&#39;, &#39;IZXZZZXI&#39;, &#39;IYXIIXYI&#39;, &#39;IYYIIXXI&#39;, &#39;IXXIIYYI&#39;, &#39;IXYIIYXI&#39;, &#39;IZIZIIII&#39;, &#39;IZIYZZZY&#39;, &#39;IZIXZZZX&#39;, &#39;IYZIZYII&#39;, &#39;IXZIZXII&#39;, &#39;IYZXIXZY&#39;, &#39;IYZYIYZY&#39;, &#39;IYZYIXZX&#39;, &#39;IXZXIYZY&#39;, &#39;IXZXIXZX&#39;, &#39;IXZYIYZX&#39;, &#39;IZIIZIII&#39;, &#39;IYZZIYII&#39;, &#39;IXZZIXII&#39;, &#39;IYZYYZYI&#39;, &#39;IYZYXZXI&#39;, &#39;IXZXYZYI&#39;, &#39;IXZXXZXI&#39;, &#39;IYZZXIXY&#39;, &#39;IYZZYIYY&#39;, &#39;IXZZXIXX&#39;, &#39;IXZZYIYX&#39;, &#39;IZIIIZII&#39;, &#39;IZIIIIZI&#39;, &#39;IYZZZYZI&#39;, &#39;IXZZZXZI&#39;, &#39;IZIIIIIZ&#39;, &#39;IYZZZYIZ&#39;, &#39;IXZZZXIZ&#39;, &#39;IIZZIIII&#39;, &#39;IIYIZZYI&#39;, &#39;IIXIZZXI&#39;, &#39;IIYXXYII&#39;, &#39;IIYYXXII&#39;, &#39;IIXXYYII&#39;, &#39;IIXYYXII&#39;, &#39;IIZYZZZY&#39;, &#39;IIZXZZZX&#39;, &#39;IIYXIIXY&#39;, &#39;IIYYIIXX&#39;, &#39;IIXXIIYY&#39;, &#39;IIXYIIYX&#39;, &#39;IIZIZIII&#39;, &#39;IIYZIZYI&#39;, &#39;IIXZIZXI&#39;, &#39;IIZIIZII&#39;, &#39;IIYZZIYI&#39;, &#39;IIXZZIXI&#39;, &#39;IIYZYYZY&#39;, &#39;IIYZYXZX&#39;, &#39;IIXZXYZY&#39;, &#39;IIXZXXZX&#39;, &#39;IIZIIIZI&#39;, &#39;IIZIIIIZ&#39;, &#39;IIYZZZYZ&#39;, &#39;IIXZZZXZ&#39;, &#39;IIIZZIII&#39;, &#39;IIIYIZZY&#39;, &#39;IIIXIZZX&#39;, &#39;IIIYXXYI&#39;, &#39;IIIYYXXI&#39;, &#39;IIIXXYYI&#39;, &#39;IIIXYYXI&#39;, &#39;IIIZIZII&#39;, &#39;IIIYZIZY&#39;, &#39;IIIXZIZX&#39;, &#39;IIIZIIZI&#39;, &#39;IIIYZZIY&#39;, &#39;IIIXZZIX&#39;, &#39;IIIZIIIZ&#39;, &#39;IIIIZZII&#39;, &#39;IIIIYXXY&#39;, &#39;IIIIYYXX&#39;, &#39;IIIIXXYY&#39;, &#39;IIIIXYYX&#39;, &#39;IIIIZIZI&#39;, &#39;IIIIZIIZ&#39;, &#39;IIIIIZZI&#39;, &#39;IIIIIZIZ&#39;, &#39;IIIIIIZZ&#39;]
# groups: 61
[[{&#39;IIIIIIII&#39;: (-0.3314778134168121+0j)}, {&#39;ZIIIIIII&#39;: (0.1813648512899085+0j)}, {&#39;YZZZYIII&#39;: (0.005562131997511082+0j)}], [{&#39;XZZZXIII&#39;: (0.005562131997511082+0j)}, {&#39;IZIIIIII&#39;: (0.18136485128990879+0j)}, {&#39;IYZZZYII&#39;: (0.005562131997511087+0j)}], [{&#39;IXZZZXII&#39;: (0.005562131997511087+0j)}, {&#39;IIZIIIII&#39;: (0.08792644653108547+0j)}, {&#39;IIYZZZYI&#39;: (0.01726656072492462+0j)}], [{&#39;IIXZZZXI&#39;: (0.01726656072492462+0j)}, {&#39;IIIZIIII&#39;: (0.08792644653108546+0j)}, {&#39;IIIYZZZY&#39;: (0.017266560724924607+0j)}], [{&#39;IIIXZZZX&#39;: (0.017266560724924607+0j)}, {&#39;IIIIZIII&#39;: (-0.07904409226124126+0j)}, {&#39;IIIIIZII&#39;: (-0.07904409226124126+0j)}, {&#39;IIIIIIZI&#39;: (-0.3346121300328107+0j)}, {&#39;IIIIIIIZ&#39;: (-0.3346121300328107+0j)}, {&#39;ZZIIIIII&#39;: (0.12432120849362716+0j)}, {&#39;YIZZYIII&#39;: (0.020391298291898504+0j)}], [{&#39;XIZZXIII&#39;: (0.020391298291898504+0j)}, {&#39;YXXYIIII&#39;: (0.0393455135604075+0j)}], [{&#39;YYXXIIII&#39;: (-0.0393455135604075+0j)}, {&#39;XXYYIIII&#39;: (-0.0393455135604075+0j)}, {&#39;XYYXIIII&#39;: (0.0393455135604075+0j)}, {&#39;YXIXZZYI&#39;: (-0.01077099438968182+0j)}, {&#39;YYIYZZYI&#39;: (-0.01077099438968182+0j)}, {&#39;XXIXZZXI&#39;: (-0.01077099438968182+0j)}, {&#39;XYIYZZXI&#39;: (-0.01077099438968182+0j)}, {&#39;ZYZZZYII&#39;: (0.020391298291898504+0j)}, {&#39;ZXZZZXII&#39;: (0.020391298291898504+0j)}], [{&#39;YXIIXYII&#39;: (0.026958030271018903+0j)}], [{&#39;YYIIXXII&#39;: (-0.026958030271018903+0j)}, {&#39;XXIIYYII&#39;: (-0.026958030271018903+0j)}, {&#39;XYIIYXII&#39;: (0.026958030271018903+0j)}], [{&#39;YXXZZZZY&#39;: (0.010770994389681819+0j)}], [{&#39;YYXZZZZX&#39;: (-0.010770994389681819+0j)}, {&#39;XXYZZZZY&#39;: (-0.010770994389681819+0j)}, {&#39;XYYZZZZX&#39;: (0.010770994389681819+0j)}, {&#39;YXIIIIXY&#39;: (0.02426737424983091+0j)}, {&#39;YYIIIIXX&#39;: (-0.02426737424983091+0j)}, {&#39;XXIIIIYY&#39;: (-0.02426737424983091+0j)}, {&#39;XYIIIIYX&#39;: (0.02426737424983091+0j)}], [{&#39;ZIZIIIII&#39;: (0.06963750845631889+0j)}], [{&#39;ZIYZZZYI&#39;: (-0.010290902970907612+0j)}], [{&#39;ZIXZZZXI&#39;: (-0.010290902970907612+0j)}, {&#39;YZIZYIII&#39;: (0.022048950231499123+0j)}, {&#39;XZIZXIII&#39;: (0.022048950231499123+0j)}], [{&#39;YZXIXZYI&#39;: (-0.011388105812468973+0j)}, {&#39;YZYIYZYI&#39;: (-0.02441822802586467+0j)}, {&#39;YZYIXZXI&#39;: (-0.013030122213395706+0j)}, {&#39;XZXIYZYI&#39;: (-0.013030122213395706+0j)}, {&#39;XZXIXZXI&#39;: (-0.02441822802586467+0j)}, {&#39;XZYIYZXI&#39;: (-0.011388105812468973+0j)}], [{&#39;ZIIZIIII&#39;: (0.10898302201672638+0j)}, {&#39;YZZIYIII&#39;: (-0.0024512883013734607+0j)}], [{&#39;XZZIXIII&#39;: (-0.0024512883013734607+0j)}, {&#39;YZYYZYII&#39;: (0.024500238532872583+0j)}], [{&#39;YZYXZXII&#39;: (0.024500238532872583+0j)}, {&#39;XZXYZYII&#39;: (0.024500238532872583+0j)}, {&#39;XZXXZXII&#39;: (0.024500238532872583+0j)}, {&#39;YZZXIXYI&#39;: (0.01324013991721502+0j)}, {&#39;YZZYIYYI&#39;: (0.01324013991721502+0j)}, {&#39;XZZXIXXI&#39;: (0.01324013991721502+0j)}, {&#39;XZZYIYXI&#39;: (0.01324013991721502+0j)}, {&#39;ZIIYZZZY&#39;: (-0.021061897360589433+0j)}, {&#39;ZIIXZZZX&#39;: (-0.021061897360589433+0j)}], [{&#39;YZZXXZZY&#39;: (-0.024628245729683994+0j)}], [{&#39;YZZYXZZX&#39;: (0.024628245729683994+0j)}, {&#39;XZZXYZZY&#39;: (0.024628245729683994+0j)}, {&#39;XZZYYZZX&#39;: (-0.024628245729683994+0j)}, {&#39;ZIIIZIII&#39;: (0.08454049215503276+0j)}], [{&#39;ZIIIIZII&#39;: (0.11149852242605165+0j)}, {&#39;YZZZYZII&#39;: (0.001715657038636661+0j)}], [{&#39;XZZZXZII&#39;: (0.001715657038636661+0j)}, {&#39;YZYIIYZY&#39;: (-0.037658367943079696+0j)}], [{&#39;YZYIIXZX&#39;: (-0.037658367943079696+0j)}, {&#39;XZXIIYZY&#39;: (-0.037658367943079696+0j)}, {&#39;XZXIIXZX&#39;: (-0.037658367943079696+0j)}, {&#39;YZZZZXXY&#39;: (-0.010242352362581511+0j)}, {&#39;YZZZZYXX&#39;: (0.010242352362581511+0j)}, {&#39;XZZZZXYY&#39;: (0.010242352362581511+0j)}, {&#39;XZZZZYYX&#39;: (-0.010242352362581511+0j)}, {&#39;ZIIIIIZI&#39;: (0.10647068453545322+0j)}], [{&#39;YZZZYIZI&#39;: (0.011234473400252893+0j)}], [{&#39;XZZZXIZI&#39;: (0.011234473400252893+0j)}], [{&#39;ZIIIIIIZ&#39;: (0.13073805878528413+0j)}, {&#39;YZZZYIIZ&#39;: (0.021476825762834405+0j)}], [{&#39;XZZZXIIZ&#39;: (0.021476825762834405+0j)}, {&#39;IZZIIIII&#39;: (0.10898302201672638+0j)}, {&#39;IYIZZYII&#39;: (-0.0024512883013734607+0j)}], [{&#39;IXIZZXII&#39;: (-0.0024512883013734607+0j)}, {&#39;IYXXYIII&#39;: (0.024500238532872583+0j)}], [{&#39;IYYXXIII&#39;: (-0.024500238532872583+0j)}, {&#39;IXXYYIII&#39;: (-0.024500238532872583+0j)}, {&#39;IXYYXIII&#39;: (0.024500238532872583+0j)}, {&#39;IYXIXZZY&#39;: (0.01324013991721502+0j)}, {&#39;IYYIYZZY&#39;: (0.01324013991721502+0j)}, {&#39;IXXIXZZX&#39;: (0.01324013991721502+0j)}, {&#39;IXYIYZZX&#39;: (0.01324013991721502+0j)}, {&#39;IZYZZZYI&#39;: (-0.021061897360589433+0j)}, {&#39;IZXZZZXI&#39;: (-0.021061897360589433+0j)}], [{&#39;IYXIIXYI&#39;: (-0.024628245729683994+0j)}], [{&#39;IYYIIXXI&#39;: (0.024628245729683994+0j)}, {&#39;IXXIIYYI&#39;: (0.024628245729683994+0j)}, {&#39;IXYIIYXI&#39;: (-0.024628245729683994+0j)}], [{&#39;IZIZIIII&#39;: (0.06963750845631889+0j)}], [{&#39;IZIYZZZY&#39;: (-0.010290902970907612+0j)}], [{&#39;IZIXZZZX&#39;: (-0.010290902970907612+0j)}, {&#39;IYZIZYII&#39;: (0.022048950231499123+0j)}, {&#39;IXZIZXII&#39;: (0.022048950231499123+0j)}], [{&#39;IYZXIXZY&#39;: (-0.011388105812468973+0j)}, {&#39;IYZYIYZY&#39;: (-0.02441822802586467+0j)}, {&#39;IYZYIXZX&#39;: (-0.013030122213395706+0j)}, {&#39;IXZXIYZY&#39;: (-0.013030122213395706+0j)}, {&#39;IXZXIXZX&#39;: (-0.02441822802586467+0j)}, {&#39;IXZYIYZX&#39;: (-0.011388105812468973+0j)}], [{&#39;IZIIZIII&#39;: (0.11149852242605165+0j)}, {&#39;IYZZIYII&#39;: (0.001715657038636661+0j)}], [{&#39;IXZZIXII&#39;: (0.001715657038636661+0j)}, {&#39;IYZYYZYI&#39;: (-0.037658367943079696+0j)}], [{&#39;IYZYXZXI&#39;: (-0.037658367943079696+0j)}, {&#39;IXZXYZYI&#39;: (-0.037658367943079696+0j)}, {&#39;IXZXXZXI&#39;: (-0.037658367943079696+0j)}, {&#39;IYZZXIXY&#39;: (0.010242352362581511+0j)}, {&#39;IYZZYIYY&#39;: (0.010242352362581511+0j)}, {&#39;IXZZXIXX&#39;: (0.010242352362581511+0j)}, {&#39;IXZZYIYX&#39;: (0.010242352362581511+0j)}], [{&#39;IZIIIZII&#39;: (0.08454049215503276+0j)}, {&#39;IZIIIIZI&#39;: (0.13073805878528413+0j)}, {&#39;IYZZZYZI&#39;: (0.021476825762834405+0j)}], [{&#39;IXZZZXZI&#39;: (0.021476825762834405+0j)}], [{&#39;IZIIIIIZ&#39;: (0.10647068453545322+0j)}, {&#39;IYZZZYIZ&#39;: (0.011234473400252893+0j)}], [{&#39;IXZZZXIZ&#39;: (0.011234473400252893+0j)}, {&#39;IIZZIIII&#39;: (0.11340654161438057+0j)}, {&#39;IIYIZZYI&#39;: (-0.0010141239253515814+0j)}], [{&#39;IIXIZZXI&#39;: (-0.0010141239253515814+0j)}, {&#39;IIYXXYII&#39;: (0.03432067768053545+0j)}], [{&#39;IIYYXXII&#39;: (-0.03432067768053545+0j)}, {&#39;IIXXYYII&#39;: (-0.03432067768053545+0j)}, {&#39;IIXYYXII&#39;: (0.03432067768053545+0j)}, {&#39;IIZYZZZY&#39;: (-0.0010141239253515814+0j)}, {&#39;IIZXZZZX&#39;: (-0.0010141239253515814+0j)}], [{&#39;IIYXIIXY&#39;: (0.02616133175779298+0j)}], [{&#39;IIYYIIXX&#39;: (-0.02616133175779298+0j)}, {&#39;IIXXIIYY&#39;: (-0.02616133175779298+0j)}, {&#39;IIXYIIYX&#39;: (0.02616133175779298+0j)}], [{&#39;IIZIZIII&#39;: (0.07762037309982325+0j)}, {&#39;IIYZIZYI&#39;: (-0.025545241514434595+0j)}], [{&#39;IIXZIZXI&#39;: (-0.025545241514434595+0j)}], [{&#39;IIZIIZII&#39;: (0.11194105078035871+0j)}, {&#39;IIYZZIYI&#39;: (-0.0007036277600324646+0j)}], [{&#39;IIXZZIXI&#39;: (-0.0007036277600324646+0j)}, {&#39;IIYZYYZY&#39;: (-0.02484161375440213+0j)}], [{&#39;IIYZYXZX&#39;: (-0.02484161375440213+0j)}, {&#39;IIXZXYZY&#39;: (-0.02484161375440213+0j)}, {&#39;IIXZXXZX&#39;: (-0.02484161375440213+0j)}], [{&#39;IIZIIIZI&#39;: (0.08982499235931941+0j)}, {&#39;IIZIIIIZ&#39;: (0.1159863241171124+0j)}, {&#39;IIYZZZYZ&#39;: (-0.023384504139548214+0j)}], [{&#39;IIXZZZXZ&#39;: (-0.023384504139548214+0j)}, {&#39;IIIZZIII&#39;: (0.11194105078035871+0j)}], [{&#39;IIIYIZZY&#39;: (-0.0007036277600324646+0j)}], [{&#39;IIIXIZZX&#39;: (-0.0007036277600324646+0j)}, {&#39;IIIYXXYI&#39;: (-0.02484161375440213+0j)}], [{&#39;IIIYYXXI&#39;: (0.02484161375440213+0j)}, {&#39;IIIXXYYI&#39;: (0.02484161375440213+0j)}, {&#39;IIIXYYXI&#39;: (-0.02484161375440213+0j)}, {&#39;IIIZIZII&#39;: (0.07762037309982325+0j)}], [{&#39;IIIYZIZY&#39;: (-0.025545241514434595+0j)}], [{&#39;IIIXZIZX&#39;: (-0.025545241514434595+0j)}], [{&#39;IIIZIIZI&#39;: (0.1159863241171124+0j)}, {&#39;IIIYZZIY&#39;: (-0.023384504139548214+0j)}], [{&#39;IIIXZZIX&#39;: (-0.023384504139548214+0j)}, {&#39;IIIZIIIZ&#39;: (0.08982499235931941+0j)}, {&#39;IIIIZZII&#39;: (0.11685143854472024+0j)}], [{&#39;IIIIYXXY&#39;: (0.04061611948384259+0j)}, {&#39;IIIIYYXX&#39;: (-0.04061611948384259+0j)}, {&#39;IIIIXXYY&#39;: (-0.04061611948384259+0j)}, {&#39;IIIIXYYX&#39;: (0.04061611948384259+0j)}, {&#39;IIIIZIZI&#39;: (0.07943848632286903+0j)}, {&#39;IIIIZIIZ&#39;: (0.12005460580671162+0j)}, {&#39;IIIIIZZI&#39;: (0.12005460580671162+0j)}, {&#39;IIIIIZIZ&#39;: (0.07943848632286903+0j)}, {&#39;IIIIIIZZ&#39;: (0.14526147930807762+0j)}]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pstrs</span> <span class="o">=</span> <span class="n">test_H</span><span class="o">.</span><span class="n">pstrs</span>
<span class="n">pstrs_coeff</span> <span class="o">=</span> <span class="n">test_H</span><span class="o">.</span><span class="n">pstrs_coeff</span>
<span class="n">pstr_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">pstrs</span><span class="p">,</span> <span class="n">pstrs_coeff</span><span class="p">))</span>
<span class="n">pstr_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">pstr_dict</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">pstr_dict</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;IIIIII&#39;: (-0.33362884012829697+0j),
 &#39;IIIIZI&#39;: (-0.2535728967411679+0j),
 &#39;IIIIIZ&#39;: (-0.2535728967411678+0j),
 &#39;ZIIIII&#39;: (0.16891173410254534+0j),
 &#39;IZIIII&#39;: (0.16891173410254526+0j),
 &#39;IIIIZZ&#39;: (0.15636653196999328+0j),
 &#39;ZIIIIZ&#39;: (0.14393931792176595+0j),
 &#39;IZIIZI&#39;: (0.14393931792176595+0j),
 &#39;ZZIIII&#39;: (0.13984206636700175+0j),
 &#39;IIZZII&#39;: (0.13366602988233992+0j),
 &#39;IIZIIZ&#39;: (0.12808287511497618+0j),
 &#39;IIIZZI&#39;: (0.12808287511497618+0j),
 &#39;ZIIZII&#39;: (0.12165165588763656+0j),
 &#39;IZZIII&#39;: (0.12165165588763656+0j),
 &#39;ZIIIZI&#39;: (0.11003101552075459+0j),
 &#39;IZIIIZ&#39;: (0.11003101552075459+0j),
 &#39;IIZIZI&#39;: (0.09048399816423514+0j),
 &#39;IIIZIZ&#39;: (0.09048399816423514+0j),
 &#39;ZIZIII&#39;: (0.08295876958230786+0j),
 &#39;IZIZII&#39;: (0.08295876958230786+0j),
 &#39;YXXYII&#39;: (0.038692886305328696+0j),
 &#39;YYXXII&#39;: (-0.038692886305328696+0j),
 &#39;XXYYII&#39;: (-0.038692886305328696+0j),
 &#39;XYYXII&#39;: (0.038692886305328696+0j),
 &#39;IIYXXY&#39;: (0.03759887695074104+0j),
 &#39;IIYYXX&#39;: (-0.03759887695074104+0j),
 &#39;IIXXYY&#39;: (-0.03759887695074104+0j),
 &#39;IIXYYX&#39;: (0.03759887695074104+0j),
 &#39;YZYYZY&#39;: (-0.03521138648486378+0j),
 &#39;YZYXZX&#39;: (-0.03521138648486378+0j),
 &#39;XZXYZY&#39;: (-0.03521138648486378+0j),
 &#39;XZXXZX&#39;: (-0.03521138648486378+0j),
 &#39;IYXXYI&#39;: (-0.03521138648486378+0j),
 &#39;IYYXXI&#39;: (0.03521138648486378+0j),
 &#39;IXXYYI&#39;: (0.03521138648486378+0j),
 &#39;IXYYXI&#39;: (-0.03521138648486378+0j),
 &#39;YXIIXY&#39;: (0.03390830240101133+0j),
 &#39;YYIIXX&#39;: (-0.03390830240101133+0j),
 &#39;XXIIYY&#39;: (-0.03390830240101133+0j),
 &#39;XYIIYX&#39;: (0.03390830240101133+0j),
 &#39;YZIZYI&#39;: (-0.02573161133632447+0j),
 &#39;XZIZXI&#39;: (-0.02573161133632447+0j),
 &#39;IYZIZY&#39;: (-0.02573161133632447+0j),
 &#39;IXZIZX&#39;: (-0.02573161133632447+0j),
 &#39;IYZZIY&#39;: (-0.022469085890221424+0j),
 &#39;IXZZIX&#39;: (-0.022469085890221424+0j),
 &#39;YZZZYZ&#39;: (-0.02246908589022142+0j),
 &#39;XZZZXZ&#39;: (-0.02246908589022142+0j),
 &#39;YIZZYI&#39;: (-0.022007608492169456+0j),
 &#39;XIZZXI&#39;: (-0.022007608492169456+0j),
 &#39;ZYZZZY&#39;: (-0.022007608492169456+0j),
 &#39;ZXZZZX&#39;: (-0.022007608492169456+0j),
 &#39;IIZIII&#39;: (0.020862150051427164+0j),
 &#39;IIIZII&#39;: (0.02086215005142716+0j),
 &#39;YZZIYI&#39;: (0.009479775148539305+0j),
 &#39;XZZIXI&#39;: (0.009479775148539305+0j),
 &#39;IYIZZY&#39;: (0.009479775148539305+0j),
 &#39;IXIZZX&#39;: (0.009479775148539305+0j),
 &#39;IYZZZY&#39;: (0.00046147784435555516+0j),
 &#39;IXZZZX&#39;: (0.00046147784435555516+0j),
 &#39;YZZZYI&#39;: (0.0004614778443555352+0j),
 &#39;XZZZXI&#39;: (0.0004614778443555352+0j)}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">group</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">keys</span><span class="p">())))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;IIIIII&#39;: (-0.33362884012829697+0j)}
IIIIII
[{&#39;IIIIII&#39;: (-0.33362884012829697+0j)}]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bounds</span> <span class="kn">import</span> <span class="o">*</span>
<span class="c1"># np.abs(commutator(SparsePauliOp.from_list([(pstrs[0],1)]), SparsePauliOp.from_list([(pstrs[1],1)])).simplify().coeffs)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">H_10</span> <span class="o">=</span> <span class="n">hydrogen_chain_hamiltonian</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">pstrs_10</span> <span class="o">=</span> <span class="n">H_10</span><span class="o">.</span><span class="n">pstrs</span>

<span class="n">H_1</span> <span class="o">=</span> <span class="n">hydrogen_chain_hamiltonian</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">pstrs_1</span> <span class="o">=</span> <span class="n">H_1</span><span class="o">.</span><span class="n">pstrs</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">pstrs_10</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">pstrs_1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">pstrs_10</span><span class="p">)</span><span class="o">-</span><span class="nb">set</span><span class="p">(</span><span class="n">pstrs_1</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># pstr: 65, [&#39;IIIIIIII&#39;, &#39;ZIIIIIII&#39;, &#39;IZIIIIII&#39;, &#39;IIZIIIII&#39;, &#39;IIIZIIII&#39;, &#39;IIIIZIII&#39;, &#39;IIIIIZII&#39;, &#39;IIIIIIZI&#39;, &#39;IIIIIIIZ&#39;, &#39;ZZIIIIII&#39;, &#39;ZIZIIIII&#39;, &#39;ZIIZIIII&#39;, &#39;ZIIIZIII&#39;, &#39;ZIIIYZYI&#39;, &#39;ZIIIXZXI&#39;, &#39;ZIIIIZII&#39;, &#39;ZIIIIYZY&#39;, &#39;ZIIIIXZX&#39;, &#39;ZIIIIIZI&#39;, &#39;ZIIIIIIZ&#39;, &#39;IZZIIIII&#39;, &#39;IZIZIIII&#39;, &#39;IZIIZIII&#39;, &#39;IZIIYZYI&#39;, &#39;IZIIXZXI&#39;, &#39;IZIIIZII&#39;, &#39;IZIIIYZY&#39;, &#39;IZIIIXZX&#39;, &#39;IZIIIIZI&#39;, &#39;IZIIIIIZ&#39;, &#39;IIZZIIII&#39;, &#39;IIZIZIII&#39;, &#39;IIZIYZYI&#39;, &#39;IIZIXZXI&#39;, &#39;IIZIIZII&#39;, &#39;IIZIIYZY&#39;, &#39;IIZIIXZX&#39;, &#39;IIZIIIZI&#39;, &#39;IIZIIIIZ&#39;, &#39;IIIZZIII&#39;, &#39;IIIZYZYI&#39;, &#39;IIIZXZXI&#39;, &#39;IIIZIZII&#39;, &#39;IIIZIYZY&#39;, &#39;IIIZIXZX&#39;, &#39;IIIZIIZI&#39;, &#39;IIIZIIIZ&#39;, &#39;IIIIZZII&#39;, &#39;IIIIYIYI&#39;, &#39;IIIIXIXI&#39;, &#39;IIIIZYZY&#39;, &#39;IIIIZXZX&#39;, &#39;IIIIYXXY&#39;, &#39;IIIIYYXX&#39;, &#39;IIIIXXYY&#39;, &#39;IIIIXYYX&#39;, &#39;IIIIZIZI&#39;, &#39;IIIIZIIZ&#39;, &#39;IIIIYZYZ&#39;, &#39;IIIIXZXZ&#39;, &#39;IIIIIZZI&#39;, &#39;IIIIIYIY&#39;, &#39;IIIIIXIX&#39;, &#39;IIIIIZIZ&#39;, &#39;IIIIIIZZ&#39;]
# groups: 20
[[{&#39;IIIIIIII&#39;: (-1.0917214543091758+0j)}, {&#39;ZIIIIIII&#39;: (0.03963943879865647+0j)}, {&#39;IZIIIIII&#39;: (0.0396394387986565+0j)}, {&#39;IIZIIIII&#39;: (0.03963943879865654+0j)}, {&#39;IIIZIIII&#39;: (0.03963943879865652+0j)}, {&#39;IIIIZIII&#39;: (0.039639438798696434+0j)}, {&#39;IIIIIZII&#39;: (0.039639438798696386+0j)}, {&#39;IIIIIIZI&#39;: (0.03963943879861645+0j)}, {&#39;IIIIIIIZ&#39;: (0.039639438798616505+0j)}, {&#39;ZZIIIIII&#39;: (0.19365148597996762+0j)}, {&#39;ZIZIIIII&#39;: (0.00440981009100008+0j)}, {&#39;ZIIZIIII&#39;: (0.00440981009100008+0j)}, {&#39;ZIIIZIII&#39;: (0.00991722690647232+0j)}, {&#39;ZIIIYZYI&#39;: (-0.003307354018323614+0j)}], [{&#39;ZIIIXZXI&#39;: (-0.003307354018323614+0j)}, {&#39;ZIIIIZII&#39;: (0.00991722690647232+0j)}, {&#39;ZIIIIYZY&#39;: (-0.003307354018323614+0j)}], [{&#39;ZIIIIXZX&#39;: (-0.003307354018323614+0j)}, {&#39;ZIIIIIZI&#39;: (0.00992691850303443+0j)}], [{&#39;ZIIIIIIZ&#39;: (0.00992691850303443+0j)}, {&#39;IZZIIIII&#39;: (0.00440981009100008+0j)}, {&#39;IZIZIIII&#39;: (0.00440981009100008+0j)}, {&#39;IZIIZIII&#39;: (0.00991722690647232+0j)}, {&#39;IZIIYZYI&#39;: (-0.003307354018323614+0j)}], [{&#39;IZIIXZXI&#39;: (-0.003307354018323614+0j)}, {&#39;IZIIIZII&#39;: (0.00991722690647232+0j)}, {&#39;IZIIIYZY&#39;: (-0.003307354018323614+0j)}], [{&#39;IZIIIXZX&#39;: (-0.003307354018323614+0j)}, {&#39;IZIIIIZI&#39;: (0.00992691850303443+0j)}], [{&#39;IZIIIIIZ&#39;: (0.00992691850303443+0j)}, {&#39;IIZZIIII&#39;: (0.19365148597996773+0j)}, {&#39;IIZIZIII&#39;: (0.009926918503034118+0j)}, {&#39;IIZIYZYI&#39;: (0.0033073540183236163+0j)}], [{&#39;IIZIXZXI&#39;: (0.0033073540183236163+0j)}, {&#39;IIZIIZII&#39;: (0.009926918503034118+0j)}, {&#39;IIZIIYZY&#39;: (0.0033073540183236163+0j)}], [{&#39;IIZIIXZX&#39;: (0.0033073540183236163+0j)}, {&#39;IIZIIIZI&#39;: (0.00991722690647264+0j)}], [{&#39;IIZIIIIZ&#39;: (0.00991722690647264+0j)}, {&#39;IIIZZIII&#39;: (0.009926918503034118+0j)}, {&#39;IIIZYZYI&#39;: (0.0033073540183236163+0j)}], [{&#39;IIIZXZXI&#39;: (0.0033073540183236163+0j)}, {&#39;IIIZIZII&#39;: (0.009926918503034118+0j)}, {&#39;IIIZIYZY&#39;: (0.0033073540183236163+0j)}], [{&#39;IIIZIXZX&#39;: (0.0033073540183236163+0j)}, {&#39;IIIZIIZI&#39;: (0.00991722690647264+0j)}], [{&#39;IIIZIIIZ&#39;: (0.00991722690647264+0j)}, {&#39;IIIIZZII&#39;: (0.103440651781159+0j)}, {&#39;IIIIYIYI&#39;: (0.00013217318220454938+0j)}], [{&#39;IIIIXIXI&#39;: (0.00013217318220454938+0j)}, {&#39;IIIIZYZY&#39;: (0.00013217318220454938+0j)}, {&#39;IIIIZXZX&#39;: (0.00013217318220454938+0j)}], [{&#39;IIIIYXXY&#39;: (0.0902108341988055+0j)}], [{&#39;IIIIYYXX&#39;: (-0.0902108341988055+0j)}, {&#39;IIIIXXYY&#39;: (-0.0902108341988055+0j)}, {&#39;IIIIXYYX&#39;: (0.0902108341988055+0j)}, {&#39;IIIIZIZI&#39;: (0.013229430272999762+0j)}, {&#39;IIIIZIIZ&#39;: (0.10344026447180528+0j)}, {&#39;IIIIYZYZ&#39;: (-0.00013217318220455632+0j)}], [{&#39;IIIIXZXZ&#39;: (-0.00013217318220455632+0j)}], [{&#39;IIIIIZZI&#39;: (0.10344026447180528+0j)}, {&#39;IIIIIYIY&#39;: (-0.00013217318220455632+0j)}], [{&#39;IIIIIXIX&#39;: (-0.00013217318220455632+0j)}, {&#39;IIIIIZIZ&#39;: (0.013229430272999762+0j)}], [{&#39;IIIIIIZZ&#39;: (0.10344065178116557+0j)}]]
# pstr: 185, [&#39;IIIIIIII&#39;, &#39;ZIIIIIII&#39;, &#39;YZZZYIII&#39;, &#39;XZZZXIII&#39;, &#39;IZIIIIII&#39;, &#39;IYZZZYII&#39;, &#39;IXZZZXII&#39;, &#39;IIZIIIII&#39;, &#39;IIYZZZYI&#39;, &#39;IIXZZZXI&#39;, &#39;IIIZIIII&#39;, &#39;IIIYZZZY&#39;, &#39;IIIXZZZX&#39;, &#39;IIIIZIII&#39;, &#39;IIIIIZII&#39;, &#39;IIIIIIZI&#39;, &#39;IIIIIIIZ&#39;, &#39;ZZIIIIII&#39;, &#39;YIZZYIII&#39;, &#39;XIZZXIII&#39;, &#39;YXXYIIII&#39;, &#39;YYXXIIII&#39;, &#39;XXYYIIII&#39;, &#39;XYYXIIII&#39;, &#39;YXIXZZYI&#39;, &#39;YYIYZZYI&#39;, &#39;XXIXZZXI&#39;, &#39;XYIYZZXI&#39;, &#39;ZYZZZYII&#39;, &#39;ZXZZZXII&#39;, &#39;YXIIXYII&#39;, &#39;YYIIXXII&#39;, &#39;XXIIYYII&#39;, &#39;XYIIYXII&#39;, &#39;YXXZZZZY&#39;, &#39;YYXZZZZX&#39;, &#39;XXYZZZZY&#39;, &#39;XYYZZZZX&#39;, &#39;YXIIIIXY&#39;, &#39;YYIIIIXX&#39;, &#39;XXIIIIYY&#39;, &#39;XYIIIIYX&#39;, &#39;ZIZIIIII&#39;, &#39;ZIYZZZYI&#39;, &#39;ZIXZZZXI&#39;, &#39;YZIZYIII&#39;, &#39;XZIZXIII&#39;, &#39;YZXIXZYI&#39;, &#39;YZYIYZYI&#39;, &#39;YZYIXZXI&#39;, &#39;XZXIYZYI&#39;, &#39;XZXIXZXI&#39;, &#39;XZYIYZXI&#39;, &#39;ZIIZIIII&#39;, &#39;YZZIYIII&#39;, &#39;XZZIXIII&#39;, &#39;YZYYZYII&#39;, &#39;YZYXZXII&#39;, &#39;XZXYZYII&#39;, &#39;XZXXZXII&#39;, &#39;YZZXIXYI&#39;, &#39;YZZYIYYI&#39;, &#39;XZZXIXXI&#39;, &#39;XZZYIYXI&#39;, &#39;ZIIYZZZY&#39;, &#39;ZIIXZZZX&#39;, &#39;YZZXXZZY&#39;, &#39;YZZYXZZX&#39;, &#39;XZZXYZZY&#39;, &#39;XZZYYZZX&#39;, &#39;ZIIIZIII&#39;, &#39;ZIIIIZII&#39;, &#39;YZZZYZII&#39;, &#39;XZZZXZII&#39;, &#39;YZYIIYZY&#39;, &#39;YZYIIXZX&#39;, &#39;XZXIIYZY&#39;, &#39;XZXIIXZX&#39;, &#39;YZZZZXXY&#39;, &#39;YZZZZYXX&#39;, &#39;XZZZZXYY&#39;, &#39;XZZZZYYX&#39;, &#39;ZIIIIIZI&#39;, &#39;YZZZYIZI&#39;, &#39;XZZZXIZI&#39;, &#39;ZIIIIIIZ&#39;, &#39;YZZZYIIZ&#39;, &#39;XZZZXIIZ&#39;, &#39;IZZIIIII&#39;, &#39;IYIZZYII&#39;, &#39;IXIZZXII&#39;, &#39;IYXXYIII&#39;, &#39;IYYXXIII&#39;, &#39;IXXYYIII&#39;, &#39;IXYYXIII&#39;, &#39;IYXIXZZY&#39;, &#39;IYYIYZZY&#39;, &#39;IXXIXZZX&#39;, &#39;IXYIYZZX&#39;, &#39;IZYZZZYI&#39;, &#39;IZXZZZXI&#39;, &#39;IYXIIXYI&#39;, &#39;IYYIIXXI&#39;, &#39;IXXIIYYI&#39;, &#39;IXYIIYXI&#39;, &#39;IZIZIIII&#39;, &#39;IZIYZZZY&#39;, &#39;IZIXZZZX&#39;, &#39;IYZIZYII&#39;, &#39;IXZIZXII&#39;, &#39;IYZXIXZY&#39;, &#39;IYZYIYZY&#39;, &#39;IYZYIXZX&#39;, &#39;IXZXIYZY&#39;, &#39;IXZXIXZX&#39;, &#39;IXZYIYZX&#39;, &#39;IZIIZIII&#39;, &#39;IYZZIYII&#39;, &#39;IXZZIXII&#39;, &#39;IYZYYZYI&#39;, &#39;IYZYXZXI&#39;, &#39;IXZXYZYI&#39;, &#39;IXZXXZXI&#39;, &#39;IYZZXIXY&#39;, &#39;IYZZYIYY&#39;, &#39;IXZZXIXX&#39;, &#39;IXZZYIYX&#39;, &#39;IZIIIZII&#39;, &#39;IZIIIIZI&#39;, &#39;IYZZZYZI&#39;, &#39;IXZZZXZI&#39;, &#39;IZIIIIIZ&#39;, &#39;IYZZZYIZ&#39;, &#39;IXZZZXIZ&#39;, &#39;IIZZIIII&#39;, &#39;IIYIZZYI&#39;, &#39;IIXIZZXI&#39;, &#39;IIYXXYII&#39;, &#39;IIYYXXII&#39;, &#39;IIXXYYII&#39;, &#39;IIXYYXII&#39;, &#39;IIZYZZZY&#39;, &#39;IIZXZZZX&#39;, &#39;IIYXIIXY&#39;, &#39;IIYYIIXX&#39;, &#39;IIXXIIYY&#39;, &#39;IIXYIIYX&#39;, &#39;IIZIZIII&#39;, &#39;IIYZIZYI&#39;, &#39;IIXZIZXI&#39;, &#39;IIZIIZII&#39;, &#39;IIYZZIYI&#39;, &#39;IIXZZIXI&#39;, &#39;IIYZYYZY&#39;, &#39;IIYZYXZX&#39;, &#39;IIXZXYZY&#39;, &#39;IIXZXXZX&#39;, &#39;IIZIIIZI&#39;, &#39;IIZIIIIZ&#39;, &#39;IIYZZZYZ&#39;, &#39;IIXZZZXZ&#39;, &#39;IIIZZIII&#39;, &#39;IIIYIZZY&#39;, &#39;IIIXIZZX&#39;, &#39;IIIYXXYI&#39;, &#39;IIIYYXXI&#39;, &#39;IIIXXYYI&#39;, &#39;IIIXYYXI&#39;, &#39;IIIZIZII&#39;, &#39;IIIYZIZY&#39;, &#39;IIIXZIZX&#39;, &#39;IIIZIIZI&#39;, &#39;IIIYZZIY&#39;, &#39;IIIXZZIX&#39;, &#39;IIIZIIIZ&#39;, &#39;IIIIZZII&#39;, &#39;IIIIYXXY&#39;, &#39;IIIIYYXX&#39;, &#39;IIIIXXYY&#39;, &#39;IIIIXYYX&#39;, &#39;IIIIZIZI&#39;, &#39;IIIIZIIZ&#39;, &#39;IIIIIZZI&#39;, &#39;IIIIIZIZ&#39;, &#39;IIIIIIZZ&#39;]
# groups: 61
[[{&#39;IIIIIIII&#39;: (-0.3314778134168121+0j)}, {&#39;ZIIIIIII&#39;: (0.1813648512899085+0j)}, {&#39;YZZZYIII&#39;: (0.005562131997511082+0j)}], [{&#39;XZZZXIII&#39;: (0.005562131997511082+0j)}, {&#39;IZIIIIII&#39;: (0.18136485128990879+0j)}, {&#39;IYZZZYII&#39;: (0.005562131997511087+0j)}], [{&#39;IXZZZXII&#39;: (0.005562131997511087+0j)}, {&#39;IIZIIIII&#39;: (0.08792644653108547+0j)}, {&#39;IIYZZZYI&#39;: (0.01726656072492462+0j)}], [{&#39;IIXZZZXI&#39;: (0.01726656072492462+0j)}, {&#39;IIIZIIII&#39;: (0.08792644653108546+0j)}, {&#39;IIIYZZZY&#39;: (0.017266560724924607+0j)}], [{&#39;IIIXZZZX&#39;: (0.017266560724924607+0j)}, {&#39;IIIIZIII&#39;: (-0.07904409226124126+0j)}, {&#39;IIIIIZII&#39;: (-0.07904409226124126+0j)}, {&#39;IIIIIIZI&#39;: (-0.3346121300328107+0j)}, {&#39;IIIIIIIZ&#39;: (-0.3346121300328107+0j)}, {&#39;ZZIIIIII&#39;: (0.12432120849362716+0j)}, {&#39;YIZZYIII&#39;: (0.020391298291898504+0j)}], [{&#39;XIZZXIII&#39;: (0.020391298291898504+0j)}, {&#39;YXXYIIII&#39;: (0.0393455135604075+0j)}], [{&#39;YYXXIIII&#39;: (-0.0393455135604075+0j)}, {&#39;XXYYIIII&#39;: (-0.0393455135604075+0j)}, {&#39;XYYXIIII&#39;: (0.0393455135604075+0j)}, {&#39;YXIXZZYI&#39;: (-0.01077099438968182+0j)}, {&#39;YYIYZZYI&#39;: (-0.01077099438968182+0j)}, {&#39;XXIXZZXI&#39;: (-0.01077099438968182+0j)}, {&#39;XYIYZZXI&#39;: (-0.01077099438968182+0j)}, {&#39;ZYZZZYII&#39;: (0.020391298291898504+0j)}, {&#39;ZXZZZXII&#39;: (0.020391298291898504+0j)}], [{&#39;YXIIXYII&#39;: (0.026958030271018903+0j)}], [{&#39;YYIIXXII&#39;: (-0.026958030271018903+0j)}, {&#39;XXIIYYII&#39;: (-0.026958030271018903+0j)}, {&#39;XYIIYXII&#39;: (0.026958030271018903+0j)}], [{&#39;YXXZZZZY&#39;: (0.010770994389681819+0j)}], [{&#39;YYXZZZZX&#39;: (-0.010770994389681819+0j)}, {&#39;XXYZZZZY&#39;: (-0.010770994389681819+0j)}, {&#39;XYYZZZZX&#39;: (0.010770994389681819+0j)}, {&#39;YXIIIIXY&#39;: (0.02426737424983091+0j)}, {&#39;YYIIIIXX&#39;: (-0.02426737424983091+0j)}, {&#39;XXIIIIYY&#39;: (-0.02426737424983091+0j)}, {&#39;XYIIIIYX&#39;: (0.02426737424983091+0j)}], [{&#39;ZIZIIIII&#39;: (0.06963750845631889+0j)}], [{&#39;ZIYZZZYI&#39;: (-0.010290902970907612+0j)}], [{&#39;ZIXZZZXI&#39;: (-0.010290902970907612+0j)}, {&#39;YZIZYIII&#39;: (0.022048950231499123+0j)}, {&#39;XZIZXIII&#39;: (0.022048950231499123+0j)}], [{&#39;YZXIXZYI&#39;: (-0.011388105812468973+0j)}, {&#39;YZYIYZYI&#39;: (-0.02441822802586467+0j)}, {&#39;YZYIXZXI&#39;: (-0.013030122213395706+0j)}, {&#39;XZXIYZYI&#39;: (-0.013030122213395706+0j)}, {&#39;XZXIXZXI&#39;: (-0.02441822802586467+0j)}, {&#39;XZYIYZXI&#39;: (-0.011388105812468973+0j)}], [{&#39;ZIIZIIII&#39;: (0.10898302201672638+0j)}, {&#39;YZZIYIII&#39;: (-0.0024512883013734607+0j)}], [{&#39;XZZIXIII&#39;: (-0.0024512883013734607+0j)}, {&#39;YZYYZYII&#39;: (0.024500238532872583+0j)}], [{&#39;YZYXZXII&#39;: (0.024500238532872583+0j)}, {&#39;XZXYZYII&#39;: (0.024500238532872583+0j)}, {&#39;XZXXZXII&#39;: (0.024500238532872583+0j)}, {&#39;YZZXIXYI&#39;: (0.01324013991721502+0j)}, {&#39;YZZYIYYI&#39;: (0.01324013991721502+0j)}, {&#39;XZZXIXXI&#39;: (0.01324013991721502+0j)}, {&#39;XZZYIYXI&#39;: (0.01324013991721502+0j)}, {&#39;ZIIYZZZY&#39;: (-0.021061897360589433+0j)}, {&#39;ZIIXZZZX&#39;: (-0.021061897360589433+0j)}], [{&#39;YZZXXZZY&#39;: (-0.024628245729683994+0j)}], [{&#39;YZZYXZZX&#39;: (0.024628245729683994+0j)}, {&#39;XZZXYZZY&#39;: (0.024628245729683994+0j)}, {&#39;XZZYYZZX&#39;: (-0.024628245729683994+0j)}, {&#39;ZIIIZIII&#39;: (0.08454049215503276+0j)}], [{&#39;ZIIIIZII&#39;: (0.11149852242605165+0j)}, {&#39;YZZZYZII&#39;: (0.001715657038636661+0j)}], [{&#39;XZZZXZII&#39;: (0.001715657038636661+0j)}, {&#39;YZYIIYZY&#39;: (-0.037658367943079696+0j)}], [{&#39;YZYIIXZX&#39;: (-0.037658367943079696+0j)}, {&#39;XZXIIYZY&#39;: (-0.037658367943079696+0j)}, {&#39;XZXIIXZX&#39;: (-0.037658367943079696+0j)}, {&#39;YZZZZXXY&#39;: (-0.010242352362581511+0j)}, {&#39;YZZZZYXX&#39;: (0.010242352362581511+0j)}, {&#39;XZZZZXYY&#39;: (0.010242352362581511+0j)}, {&#39;XZZZZYYX&#39;: (-0.010242352362581511+0j)}, {&#39;ZIIIIIZI&#39;: (0.10647068453545322+0j)}], [{&#39;YZZZYIZI&#39;: (0.011234473400252893+0j)}], [{&#39;XZZZXIZI&#39;: (0.011234473400252893+0j)}], [{&#39;ZIIIIIIZ&#39;: (0.13073805878528413+0j)}, {&#39;YZZZYIIZ&#39;: (0.021476825762834405+0j)}], [{&#39;XZZZXIIZ&#39;: (0.021476825762834405+0j)}, {&#39;IZZIIIII&#39;: (0.10898302201672638+0j)}, {&#39;IYIZZYII&#39;: (-0.0024512883013734607+0j)}], [{&#39;IXIZZXII&#39;: (-0.0024512883013734607+0j)}, {&#39;IYXXYIII&#39;: (0.024500238532872583+0j)}], [{&#39;IYYXXIII&#39;: (-0.024500238532872583+0j)}, {&#39;IXXYYIII&#39;: (-0.024500238532872583+0j)}, {&#39;IXYYXIII&#39;: (0.024500238532872583+0j)}, {&#39;IYXIXZZY&#39;: (0.01324013991721502+0j)}, {&#39;IYYIYZZY&#39;: (0.01324013991721502+0j)}, {&#39;IXXIXZZX&#39;: (0.01324013991721502+0j)}, {&#39;IXYIYZZX&#39;: (0.01324013991721502+0j)}, {&#39;IZYZZZYI&#39;: (-0.021061897360589433+0j)}, {&#39;IZXZZZXI&#39;: (-0.021061897360589433+0j)}], [{&#39;IYXIIXYI&#39;: (-0.024628245729683994+0j)}], [{&#39;IYYIIXXI&#39;: (0.024628245729683994+0j)}, {&#39;IXXIIYYI&#39;: (0.024628245729683994+0j)}, {&#39;IXYIIYXI&#39;: (-0.024628245729683994+0j)}], [{&#39;IZIZIIII&#39;: (0.06963750845631889+0j)}], [{&#39;IZIYZZZY&#39;: (-0.010290902970907612+0j)}], [{&#39;IZIXZZZX&#39;: (-0.010290902970907612+0j)}, {&#39;IYZIZYII&#39;: (0.022048950231499123+0j)}, {&#39;IXZIZXII&#39;: (0.022048950231499123+0j)}], [{&#39;IYZXIXZY&#39;: (-0.011388105812468973+0j)}, {&#39;IYZYIYZY&#39;: (-0.02441822802586467+0j)}, {&#39;IYZYIXZX&#39;: (-0.013030122213395706+0j)}, {&#39;IXZXIYZY&#39;: (-0.013030122213395706+0j)}, {&#39;IXZXIXZX&#39;: (-0.02441822802586467+0j)}, {&#39;IXZYIYZX&#39;: (-0.011388105812468973+0j)}], [{&#39;IZIIZIII&#39;: (0.11149852242605165+0j)}, {&#39;IYZZIYII&#39;: (0.001715657038636661+0j)}], [{&#39;IXZZIXII&#39;: (0.001715657038636661+0j)}, {&#39;IYZYYZYI&#39;: (-0.037658367943079696+0j)}], [{&#39;IYZYXZXI&#39;: (-0.037658367943079696+0j)}, {&#39;IXZXYZYI&#39;: (-0.037658367943079696+0j)}, {&#39;IXZXXZXI&#39;: (-0.037658367943079696+0j)}, {&#39;IYZZXIXY&#39;: (0.010242352362581511+0j)}, {&#39;IYZZYIYY&#39;: (0.010242352362581511+0j)}, {&#39;IXZZXIXX&#39;: (0.010242352362581511+0j)}, {&#39;IXZZYIYX&#39;: (0.010242352362581511+0j)}], [{&#39;IZIIIZII&#39;: (0.08454049215503276+0j)}, {&#39;IZIIIIZI&#39;: (0.13073805878528413+0j)}, {&#39;IYZZZYZI&#39;: (0.021476825762834405+0j)}], [{&#39;IXZZZXZI&#39;: (0.021476825762834405+0j)}], [{&#39;IZIIIIIZ&#39;: (0.10647068453545322+0j)}, {&#39;IYZZZYIZ&#39;: (0.011234473400252893+0j)}], [{&#39;IXZZZXIZ&#39;: (0.011234473400252893+0j)}, {&#39;IIZZIIII&#39;: (0.11340654161438057+0j)}, {&#39;IIYIZZYI&#39;: (-0.0010141239253515814+0j)}], [{&#39;IIXIZZXI&#39;: (-0.0010141239253515814+0j)}, {&#39;IIYXXYII&#39;: (0.03432067768053545+0j)}], [{&#39;IIYYXXII&#39;: (-0.03432067768053545+0j)}, {&#39;IIXXYYII&#39;: (-0.03432067768053545+0j)}, {&#39;IIXYYXII&#39;: (0.03432067768053545+0j)}, {&#39;IIZYZZZY&#39;: (-0.0010141239253515814+0j)}, {&#39;IIZXZZZX&#39;: (-0.0010141239253515814+0j)}], [{&#39;IIYXIIXY&#39;: (0.02616133175779298+0j)}], [{&#39;IIYYIIXX&#39;: (-0.02616133175779298+0j)}, {&#39;IIXXIIYY&#39;: (-0.02616133175779298+0j)}, {&#39;IIXYIIYX&#39;: (0.02616133175779298+0j)}], [{&#39;IIZIZIII&#39;: (0.07762037309982325+0j)}, {&#39;IIYZIZYI&#39;: (-0.025545241514434595+0j)}], [{&#39;IIXZIZXI&#39;: (-0.025545241514434595+0j)}], [{&#39;IIZIIZII&#39;: (0.11194105078035871+0j)}, {&#39;IIYZZIYI&#39;: (-0.0007036277600324646+0j)}], [{&#39;IIXZZIXI&#39;: (-0.0007036277600324646+0j)}, {&#39;IIYZYYZY&#39;: (-0.02484161375440213+0j)}], [{&#39;IIYZYXZX&#39;: (-0.02484161375440213+0j)}, {&#39;IIXZXYZY&#39;: (-0.02484161375440213+0j)}, {&#39;IIXZXXZX&#39;: (-0.02484161375440213+0j)}], [{&#39;IIZIIIZI&#39;: (0.08982499235931941+0j)}, {&#39;IIZIIIIZ&#39;: (0.1159863241171124+0j)}, {&#39;IIYZZZYZ&#39;: (-0.023384504139548214+0j)}], [{&#39;IIXZZZXZ&#39;: (-0.023384504139548214+0j)}, {&#39;IIIZZIII&#39;: (0.11194105078035871+0j)}], [{&#39;IIIYIZZY&#39;: (-0.0007036277600324646+0j)}], [{&#39;IIIXIZZX&#39;: (-0.0007036277600324646+0j)}, {&#39;IIIYXXYI&#39;: (-0.02484161375440213+0j)}], [{&#39;IIIYYXXI&#39;: (0.02484161375440213+0j)}, {&#39;IIIXXYYI&#39;: (0.02484161375440213+0j)}, {&#39;IIIXYYXI&#39;: (-0.02484161375440213+0j)}, {&#39;IIIZIZII&#39;: (0.07762037309982325+0j)}], [{&#39;IIIYZIZY&#39;: (-0.025545241514434595+0j)}], [{&#39;IIIXZIZX&#39;: (-0.025545241514434595+0j)}], [{&#39;IIIZIIZI&#39;: (0.1159863241171124+0j)}, {&#39;IIIYZZIY&#39;: (-0.023384504139548214+0j)}], [{&#39;IIIXZZIX&#39;: (-0.023384504139548214+0j)}, {&#39;IIIZIIIZ&#39;: (0.08982499235931941+0j)}, {&#39;IIIIZZII&#39;: (0.11685143854472024+0j)}], [{&#39;IIIIYXXY&#39;: (0.04061611948384259+0j)}, {&#39;IIIIYYXX&#39;: (-0.04061611948384259+0j)}, {&#39;IIIIXXYY&#39;: (-0.04061611948384259+0j)}, {&#39;IIIIXYYX&#39;: (0.04061611948384259+0j)}, {&#39;IIIIZIZI&#39;: (0.07943848632286903+0j)}, {&#39;IIIIZIIZ&#39;: (0.12005460580671162+0j)}, {&#39;IIIIIZZI&#39;: (0.12005460580671162+0j)}, {&#39;IIIIIZIZ&#39;: (0.07943848632286903+0j)}, {&#39;IIIIIIZZ&#39;: (0.14526147930807762+0j)}]]
{&#39;ZIIIYZYI&#39;, &#39;IIIZXZXI&#39;, &#39;IIIZIIII&#39;, &#39;ZIIIIIIZ&#39;, &#39;IIZIIIIZ&#39;, &#39;ZIIZIIII&#39;, &#39;IZIZIIII&#39;, &#39;IIIZIIIZ&#39;, &#39;IZIIIIZI&#39;, &#39;IIIIYYXX&#39;, &#39;IZIIXZXI&#39;, &#39;IZIIIZII&#39;, &#39;IIIIIIIZ&#39;, &#39;IIZIIZII&#39;, &#39;IIIZIIZI&#39;, &#39;IIIIZYZY&#39;, &#39;IIIIXIXI&#39;, &#39;IZIIIIIZ&#39;, &#39;IZIIIXZX&#39;, &#39;IIIIIIZZ&#39;, &#39;IIIIIIII&#39;, &#39;IIIZIYZY&#39;, &#39;IIIZIZII&#39;, &#39;ZIIIIIII&#39;, &#39;IIIIXYYX&#39;, &#39;IIIZIXZX&#39;, &#39;ZIIIIIZI&#39;, &#39;IIIIYZYZ&#39;, &#39;IIZIXZXI&#39;, &#39;IIIIIZZI&#39;, &#39;IIZIIXZX&#39;, &#39;IZIIIYZY&#39;, &#39;ZIIIXZXI&#39;, &#39;IIZIZIII&#39;, &#39;IIIIIXIX&#39;, &#39;IZIIZIII&#39;, &#39;ZIZIIIII&#39;, &#39;IIIIZIIZ&#39;, &#39;IIIIXZXZ&#39;, &#39;IIZIIIII&#39;, &#39;IIIIZZII&#39;, &#39;IIIIIYIY&#39;, &#39;ZIIIIZII&#39;, &#39;IZIIYZYI&#39;, &#39;IIIIZXZX&#39;, &#39;IIIZZIII&#39;, &#39;IZIIIIII&#39;, &#39;IIZZIIII&#39;, &#39;ZIIIIXZX&#39;, &#39;IZZIIIII&#39;, &#39;IIIIZIZI&#39;, &#39;IIIZYZYI&#39;, &#39;IIIIYIYI&#39;, &#39;IIZIIYZY&#39;, &#39;IIIIIIZI&#39;, &#39;IIIIYXXY&#39;, &#39;IIZIIIZI&#39;, &#39;ZIIIIYZY&#39;, &#39;IIIIXXYY&#39;, &#39;IIZIYZYI&#39;, &#39;IIIIIZIZ&#39;, &#39;IIIIIZII&#39;, &#39;ZIIIZIII&#39;, &#39;IIIIZIII&#39;, &#39;ZZIIIIII&#39;}
{&#39;YXXYIIII&#39;, &#39;IIZXZZZX&#39;, &#39;XZYIYZXI&#39;, &#39;IZIZIIII&#39;, &#39;IIXYYXII&#39;, &#39;IZIIIIZI&#39;, &#39;IIIZIIIZ&#39;, &#39;IIYZZIYI&#39;, &#39;IIZIIZII&#39;, &#39;YZZYXZZX&#39;, &#39;YZYYZYII&#39;, &#39;XZZZZXYY&#39;, &#39;IXYYXIII&#39;, &#39;IZIIIIIZ&#39;, &#39;IIIXIZZX&#39;, &#39;YZYIIXZX&#39;, &#39;IIIIXYYX&#39;, &#39;XZZIXIII&#39;, &#39;IXXYYIII&#39;, &#39;IIYIZZYI&#39;, &#39;YZYIIYZY&#39;, &#39;IYIZZYII&#39;, &#39;IYXXYIII&#39;, &#39;XZXYZYII&#39;, &#39;XZXIXZXI&#39;, &#39;IZIIIIII&#39;, &#39;ZXZZZXII&#39;, &#39;XZXIYZYI&#39;, &#39;IIIXYYXI&#39;, &#39;IIYXXYII&#39;, &#39;YZZZYZII&#39;, &#39;YXIXZZYI&#39;, &#39;IIXZZZXI&#39;, &#39;IYZYIXZX&#39;, &#39;IIIIXXYY&#39;, &#39;IXZZZXII&#39;, &#39;IIZIIIZI&#39;, &#39;YYIYZZYI&#39;, &#39;IIIIIZII&#39;, &#39;YZIZYIII&#39;, &#39;ZIIIZIII&#39;, &#39;XZIZXIII&#39;, &#39;IIIXZIZX&#39;, &#39;YXXZZZZY&#39;, &#39;IIIYZZIY&#39;, &#39;IZIXZZZX&#39;, &#39;IIXXYYII&#39;, &#39;ZIIXZZZX&#39;, &#39;IIYYXXII&#39;, &#39;IIIZIIII&#39;, &#39;YZZZZXXY&#39;, &#39;XYYZZZZX&#39;, &#39;YZZIYIII&#39;, &#39;YZYXZXII&#39;, &#39;IXZZXIXX&#39;, &#39;IIZIIIIZ&#39;, &#39;IYZZZYII&#39;, &#39;ZIYZZZYI&#39;, &#39;IIIIYYXX&#39;, &#39;IZIIIZII&#39;, &#39;IYZIZYII&#39;, &#39;IIIYZIZY&#39;, &#39;IIIIIIZZ&#39;, &#39;IXZZYIYX&#39;, &#39;XZZZXIZI&#39;, &#39;IXZZZXZI&#39;, &#39;ZIIYZZZY&#39;, &#39;YIZZYIII&#39;, &#39;IIIIIZZI&#39;, &#39;IYZZYIYY&#39;, &#39;IZXZZZXI&#39;, &#39;XZZXYZZY&#39;, &#39;IIIYZZZY&#39;, &#39;IXZIZXII&#39;, &#39;IIIIZIIZ&#39;, &#39;IIZIIIII&#39;, &#39;IIIIZZII&#39;, &#39;IYZXIXZY&#39;, &#39;ZIIIIZII&#39;, &#39;IXXIXZZX&#39;, &#39;IZIYZZZY&#39;, &#39;XZZZZYYX&#39;, &#39;IIIIIZIZ&#39;, &#39;IIIXZZZX&#39;, &#39;IIYZZZYI&#39;, &#39;XXIIIIYY&#39;, &#39;YZZZYIII&#39;, &#39;YZZZYIZI&#39;, &#39;IXYIIYXI&#39;, &#39;XYIYZZXI&#39;, &#39;IZYZZZYI&#39;, &#39;YYIIXXII&#39;, &#39;IXZYIYZX&#39;, &#39;IYZYXZXI&#39;, &#39;XZZXIXXI&#39;, &#39;IIXZXXZX&#39;, &#39;ZIIIIIIZ&#39;, &#39;XXYYIIII&#39;, &#39;YZZYIYYI&#39;, &#39;XZZZXZII&#39;, &#39;ZIIZIIII&#39;, &#39;XZZZXIII&#39;, &#39;ZZIIIIII&#39;, &#39;XZXXZXII&#39;, &#39;YZZZYIIZ&#39;, &#39;IYXIXZZY&#39;, &#39;IYZYYZYI&#39;, &#39;IIIIIIII&#39;, &#39;IYZZZYZI&#39;, &#39;IIIZIZII&#39;, &#39;XXYZZZZY&#39;, &#39;ZIIIIIZI&#39;, &#39;XYIIYXII&#39;, &#39;IYYIYZZY&#39;, &#39;IYZZIYII&#39;, &#39;XIZZXIII&#39;, &#39;IIXXIIYY&#39;, &#39;IZIIZIII&#39;, &#39;YXIIIIXY&#39;, &#39;ZIZIIIII&#39;, &#39;XZZYIYXI&#39;, &#39;IIZYZZZY&#39;, &#39;IIYZYYZY&#39;, &#39;IXZZIXII&#39;, &#39;IIYXIIXY&#39;, &#39;IIXZZIXI&#39;, &#39;YZYIYZYI&#39;, &#39;IIIZZIII&#39;, &#39;YZZXXZZY&#39;, &#39;IXZZZXIZ&#39;, &#39;IXZXXZXI&#39;, &#39;IIYZYXZX&#39;, &#39;IIIIZIZI&#39;, &#39;IYZZZYIZ&#39;, &#39;YXIIXYII&#39;, &#39;IIIIYXXY&#39;, &#39;IIYYIIXX&#39;, &#39;IXYIYZZX&#39;, &#39;IXZXIXZX&#39;, &#39;ZIXZZZXI&#39;, &#39;ZYZZZYII&#39;, &#39;IYZYIYZY&#39;, &#39;IIIYIZZY&#39;, &#39;XZZYYZZX&#39;, &#39;YYIIIIXX&#39;, &#39;IYYXXIII&#39;, &#39;IXZXIYZY&#39;, &#39;YZZXIXYI&#39;, &#39;IXIZZXII&#39;, &#39;IIIXXYYI&#39;, &#39;IYYIIXXI&#39;, &#39;YZZZZYXX&#39;, &#39;IXXIIYYI&#39;, &#39;XZXIIXZX&#39;, &#39;XZXIIYZY&#39;, &#39;IIIZIIZI&#39;, &#39;IIIIIIIZ&#39;, &#39;XXIIYYII&#39;, &#39;IIXIZZXI&#39;, &#39;IIIXZZIX&#39;, &#39;IIYZIZYI&#39;, &#39;ZIIIIIII&#39;, &#39;IIXZXYZY&#39;, &#39;IIXYIIYX&#39;, &#39;YYXXIIII&#39;, &#39;IIZIZIII&#39;, &#39;IYZZXIXY&#39;, &#39;XXIXZZXI&#39;, &#39;XYIIIIYX&#39;, &#39;IIXZZZXZ&#39;, &#39;XZZZXIIZ&#39;, &#39;YZXIXZYI&#39;, &#39;IIZZIIII&#39;, &#39;IZZIIIII&#39;, &#39;IIXZIZXI&#39;, &#39;IIIYYXXI&#39;, &#39;YYXZZZZX&#39;, &#39;YZYIXZXI&#39;, &#39;IIIIIIZI&#39;, &#39;IXZXYZYI&#39;, &#39;IIIYXXYI&#39;, &#39;IYXIIXYI&#39;, &#39;IIIIZIII&#39;, &#39;IIYZZZYZ&#39;, &#39;XYYXIIII&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pauli_commutator</span><span class="p">(</span><span class="n">pstr0</span><span class="p">,</span> <span class="n">pstr1</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">commutator</span><span class="p">(</span><span class="n">SparsePauliOp</span><span class="o">.</span><span class="n">from_list</span><span class="p">([(</span><span class="n">pstr0</span><span class="p">,</span><span class="mi">1</span><span class="p">)]),</span> <span class="n">SparsePauliOp</span><span class="o">.</span><span class="n">from_list</span><span class="p">([(</span><span class="n">pstr1</span><span class="p">,</span><span class="mi">1</span><span class="p">)]))</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span><span class="o">.</span><span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>

<span class="k">def</span> <span class="nf">four_norm</span><span class="p">(</span><span class="n">ob</span><span class="p">):</span>
    <span class="n">ob</span> <span class="o">=</span> <span class="n">ob</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">ob</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># print(&#39;d&#39;, d)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">ob</span> <span class="o">@</span> <span class="n">ob</span> <span class="o">@</span> <span class="n">ob</span> <span class="o">@</span> <span class="n">ob</span><span class="p">)</span><span class="o">/</span><span class="n">d</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>

<span class="n">d_list</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span>
<span class="c1"># d_list = np.linspace(0.1, 2, 20)</span>
<span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">d_list</span><span class="p">:</span>
    <span class="n">test_H</span> <span class="o">=</span> <span class="n">hydrogen_chain_hamiltonian</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">pstrs</span> <span class="o">=</span> <span class="n">test_H</span><span class="o">.</span><span class="n">pstrs</span>
    <span class="n">pstrs_coeff</span> <span class="o">=</span> <span class="n">test_H</span><span class="o">.</span><span class="n">pstrs_coeff</span>
    <span class="n">pstr_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">pstrs</span><span class="p">,</span> <span class="n">pstrs_coeff</span><span class="p">))</span>
    <span class="c1"># pstr_dict = dict(sorted(pstr_dict.items(), key=lambda x: np.abs(x[1]), reverse=True))</span>
    <span class="c1"># print(pstrs)</span>
    <span class="n">pstrs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">pstrs</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">pstr_dict</span><span class="p">[</span><span class="n">x</span><span class="p">]),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># print(pstrs)</span>

    <span class="c1"># groups = []</span>
    <span class="n">groups</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[{</span><span class="n">pstrs</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">pstr_dict</span><span class="p">[</span><span class="n">pstrs</span><span class="p">[</span><span class="mi">0</span><span class="p">]]}]</span> <span class="p">]</span>
    <span class="k">for</span> <span class="n">pstr</span> <span class="ow">in</span> <span class="n">pstrs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span> 
    <span class="c1"># for pstr in pstrs: </span>
        <span class="c1"># print(pstr)</span>
        <span class="c1"># print(SparsePauliOp.from_list([(pstr,1)]))</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">groups</span><span class="p">):</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="p">[</span><span class="n">pauli_commutator</span><span class="p">(</span><span class="n">pstr</span><span class="p">,</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">keys</span><span class="p">())))</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">group</span><span class="p">]</span>
            <span class="c1"># temp = [pauli_commutator(pstr, item) for item in group]</span>
            <span class="c1"># print(temp)</span>
            <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">groups</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="n">pstr</span><span class="p">:</span> <span class="n">pstr_dict</span><span class="p">[</span><span class="n">pstr</span><span class="p">]})</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">groups</span><span class="o">.</span><span class="n">append</span><span class="p">([{</span><span class="n">pstr</span><span class="p">:</span> <span class="n">pstr_dict</span><span class="p">[</span><span class="n">pstr</span><span class="p">]}])</span>  
            <span class="c1"># for item in group:</span>
                <span class="c1"># if not pauli_commutator(pstr, item):</span>
                <span class="c1">#     break</span>
    <span class="c1"># print(&#39;groups:&#39;, groups)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;# groups </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span><span class="si">}</span><span class="s1">, d=</span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">o_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
        <span class="n">o_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SparsePauliOp</span><span class="o">.</span><span class="n">from_list</span><span class="p">([(</span><span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">keys</span><span class="p">())),</span> <span class="n">item</span><span class="p">[</span><span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">keys</span><span class="p">()))])</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">group</span><span class="p">]))</span>

    <span class="n">norm_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">four_norm</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">o_list</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">norm_list</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">pstrs_coeff</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">four_norm</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">o_list</span><span class="p">)))</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">norm_list</span><span class="p">)</span><span class="o">/</span><span class="n">four_norm</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">o_list</span><span class="p">)))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">pstrs_coeff</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">norm_list</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># pstr: 62, [&#39;IIIIII&#39;, &#39;ZIIIII&#39;, &#39;YZZZYI&#39;, &#39;XZZZXI&#39;, &#39;IZIIII&#39;, &#39;IYZZZY&#39;, &#39;IXZZZX&#39;, &#39;IIZIII&#39;, &#39;IIIZII&#39;, &#39;IIIIZI&#39;, &#39;IIIIIZ&#39;, &#39;ZZIIII&#39;, &#39;YIZZYI&#39;, &#39;XIZZXI&#39;, &#39;YXXYII&#39;, &#39;YYXXII&#39;, &#39;XXYYII&#39;, &#39;XYYXII&#39;, &#39;ZYZZZY&#39;, &#39;ZXZZZX&#39;, &#39;YXIIXY&#39;, &#39;YYIIXX&#39;, &#39;XXIIYY&#39;, &#39;XYIIYX&#39;, &#39;ZIZIII&#39;, &#39;YZIZYI&#39;, &#39;XZIZXI&#39;, &#39;ZIIZII&#39;, &#39;YZZIYI&#39;, &#39;XZZIXI&#39;, &#39;YZYYZY&#39;, &#39;YZYXZX&#39;, &#39;XZXYZY&#39;, &#39;XZXXZX&#39;, &#39;ZIIIZI&#39;, &#39;ZIIIIZ&#39;, &#39;YZZZYZ&#39;, &#39;XZZZXZ&#39;, &#39;IZZIII&#39;, &#39;IYIZZY&#39;, &#39;IXIZZX&#39;, &#39;IYXXYI&#39;, &#39;IYYXXI&#39;, &#39;IXXYYI&#39;, &#39;IXYYXI&#39;, &#39;IZIZII&#39;, &#39;IYZIZY&#39;, &#39;IXZIZX&#39;, &#39;IZIIZI&#39;, &#39;IYZZIY&#39;, &#39;IXZZIX&#39;, &#39;IZIIIZ&#39;, &#39;IIZZII&#39;, &#39;IIYXXY&#39;, &#39;IIYYXX&#39;, &#39;IIXXYY&#39;, &#39;IIXYYX&#39;, &#39;IIZIZI&#39;, &#39;IIZIIZ&#39;, &#39;IIIZZI&#39;, &#39;IIIZIZ&#39;, &#39;IIIIZZ&#39;]
# groups: 22
[[{&#39;IIIIII&#39;: (-0.33362884012829697+0j)}, {&#39;ZIIIII&#39;: (0.16891173410254534+0j)}, {&#39;YZZZYI&#39;: (0.0004614778443555352+0j)}], [{&#39;XZZZXI&#39;: (0.0004614778443555352+0j)}, {&#39;IZIIII&#39;: (0.16891173410254526+0j)}, {&#39;IYZZZY&#39;: (0.00046147784435555516+0j)}], [{&#39;IXZZZX&#39;: (0.00046147784435555516+0j)}, {&#39;IIZIII&#39;: (0.020862150051427164+0j)}, {&#39;IIIZII&#39;: (0.02086215005142716+0j)}, {&#39;IIIIZI&#39;: (-0.2535728967411679+0j)}, {&#39;IIIIIZ&#39;: (-0.2535728967411678+0j)}, {&#39;ZZIIII&#39;: (0.13984206636700175+0j)}, {&#39;YIZZYI&#39;: (-0.022007608492169456+0j)}], [{&#39;XIZZXI&#39;: (-0.022007608492169456+0j)}, {&#39;YXXYII&#39;: (0.038692886305328696+0j)}], [{&#39;YYXXII&#39;: (-0.038692886305328696+0j)}, {&#39;XXYYII&#39;: (-0.038692886305328696+0j)}, {&#39;XYYXII&#39;: (0.038692886305328696+0j)}, {&#39;ZYZZZY&#39;: (-0.022007608492169456+0j)}, {&#39;ZXZZZX&#39;: (-0.022007608492169456+0j)}], [{&#39;YXIIXY&#39;: (0.03390830240101133+0j)}], [{&#39;YYIIXX&#39;: (-0.03390830240101133+0j)}, {&#39;XXIIYY&#39;: (-0.03390830240101133+0j)}, {&#39;XYIIYX&#39;: (0.03390830240101133+0j)}], [{&#39;ZIZIII&#39;: (0.08295876958230786+0j)}, {&#39;YZIZYI&#39;: (-0.02573161133632447+0j)}], [{&#39;XZIZXI&#39;: (-0.02573161133632447+0j)}], [{&#39;ZIIZII&#39;: (0.12165165588763656+0j)}, {&#39;YZZIYI&#39;: (0.009479775148539305+0j)}], [{&#39;XZZIXI&#39;: (0.009479775148539305+0j)}, {&#39;YZYYZY&#39;: (-0.03521138648486378+0j)}], [{&#39;YZYXZX&#39;: (-0.03521138648486378+0j)}, {&#39;XZXYZY&#39;: (-0.03521138648486378+0j)}, {&#39;XZXXZX&#39;: (-0.03521138648486378+0j)}], [{&#39;ZIIIZI&#39;: (0.11003101552075459+0j)}, {&#39;ZIIIIZ&#39;: (0.14393931792176595+0j)}, {&#39;YZZZYZ&#39;: (-0.02246908589022142+0j)}], [{&#39;XZZZXZ&#39;: (-0.02246908589022142+0j)}, {&#39;IZZIII&#39;: (0.12165165588763656+0j)}], [{&#39;IYIZZY&#39;: (0.009479775148539305+0j)}], [{&#39;IXIZZX&#39;: (0.009479775148539305+0j)}, {&#39;IYXXYI&#39;: (-0.03521138648486378+0j)}], [{&#39;IYYXXI&#39;: (0.03521138648486378+0j)}, {&#39;IXXYYI&#39;: (0.03521138648486378+0j)}, {&#39;IXYYXI&#39;: (-0.03521138648486378+0j)}, {&#39;IZIZII&#39;: (0.08295876958230786+0j)}], [{&#39;IYZIZY&#39;: (-0.02573161133632447+0j)}], [{&#39;IXZIZX&#39;: (-0.02573161133632447+0j)}], [{&#39;IZIIZI&#39;: (0.14393931792176595+0j)}, {&#39;IYZZIY&#39;: (-0.022469085890221424+0j)}], [{&#39;IXZZIX&#39;: (-0.022469085890221424+0j)}, {&#39;IZIIIZ&#39;: (0.11003101552075459+0j)}, {&#39;IIZZII&#39;: (0.13366602988233992+0j)}], [{&#39;IIYXXY&#39;: (0.03759887695074104+0j)}, {&#39;IIYYXX&#39;: (-0.03759887695074104+0j)}, {&#39;IIXXYY&#39;: (-0.03759887695074104+0j)}, {&#39;IIXYYX&#39;: (0.03759887695074104+0j)}, {&#39;IIZIZI&#39;: (0.09048399816423514+0j)}, {&#39;IIZIIZ&#39;: (0.12808287511497618+0j)}, {&#39;IIIZZI&#39;: (0.12808287511497618+0j)}, {&#39;IIIZIZ&#39;: (0.09048399816423514+0j)}, {&#39;IIIIZZ&#39;: (0.15636653196999328+0j)}]]
# groups 7, d=1.0
(2.4531146521040093+0j)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">o_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
    <span class="n">o_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SparsePauliOp</span><span class="o">.</span><span class="n">from_list</span><span class="p">([(</span><span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">keys</span><span class="p">())),</span> <span class="n">item</span><span class="p">[</span><span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">keys</span><span class="p">()))])</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">group</span><span class="p">]))</span>

<span class="n">norm_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">four_norm</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">o_list</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">norm_list</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">pstrs_coeff</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">four_norm</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">o_list</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">norm_list</span><span class="p">)</span><span class="o">/</span><span class="n">four_norm</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">o_list</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">pstrs_coeff</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">norm_list</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1.6499766451614373+0j)
4.04758188387494
(0.9355989262054287+0j)
(1.763551238620333+0j)
(2.4531146521040093+0j)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_H</span><span class="o">.</span><span class="n">jw</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-0.3276081896748102+0j) [] +
(-0.049197645871367546+0j) [X0 X1 Y2 Y3] +
(0.049197645871367546+0j) [X0 Y1 Y2 X3] +
(0.049197645871367546+0j) [Y0 X1 X2 Y3] +
(-0.049197645871367546+0j) [Y0 Y1 X2 X3] +
(0.13716572937099497+0j) [Z0] +
(0.15660062488237947+0j) [Z0 Z1] +
(0.10622904490856078+0j) [Z0 Z2] +
(0.15542669077992832+0j) [Z0 Z3] +
(0.13716572937099497+0j) [Z1] +
(0.15542669077992832+0j) [Z1 Z2] +
(0.10622904490856078+0j) [Z1 Z3] +
(-0.13036292057109025+0j) [Z2] +
(0.16326768673564335+0j) [Z2 Z3] +
(-0.13036292057109025+0j) [Z3]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_H</span><span class="o">.</span><span class="n">pstr_group</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[{&#39;IIII&#39;: (-0.3276081896748102+0j)},
  {&#39;ZIII&#39;: (0.13716572937099497+0j)},
  {&#39;IZII&#39;: (0.13716572937099497+0j)},
  {&#39;IIZI&#39;: (-0.13036292057109025+0j)},
  {&#39;IIIZ&#39;: (-0.13036292057109025+0j)},
  {&#39;ZZII&#39;: (0.15660062488237947+0j)}],
 [{&#39;YXXY&#39;: (0.049197645871367546+0j)},
  {&#39;YYXX&#39;: (-0.049197645871367546+0j)},
  {&#39;XXYY&#39;: (-0.049197645871367546+0j)},
  {&#39;XYYX&#39;: (0.049197645871367546+0j)},
  {&#39;ZIZI&#39;: (0.10622904490856078+0j)},
  {&#39;ZIIZ&#39;: (0.15542669077992832+0j)},
  {&#39;IZZI&#39;: (0.15542669077992832+0j)},
  {&#39;IZIZ&#39;: (0.10622904490856078+0j)},
  {&#39;IIZZ&#39;: (0.16326768673564335+0j)}]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dense_ev.test_estimator</span> <span class="kn">import</span> <span class="n">test_random</span>

<span class="n">m</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># n_qubits</span>
<span class="c1"># run_unit_tests(m)</span>
<span class="n">test_random</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>result_exact = array([0.35297647])
result_dense = array([0.3525569])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dense_ev</span> <span class="kn">import</span> <span class="n">DensePauliExpectation</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ImportError</span><span class="g g-Whitespace">                               </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">from</span> <span class="nn">dense_ev</span> <span class="kn">import</span> <span class="n">DensePauliExpectation</span>

<span class="ne">ImportError</span>: cannot import name &#39;DensePauliExpectation&#39; from &#39;dense_ev&#39; (/opt/homebrew/Caskroom/miniforge/base/lib/python3.10/site-packages/dense_ev/__init__.py)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dense_ev.estimator_from_aer</span> <span class="kn">import</span> <span class="n">Estimator</span>

<span class="c1"># Dense result.</span>
<span class="n">nshots</span> <span class="o">=</span> <span class="mi">200000</span>
<span class="n">approx</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">grouping</span> <span class="o">=</span> <span class="s2">&quot;DENSE&quot;</span>
<span class="n">run_options</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;shots&quot;</span><span class="p">:</span> <span class="n">nshots</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="n">seed</span><span class="p">}</span>
<span class="n">estimator</span> <span class="o">=</span> <span class="n">Estimator</span><span class="p">(</span>
    <span class="n">run_options</span><span class="o">=</span><span class="n">run_options</span><span class="p">,</span> <span class="n">abelian_grouping</span><span class="o">=</span><span class="n">grouping</span><span class="p">,</span> <span class="n">approximation</span><span class="o">=</span><span class="n">approx</span><span class="p">)</span>
<span class="n">result_dense</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">nshots</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>OMP: Info #276: omp_set_nested routine deprecated, please use omp_set_max_active_levels instead.
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">line</span> <span class="mi">7</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">approx</span> <span class="o">=</span> <span class="kc">False</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="n">grouping</span> <span class="o">=</span> <span class="s2">&quot;DENSE&quot;</span>
<span class="ne">----&gt; </span><span class="mi">7</span> <span class="n">run_options</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;shots&quot;</span><span class="p">:</span> <span class="n">nshots</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="n">seed</span><span class="p">}</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="n">estimator</span> <span class="o">=</span> <span class="n">Estimator</span><span class="p">(</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span>     <span class="n">run_options</span><span class="o">=</span><span class="n">run_options</span><span class="p">,</span> <span class="n">abelian_grouping</span><span class="o">=</span><span class="n">grouping</span><span class="p">,</span> <span class="n">approximation</span><span class="o">=</span><span class="n">approx</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="n">result_dense</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">nshots</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>

<span class="ne">NameError</span>: name &#39;seed&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_H</span><span class="o">.</span><span class="n">qubit_terms</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;16x16 sparse matrix of type &#39;&lt;class &#39;numpy.complex128&#39;&gt;&#39;
 	with 16 stored elements in Compressed Sparse Column format&gt;,
 &lt;16x16 sparse matrix of type &#39;&lt;class &#39;numpy.complex128&#39;&gt;&#39;
 	with 16 stored elements in Compressed Sparse Column format&gt;,
 &lt;16x16 sparse matrix of type &#39;&lt;class &#39;numpy.complex128&#39;&gt;&#39;
 	with 16 stored elements in Compressed Sparse Column format&gt;,
 &lt;16x16 sparse matrix of type &#39;&lt;class &#39;numpy.complex128&#39;&gt;&#39;
 	with 16 stored elements in Compressed Sparse Column format&gt;,
 &lt;16x16 sparse matrix of type &#39;&lt;class &#39;numpy.complex128&#39;&gt;&#39;
 	with 16 stored elements in Compressed Sparse Column format&gt;,
 &lt;16x16 sparse matrix of type &#39;&lt;class &#39;numpy.complex128&#39;&gt;&#39;
 	with 16 stored elements in Compressed Sparse Column format&gt;,
 &lt;16x16 sparse matrix of type &#39;&lt;class &#39;numpy.complex128&#39;&gt;&#39;
 	with 16 stored elements in Compressed Sparse Column format&gt;,
 &lt;16x16 sparse matrix of type &#39;&lt;class &#39;numpy.complex128&#39;&gt;&#39;
 	with 16 stored elements in Compressed Sparse Column format&gt;,
 &lt;16x16 sparse matrix of type &#39;&lt;class &#39;numpy.complex128&#39;&gt;&#39;
 	with 16 stored elements in Compressed Sparse Column format&gt;,
 &lt;16x16 sparse matrix of type &#39;&lt;class &#39;numpy.complex128&#39;&gt;&#39;
 	with 16 stored elements in Compressed Sparse Column format&gt;,
 &lt;16x16 sparse matrix of type &#39;&lt;class &#39;numpy.complex128&#39;&gt;&#39;
 	with 16 stored elements in Compressed Sparse Column format&gt;,
 &lt;16x16 sparse matrix of type &#39;&lt;class &#39;numpy.complex128&#39;&gt;&#39;
 	with 16 stored elements in Compressed Sparse Column format&gt;,
 &lt;16x16 sparse matrix of type &#39;&lt;class &#39;numpy.complex128&#39;&gt;&#39;
 	with 16 stored elements in Compressed Sparse Column format&gt;,
 &lt;16x16 sparse matrix of type &#39;&lt;class &#39;numpy.complex128&#39;&gt;&#39;
 	with 16 stored elements in Compressed Sparse Column format&gt;,
 &lt;16x16 sparse matrix of type &#39;&lt;class &#39;numpy.complex128&#39;&gt;&#39;
 	with 16 stored elements in Compressed Sparse Column format&gt;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">k</span><span class="o">=</span> <span class="mi">3</span>
<span class="p">[(</span><span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">([</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">),</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)),</span> <span class="n">k</span><span class="p">),</span> <span class="mi">1</span><span class="p">)]</span>
<span class="c1"># &quot;&quot;.join(random.choices([&#39;I&#39;,&#39;X&#39;,&#39;Y&#39;,&#39;Z&#39;], k=n))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[([&#39;X&#39;, &#39;Y&#39;, &#39;Y&#39;], [0, 3, 5], 1)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">fermion_ham</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">openfermion</span> <span class="kn">import</span> <span class="n">MolecularData</span>
<span class="kn">from</span> <span class="nn">openfermion.transforms</span> <span class="kn">import</span> <span class="n">get_fermion_operator</span><span class="p">,</span> <span class="n">jordan_wigner</span>
<span class="kn">from</span> <span class="nn">openfermion.linalg</span> <span class="kn">import</span> <span class="n">get_ground_state</span><span class="p">,</span> <span class="n">get_sparse_operator</span>
<span class="kn">from</span> <span class="nn">qiskit.quantum_info</span> <span class="kn">import</span> <span class="n">random_statevector</span><span class="p">,</span> <span class="n">Statevector</span><span class="p">,</span> <span class="n">random_unitary</span>

<span class="kn">import</span> <span class="nn">jax</span><span class="o">,</span> <span class="nn">scipy</span>

<span class="n">prefix</span><span class="p">,</span> <span class="n">suffix</span> <span class="o">=</span> <span class="s1">&#39;Chem&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span>
<span class="c1"># dir = &#39;../figs&#39;</span>

<span class="n">rand_type</span> <span class="o">=</span> <span class="s1">&#39;haar&#39;</span> <span class="c1"># &#39;1&#39;</span>
<span class="n">d</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">n_hydrogen</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">n_hydrogen</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">h2_init</span> <span class="o">=</span> <span class="n">hydrogen_chain_hamiltonian</span><span class="p">(</span><span class="n">n_hydrogen</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">h2_finl</span> <span class="o">=</span> <span class="n">hydrogen_chain_hamiltonian</span><span class="p">(</span><span class="n">n_hydrogen</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">d</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># print(get_ground_state(get_sparse_operator(h2_init.fermion_hamiltonian)))</span>
<span class="c1"># print(get_ground_state(get_sparse_operator(h2_finl.fermion_hamiltonian)))</span>

<span class="c1"># print(h2_init.jw)</span>
<span class="n">ground_state_energy</span><span class="p">,</span> <span class="n">ground_state</span> <span class="o">=</span>  <span class="n">get_ground_state</span><span class="p">(</span><span class="n">get_sparse_operator</span><span class="p">(</span><span class="n">h2_init</span><span class="o">.</span><span class="n">fermion_hamiltonian</span><span class="p">))</span>
<span class="c1"># print(&#39;ground energy: &#39;, ground_state_energy, ground_state)</span>
<span class="c1"># vec0 = np.array([0 for _ in range(len(ground_state))])</span>
<span class="c1"># vec0[-1] = 1</span>
<span class="c1"># ground_state = vec0/np.sqrt(2)  + ground_state / np.sqrt(2) </span>
<span class="c1"># ground_state = Statevector.from_label(&#39;+&#39;*n).data/np.sqrt(2)  + Statevector.from_label(&#39;1100&#39;).data / np.sqrt(2) </span>
<span class="c1"># ground_state = Statevector.from_label(&#39;+&#39;*n).data</span>
<span class="n">ground_state</span> <span class="o">=</span> <span class="n">Statevector</span><span class="o">.</span><span class="n">from_label</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">data</span>
<span class="c1"># ground_state = random_statevector(2**(2*n_hydrogen)).data</span>
<span class="n">init_st</span> <span class="o">=</span> <span class="n">ground_state</span><span class="o">.</span><span class="n">T</span>
<span class="c1"># print(&#39;init state: &#39;, init_st)  </span>
<span class="n">r</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_sample</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">t_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="c1"># dt = 0.1</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">10</span>

<span class="n">chem_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;worst_err&#39;</span><span class="p">,</span> <span class="s1">&#39;averg_err&#39;</span><span class="p">,</span> <span class="s1">&#39;averg_err_std&#39;</span><span class="p">,</span> <span class="s1">&#39;typic_err&#39;</span><span class="p">,</span> <span class="s1">&#39;typic_err_trace&#39;</span><span class="p">,</span> <span class="s1">&#39;worst_ob_err&#39;</span><span class="p">,</span> <span class="s1">&#39;averg_ob_err&#39;</span><span class="p">,</span> <span class="s1">&#39;averg_ob_err_std&#39;</span><span class="p">,</span> <span class="s1">&#39;typic_ob_err&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">]</span>
<span class="n">chem_data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">k</span><span class="p">,</span> <span class="p">[])</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">chem_keys</span><span class="p">])</span>
<span class="n">chem_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t_list</span>

<span class="c1"># h_ob =  SparsePauliOp.from_sparse_list([(&#39;XX&#39;, [i, i+1], 1/(n-1)) for i in range(0, n-1)], num_qubits=n).to_matrix()</span>
<span class="c1"># h_ob =  SparsePauliOp.from_sparse_list([(&#39;Y&#39;, [i], 1/n) for i in range(0, n)], num_qubits=n).to_matrix()</span>
<span class="n">rand_ob_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">([</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="n">n</span><span class="p">))</span>
<span class="c1"># rand_ob_str = &#39;IIXI&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;rand_ob_str: &quot;</span><span class="p">,</span> <span class="n">rand_ob_str</span><span class="p">)</span>
<span class="n">h_ob</span> <span class="o">=</span> <span class="n">SparsePauliOp</span><span class="p">(</span><span class="n">rand_ob_str</span><span class="p">)</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span>
<span class="n">rand_pstr_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">([</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="n">n</span><span class="p">))</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;rand_pstr_list: &#39;</span><span class="p">,</span> <span class="n">rand_pstr_list</span><span class="p">)</span>
<span class="c1"># h_ob = (SparsePauliOp(rand_pstr_list[0]) + SparsePauliOp(rand_pstr_list[1])).to_matrix()</span>
<span class="n">h_ob</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">h</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">h2_init</span><span class="o">.</span><span class="n">hamiltonian_list</span><span class="p">])</span>
<span class="c1"># h_ob = sum([SparsePauliOp.from_sparse_list([(random.choices([&#39;I&#39;,&#39;X&#39;,&#39;Y&#39;,&#39;Z&#39;], k=n), random.sample(list(range(0, n)), n), 1)], n) for _ in range(5)]).to_matrix()</span>
<span class="c1"># h_ob = h_ob / np.linalg.norm(h_ob, ord=2)</span>
<span class="n">h_ob_1norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">h2_init</span><span class="o">.</span><span class="n">pstrs_coeff</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">t_list</span><span class="p">:</span>
    <span class="c1"># print(f&#39;------t: {t}-----&#39;)  </span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">t</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
    <span class="c1"># print(&quot;H norm: &quot;, np.linalg.norm(sum([h for h in h2_init.hamiltonian_list]), ord=2) )</span>
    <span class="n">exact_U</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">([</span><span class="n">h</span>  <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">h2_finl</span><span class="o">.</span><span class="n">hamiltonian_list</span><span class="p">]))</span>
    <span class="c1"># h_list = h2_finl.qubit_terms</span>
    <span class="n">h_list</span> <span class="o">=</span> <span class="n">h2_finl</span><span class="o">.</span><span class="n">hamiltonian_list</span>
    <span class="n">appro_U</span> <span class="o">=</span> <span class="n">pf_r</span><span class="p">(</span><span class="n">h_list</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">use_jax</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># exact_U = jax.scipy.linalg.expm(-1j * t * sum([h  for h in h2_finl.hamiltonian_list]))</span>
    <span class="c1"># h_list = h2_finl.hamiltonian_list</span>
    <span class="c1"># appro_U = pf_r(h_list, t, r, order=2, use_jax=True)</span>
    <span class="k">if</span> <span class="n">rand_type</span> <span class="o">==</span> <span class="s1">&#39;haar&#39;</span><span class="p">:</span>
        <span class="n">rand_states</span> <span class="o">=</span> <span class="p">[</span><span class="n">random_statevector</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">exact_U</span><span class="p">))</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_sample</span><span class="p">)]</span>
    <span class="k">elif</span> <span class="n">rand_type</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
        <span class="n">rand_states</span> <span class="o">=</span> <span class="p">[</span><span class="n">Statevector</span><span class="p">(</span><span class="n">tensor_random_unitaries</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">@</span> <span class="n">Statevector</span><span class="o">.</span><span class="n">from_label</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_sample</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;rand_type should be either haar or 1&#39;</span><span class="p">)</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">exact_U</span> <span class="o">-</span> <span class="n">appro_U</span>
    <span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
    <span class="c1"># init_st = V[0].T</span>

    <span class="n">chem_data</span><span class="p">[</span><span class="s1">&#39;worst_err&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">exact_U</span> <span class="o">-</span> <span class="n">appro_U</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">averg_st_err</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">h_ob</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">exact_U</span> <span class="o">@</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="p">,</span> <span class="p">(</span><span class="n">exact_U</span> <span class="o">@</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">appro_U</span> <span class="o">@</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="p">(</span><span class="n">appro_U</span> <span class="o">@</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">),</span> <span class="nb">ord</span><span class="o">=</span><span class="s1">&#39;nuc&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">rand_states</span><span class="p">]</span> 
    <span class="c1"># averg_st_err = [np.linalg.norm(exact_U @ state.data.conj().T - appro_U @ state.data.conj().T) for state in rand_states]</span>
    <span class="c1"># print(averg_ob_err)</span>
    <span class="n">chem_data</span><span class="p">[</span><span class="s1">&#39;averg_err&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">averg_st_err</span><span class="p">))</span>
    <span class="n">chem_data</span><span class="p">[</span><span class="s1">&#39;averg_err_std&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">averg_st_err</span><span class="p">))</span>
    <span class="n">exact_st</span> <span class="o">=</span> <span class="n">exact_U</span> <span class="o">@</span> <span class="n">init_st</span>
    <span class="n">appro_st</span> <span class="o">=</span> <span class="n">appro_U</span> <span class="o">@</span> <span class="n">init_st</span>
    <span class="c1"># chem_data[&#39;typic_err&#39;].append(np.linalg.norm(np.outer(exact_st, exact_st.conj().T) - np.outer(appro_st, appro_st.conj().T), ord=&#39;nuc&#39;))</span>
    <span class="n">chem_data</span><span class="p">[</span><span class="s1">&#39;typic_err_trace&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">exact_st</span><span class="p">,</span> <span class="n">exact_st</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">appro_st</span><span class="p">,</span> <span class="n">appro_st</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">),</span> <span class="nb">ord</span><span class="o">=</span><span class="s1">&#39;nuc&#39;</span><span class="p">))</span>
    <span class="n">chem_data</span><span class="p">[</span><span class="s1">&#39;typic_err&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">exact_U</span> <span class="o">@</span> <span class="n">init_st</span> <span class="o">-</span> <span class="n">appro_U</span> <span class="o">@</span> <span class="n">init_st</span><span class="p">))</span>
    <span class="c1"># print(ground_state.conj().T @ exact_U.conj().T @ h_ob @ exact_U @ ground_state)</span>

    <span class="n">chem_data</span><span class="p">[</span><span class="s1">&#39;worst_ob_err&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">exact_U</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">h_ob</span> <span class="o">@</span> <span class="n">exact_U</span> <span class="o">-</span> <span class="n">appro_U</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">h_ob</span> <span class="o">@</span> <span class="n">appro_U</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">averg_ob_err</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">exact_U</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">h_ob</span> <span class="o">@</span> <span class="n">exact_U</span> <span class="o">@</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span> <span class="o">-</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">appro_U</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">h_ob</span> <span class="o">@</span> <span class="n">appro_U</span> <span class="o">@</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">rand_states</span><span class="p">]</span>
    <span class="n">chem_data</span><span class="p">[</span><span class="s1">&#39;averg_ob_err&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">averg_ob_err</span><span class="p">))</span>
    <span class="n">chem_data</span><span class="p">[</span><span class="s1">&#39;averg_ob_err_std&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">averg_ob_err</span><span class="p">))</span>
    <span class="n">chem_data</span><span class="p">[</span><span class="s1">&#39;typic_ob_err&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">init_st</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">exact_U</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">h_ob</span> <span class="o">@</span> <span class="n">exact_U</span> <span class="o">@</span> <span class="n">init_st</span> <span class="o">-</span> <span class="n">init_st</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">appro_U</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">h_ob</span> <span class="o">@</span> <span class="n">appro_U</span> <span class="o">@</span> <span class="n">init_st</span><span class="p">))</span>
    <span class="c1"># print(&quot;energy: &quot;, init_st.conj().T @ exact_U.conj().T @ h_ob @ exact_U @ init_st, init_st.conj().T @ appro_U.conj().T @ h_ob @ appro_U @ init_st)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># pstr: 62, [&#39;IIIIII&#39;, &#39;ZIIIII&#39;, &#39;YZZZYI&#39;, &#39;XZZZXI&#39;, &#39;IZIIII&#39;, &#39;IYZZZY&#39;, &#39;IXZZZX&#39;, &#39;IIZIII&#39;, &#39;IIIZII&#39;, &#39;IIIIZI&#39;, &#39;IIIIIZ&#39;, &#39;ZZIIII&#39;, &#39;YIZZYI&#39;, &#39;XIZZXI&#39;, &#39;YXXYII&#39;, &#39;YYXXII&#39;, &#39;XXYYII&#39;, &#39;XYYXII&#39;, &#39;ZYZZZY&#39;, &#39;ZXZZZX&#39;, &#39;YXIIXY&#39;, &#39;YYIIXX&#39;, &#39;XXIIYY&#39;, &#39;XYIIYX&#39;, &#39;ZIZIII&#39;, &#39;YZIZYI&#39;, &#39;XZIZXI&#39;, &#39;ZIIZII&#39;, &#39;YZZIYI&#39;, &#39;XZZIXI&#39;, &#39;YZYYZY&#39;, &#39;YZYXZX&#39;, &#39;XZXYZY&#39;, &#39;XZXXZX&#39;, &#39;ZIIIZI&#39;, &#39;ZIIIIZ&#39;, &#39;YZZZYZ&#39;, &#39;XZZZXZ&#39;, &#39;IZZIII&#39;, &#39;IYIZZY&#39;, &#39;IXIZZX&#39;, &#39;IYXXYI&#39;, &#39;IYYXXI&#39;, &#39;IXXYYI&#39;, &#39;IXYYXI&#39;, &#39;IZIZII&#39;, &#39;IYZIZY&#39;, &#39;IXZIZX&#39;, &#39;IZIIZI&#39;, &#39;IYZZIY&#39;, &#39;IXZZIX&#39;, &#39;IZIIIZ&#39;, &#39;IIZZII&#39;, &#39;IIYXXY&#39;, &#39;IIYYXX&#39;, &#39;IIXXYY&#39;, &#39;IIXYYX&#39;, &#39;IIZIZI&#39;, &#39;IIZIIZ&#39;, &#39;IIIZZI&#39;, &#39;IIIZIZ&#39;, &#39;IIIIZZ&#39;]
# groups: 22
[[{&#39;IIIIII&#39;: (-0.33362884012829697+0j)}, {&#39;ZIIIII&#39;: (0.16891173410254534+0j)}, {&#39;YZZZYI&#39;: (0.0004614778443555352+0j)}], [{&#39;XZZZXI&#39;: (0.0004614778443555352+0j)}, {&#39;IZIIII&#39;: (0.16891173410254526+0j)}, {&#39;IYZZZY&#39;: (0.00046147784435555516+0j)}], [{&#39;IXZZZX&#39;: (0.00046147784435555516+0j)}, {&#39;IIZIII&#39;: (0.020862150051427164+0j)}, {&#39;IIIZII&#39;: (0.02086215005142716+0j)}, {&#39;IIIIZI&#39;: (-0.2535728967411679+0j)}, {&#39;IIIIIZ&#39;: (-0.2535728967411678+0j)}, {&#39;ZZIIII&#39;: (0.13984206636700175+0j)}, {&#39;YIZZYI&#39;: (-0.022007608492169456+0j)}], [{&#39;XIZZXI&#39;: (-0.022007608492169456+0j)}, {&#39;YXXYII&#39;: (0.038692886305328696+0j)}], [{&#39;YYXXII&#39;: (-0.038692886305328696+0j)}, {&#39;XXYYII&#39;: (-0.038692886305328696+0j)}, {&#39;XYYXII&#39;: (0.038692886305328696+0j)}, {&#39;ZYZZZY&#39;: (-0.022007608492169456+0j)}, {&#39;ZXZZZX&#39;: (-0.022007608492169456+0j)}], [{&#39;YXIIXY&#39;: (0.03390830240101133+0j)}], [{&#39;YYIIXX&#39;: (-0.03390830240101133+0j)}, {&#39;XXIIYY&#39;: (-0.03390830240101133+0j)}, {&#39;XYIIYX&#39;: (0.03390830240101133+0j)}], [{&#39;ZIZIII&#39;: (0.08295876958230786+0j)}, {&#39;YZIZYI&#39;: (-0.02573161133632447+0j)}], [{&#39;XZIZXI&#39;: (-0.02573161133632447+0j)}], [{&#39;ZIIZII&#39;: (0.12165165588763656+0j)}, {&#39;YZZIYI&#39;: (0.009479775148539305+0j)}], [{&#39;XZZIXI&#39;: (0.009479775148539305+0j)}, {&#39;YZYYZY&#39;: (-0.03521138648486378+0j)}], [{&#39;YZYXZX&#39;: (-0.03521138648486378+0j)}, {&#39;XZXYZY&#39;: (-0.03521138648486378+0j)}, {&#39;XZXXZX&#39;: (-0.03521138648486378+0j)}], [{&#39;ZIIIZI&#39;: (0.11003101552075459+0j)}, {&#39;ZIIIIZ&#39;: (0.14393931792176595+0j)}, {&#39;YZZZYZ&#39;: (-0.02246908589022142+0j)}], [{&#39;XZZZXZ&#39;: (-0.02246908589022142+0j)}, {&#39;IZZIII&#39;: (0.12165165588763656+0j)}], [{&#39;IYIZZY&#39;: (0.009479775148539305+0j)}], [{&#39;IXIZZX&#39;: (0.009479775148539305+0j)}, {&#39;IYXXYI&#39;: (-0.03521138648486378+0j)}], [{&#39;IYYXXI&#39;: (0.03521138648486378+0j)}, {&#39;IXXYYI&#39;: (0.03521138648486378+0j)}, {&#39;IXYYXI&#39;: (-0.03521138648486378+0j)}, {&#39;IZIZII&#39;: (0.08295876958230786+0j)}], [{&#39;IYZIZY&#39;: (-0.02573161133632447+0j)}], [{&#39;IXZIZX&#39;: (-0.02573161133632447+0j)}], [{&#39;IZIIZI&#39;: (0.14393931792176595+0j)}, {&#39;IYZZIY&#39;: (-0.022469085890221424+0j)}], [{&#39;IXZZIX&#39;: (-0.022469085890221424+0j)}, {&#39;IZIIIZ&#39;: (0.11003101552075459+0j)}, {&#39;IIZZII&#39;: (0.13366602988233992+0j)}], [{&#39;IIYXXY&#39;: (0.03759887695074104+0j)}, {&#39;IIYYXX&#39;: (-0.03759887695074104+0j)}, {&#39;IIXXYY&#39;: (-0.03759887695074104+0j)}, {&#39;IIXYYX&#39;: (0.03759887695074104+0j)}, {&#39;IIZIZI&#39;: (0.09048399816423514+0j)}, {&#39;IIZIIZ&#39;: (0.12808287511497618+0j)}, {&#39;IIIZZI&#39;: (0.12808287511497618+0j)}, {&#39;IIIZIZ&#39;: (0.09048399816423514+0j)}, {&#39;IIIIZZ&#39;: (0.15636653196999328+0j)}]]
# pstr: 62, [&#39;IIIIII&#39;, &#39;ZIIIII&#39;, &#39;YZZZYI&#39;, &#39;XZZZXI&#39;, &#39;IZIIII&#39;, &#39;IYZZZY&#39;, &#39;IXZZZX&#39;, &#39;IIZIII&#39;, &#39;IIIZII&#39;, &#39;IIIIZI&#39;, &#39;IIIIIZ&#39;, &#39;ZZIIII&#39;, &#39;YIZZYI&#39;, &#39;XIZZXI&#39;, &#39;YXXYII&#39;, &#39;YYXXII&#39;, &#39;XXYYII&#39;, &#39;XYYXII&#39;, &#39;ZYZZZY&#39;, &#39;ZXZZZX&#39;, &#39;YXIIXY&#39;, &#39;YYIIXX&#39;, &#39;XXIIYY&#39;, &#39;XYIIYX&#39;, &#39;ZIZIII&#39;, &#39;YZIZYI&#39;, &#39;XZIZXI&#39;, &#39;ZIIZII&#39;, &#39;YZZIYI&#39;, &#39;XZZIXI&#39;, &#39;YZYYZY&#39;, &#39;YZYXZX&#39;, &#39;XZXYZY&#39;, &#39;XZXXZX&#39;, &#39;ZIIIZI&#39;, &#39;ZIIIIZ&#39;, &#39;YZZZYZ&#39;, &#39;XZZZXZ&#39;, &#39;IZZIII&#39;, &#39;IYIZZY&#39;, &#39;IXIZZX&#39;, &#39;IYXXYI&#39;, &#39;IYYXXI&#39;, &#39;IXXYYI&#39;, &#39;IXYYXI&#39;, &#39;IZIZII&#39;, &#39;IYZIZY&#39;, &#39;IXZIZX&#39;, &#39;IZIIZI&#39;, &#39;IYZZIY&#39;, &#39;IXZZIX&#39;, &#39;IZIIIZ&#39;, &#39;IIZZII&#39;, &#39;IIYXXY&#39;, &#39;IIYYXX&#39;, &#39;IIXXYY&#39;, &#39;IIXYYX&#39;, &#39;IIZIZI&#39;, &#39;IIZIIZ&#39;, &#39;IIIZZI&#39;, &#39;IIIZIZ&#39;, &#39;IIIIZZ&#39;]
# groups: 22
[[{&#39;IIIIII&#39;: (-0.7946868861351186+0j)}, {&#39;ZIIIII&#39;: (0.07739154273134108+0j)}, {&#39;YZZZYI&#39;: (0.00017539853505802415+0j)}], [{&#39;XZZZXI&#39;: (0.00017539853505802415+0j)}, {&#39;IZIIII&#39;: (0.07739154273134108+0j)}, {&#39;IYZZZY&#39;: (0.00017539853505801548+0j)}], [{&#39;IXZZZX&#39;: (0.00017539853505801548+0j)}, {&#39;IIZIII&#39;: (0.03932832166911874+0j)}, {&#39;IIIZII&#39;: (0.03932832166911876+0j)}, {&#39;IIIIZI&#39;: (-0.009149698193001765+0j)}, {&#39;IIIIIZ&#39;: (-0.009149698193001737+0j)}, {&#39;ZZIIII&#39;: (0.10715552374494021+0j)}, {&#39;YIZZYI&#39;: (-0.020389947107044795+0j)}], [{&#39;XIZZXI&#39;: (-0.020389947107044795+0j)}, {&#39;YXXYII&#39;: (0.03967029647931012+0j)}], [{&#39;YYXXII&#39;: (-0.03967029647931012+0j)}, {&#39;XXYYII&#39;: (-0.03967029647931012+0j)}, {&#39;XYYXII&#39;: (0.03967029647931012+0j)}, {&#39;ZYZZZY&#39;: (-0.0203899471070448+0j)}, {&#39;ZXZZZX&#39;: (-0.0203899471070448+0j)}], [{&#39;YXIIXY&#39;: (0.044968644933350135+0j)}], [{&#39;YYIIXX&#39;: (-0.044968644933350135+0j)}, {&#39;XXIIYY&#39;: (-0.044968644933350135+0j)}, {&#39;XYIIYX&#39;: (0.044968644933350135+0j)}], [{&#39;ZIZIII&#39;: (0.04852342426899797+0j)}, {&#39;YZIZYI&#39;: (-0.016181513749289257+0j)}], [{&#39;XZIZXI&#39;: (-0.016181513749289257+0j)}], [{&#39;ZIIZII&#39;: (0.08819372074830809+0j)}, {&#39;YZZIYI&#39;: (0.0241160446363052+0j)}], [{&#39;XZZIXI&#39;: (0.0241160446363052+0j)}, {&#39;YZYYZY&#39;: (-0.040297558385594456+0j)}], [{&#39;YZYXZX&#39;: (-0.040297558385594456+0j)}, {&#39;XZXYZY&#39;: (-0.040297558385594456+0j)}, {&#39;XZXXZX&#39;: (-0.040297558385594456+0j)}], [{&#39;ZIIIZI&#39;: (0.06506707204703148+0j)}, {&#39;ZIIIIZ&#39;: (0.11003571698038164+0j)}, {&#39;YZZZYZ&#39;: (-0.020565345637688855+0j)}], [{&#39;XZZZXZ&#39;: (-0.020565345637688855+0j)}, {&#39;IZZIII&#39;: (0.08819372074830809+0j)}], [{&#39;IYIZZY&#39;: (0.0241160446363052+0j)}], [{&#39;IXIZZX&#39;: (0.0241160446363052+0j)}, {&#39;IYXXYI&#39;: (-0.040297558385594456+0j)}], [{&#39;IYYXXI&#39;: (0.040297558385594456+0j)}, {&#39;IXXYYI&#39;: (0.040297558385594456+0j)}, {&#39;IXYYXI&#39;: (-0.040297558385594456+0j)}, {&#39;IZIZII&#39;: (0.04852342426899797+0j)}], [{&#39;IYZIZY&#39;: (-0.016181513749289257+0j)}], [{&#39;IXZIZX&#39;: (-0.016181513749289257+0j)}], [{&#39;IZIIZI&#39;: (0.11003571698038164+0j)}, {&#39;IYZZIY&#39;: (-0.020565345637688855+0j)}], [{&#39;IXZZIX&#39;: (-0.020565345637688855+0j)}, {&#39;IZIIIZ&#39;: (0.06506707204703148+0j)}, {&#39;IIZZII&#39;: (0.11352455640491824+0j)}], [{&#39;IIYXXY&#39;: (0.04171213810945367+0j)}, {&#39;IIYYXX&#39;: (-0.04171213810945367+0j)}, {&#39;IIXXYY&#39;: (-0.04171213810945367+0j)}, {&#39;IIXYYX&#39;: (0.04171213810945367+0j)}, {&#39;IIZIZI&#39;: (0.04975768241666035+0j)}, {&#39;IIZIIZ&#39;: (0.091469820526114+0j)}, {&#39;IIIZZI&#39;: (0.091469820526114+0j)}, {&#39;IIIZIZ&#39;: (0.04975768241666035+0j)}, {&#39;IIIIZZ&#39;: (0.11424311324535724+0j)}]]
rand_ob_str:  ZYXYIZ
rand_pstr_list:  [&#39;YZIXYX&#39;, &#39;YYYYXI&#39;, &#39;ZYYIXZ&#39;, &#39;ZYIIXY&#39;]
+++++++++++++++
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">worst_st_err_bnd</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">h_ob_1norm</span> <span class="o">*</span> <span class="n">tight_bound</span><span class="p">(</span><span class="n">h_list</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;spectral&#39;</span><span class="p">)</span>
<span class="n">averg_st_err_bnd</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">h_ob_1norm</span> <span class="o">*</span> <span class="n">tight_bound</span><span class="p">(</span><span class="n">h_list</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;fro&#39;</span><span class="p">)</span>

<span class="n">onestep_exactU</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">([</span><span class="n">herm</span> <span class="k">for</span> <span class="n">herm</span> <span class="ow">in</span> <span class="n">h_list</span><span class="p">]))</span>
<span class="n">d</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">h_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">E_op</span> <span class="o">=</span> <span class="n">onestep_exactU</span> <span class="o">-</span> <span class="n">pf_r</span><span class="p">(</span><span class="n">h_list</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">use_jax</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># print((np.trace(E_op @ E_op.conj().T @ E_op @ E_op.conj().T)/d)**(1/4))</span>
<span class="c1"># averg_ob_err_bnd = 2 * (np.trace(E_op @ E_op.conj().T @ E_op @ E_op.conj().T)/d)**(1/4) * (np.trace(h_ob @ h_ob @ h_ob @ h_ob)/d)**(1/4)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;EEEE:&quot;</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">E_op</span> <span class="o">@</span> <span class="n">E_op</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">E_op</span> <span class="o">@</span> <span class="n">E_op</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="n">d</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">h_ob</span> <span class="o">@</span> <span class="n">h_ob</span> <span class="o">@</span> <span class="n">h_ob</span> <span class="o">@</span> <span class="n">h_ob</span><span class="p">)</span><span class="o">/</span><span class="n">d</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span> <span class="s2">&quot;Fro:&quot;</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">E_op</span> <span class="o">@</span> <span class="n">E_op</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="n">d</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span> 
<span class="n">averg_ob_err_bnd</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">tight_bound</span><span class="p">(</span><span class="n">h_list</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;4&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">h_ob</span> <span class="o">@</span> <span class="n">h_ob</span> <span class="o">@</span> <span class="n">h_ob</span> <span class="o">@</span> <span class="n">h_ob</span><span class="p">)</span><span class="o">/</span><span class="n">d</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="c1"># print( 2 * (np.trace(E_op @ E_op.conj().T)/d)**(1/2))</span>
<span class="c1"># print( 2 * (np.trace(E_op @ E_op.conj().T @ E_op @ E_op.conj().T)/d)**(1/4) )</span>
<span class="c1"># print((np.trace(h_ob @ h_ob @ h_ob @ h_ob)/d)**(1/4))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">worst_st_err_bnd</span><span class="p">,</span> <span class="n">averg_st_err_bnd</span><span class="p">,</span> <span class="n">averg_ob_err_bnd</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">tight_bound</span><span class="p">(</span><span class="n">h_list</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;4&#39;</span><span class="p">),</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">h_ob</span> <span class="o">@</span> <span class="n">h_ob</span> <span class="o">@</span> <span class="n">h_ob</span> <span class="o">@</span> <span class="n">h_ob</span><span class="p">)</span><span class="o">/</span><span class="n">d</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>EEEE: (5.661386972774727e-06-3.0905612449423607e-24j) Fro: (4.451729649547679e-06+6.362777701118939e-25j)
0.009819972240223542 0.0035874049962433758 (0.0012333679927831924+0j)
(0.0013428272046044044+0j) (0.918486003675016+0j)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plt.errorbar(chem_data[&#39;t&#39;][::s], chem_data[&#39;averg_err&#39;][::s], chem_data[&#39;averg_err_std&#39;][::s], fmt=&#39;o-&#39;, label=&#39;Average w/o observable (Empirical)&#39;, capsize=5, color=&#39;#0A75C7FF&#39;)</span>
<span class="c1"># plt.errorbar(chem_data[&#39;t&#39;][::s], chem_data[&#39;averg_ob_err&#39;][::s], chem_data[&#39;averg_ob_err_std&#39;][::s], fmt=&#39;o--&#39;, capsize=5, color=&#39;#F39B7FFF&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r_start</span><span class="p">,</span> <span class="n">r_end</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1e-5</span>
<span class="n">t</span> <span class="o">=</span> <span class="mi">15</span>
<span class="c1"># t = 10</span>
<span class="n">n_sample</span><span class="p">,</span> <span class="n">n_round</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span>
<span class="n">exact_U</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">([</span><span class="n">h</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">h2_finl</span><span class="o">.</span><span class="n">hamiltonian_list</span><span class="p">]))</span>
<span class="n">bnd_worst_err_r</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">measure_error</span><span class="p">,</span> <span class="n">h_list</span><span class="o">=</span><span class="n">h_list</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">exact_U</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;worst_bound&#39;</span><span class="p">,</span> <span class="n">coeffs</span><span class="o">=</span><span class="p">[</span><span class="n">h_ob_1norm</span><span class="p">])</span>
<span class="n">bnd_averg_err_r</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">measure_error</span><span class="p">,</span> <span class="n">h_list</span><span class="o">=</span><span class="n">h_list</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">exact_U</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;average_bound&#39;</span><span class="p">,</span> <span class="n">coeffs</span><span class="o">=</span><span class="p">[</span><span class="n">h_ob_1norm</span><span class="p">])</span>
<span class="n">bnd_averg_ob_err_r</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">measure_error</span><span class="p">,</span> <span class="n">h_list</span><span class="o">=</span><span class="n">h_list</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">exact_U</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ob</span><span class="o">=</span><span class="n">h_ob</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;average_ob_bound&#39;</span><span class="p">)</span>

<span class="n">r_worst_bnd</span> <span class="o">=</span> <span class="n">binary_search_r</span><span class="p">(</span><span class="n">r_start</span><span class="p">,</span> <span class="n">r_end</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">bnd_worst_err_r</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">r_averg_bnd</span> <span class="o">=</span> <span class="n">binary_search_r</span><span class="p">(</span><span class="n">r_start</span><span class="p">,</span> <span class="n">r_end</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">bnd_averg_err_r</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">r_averg_ob_bnd</span> <span class="o">=</span> <span class="n">binary_search_r</span><span class="p">(</span><span class="n">r_start</span><span class="p">,</span> <span class="n">r_end</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">bnd_averg_ob_err_r</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;r_worst_bnd=</span><span class="si">{</span><span class="n">r_worst_bnd</span><span class="si">}</span><span class="s1">, r_averg_bnd=</span><span class="si">{</span><span class="n">r_averg_bnd</span><span class="si">}</span><span class="s1">, r_averg_ob_bnd=</span><span class="si">{</span><span class="n">r_averg_ob_bnd</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">r_averg_emp_list</span><span class="p">,</span> <span class="n">r_averg_ob_emp_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="nb">round</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_round</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;========</span><span class="si">{</span><span class="nb">round</span><span class="si">}</span><span class="s1"> round========&#39;</span><span class="p">)</span>
    <span class="n">rand_states</span> <span class="o">=</span> <span class="p">[</span><span class="n">random_statevector</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">exact_U</span><span class="p">))</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_sample</span><span class="p">)]</span>
    <span class="n">emp_averg_err_r</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">measure_error</span><span class="p">,</span> <span class="n">h_list</span><span class="o">=</span><span class="n">h_list</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">exact_U</span><span class="o">=</span><span class="n">exact_U</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;average_empirical&#39;</span><span class="p">,</span> <span class="n">rand_states</span><span class="o">=</span><span class="n">rand_states</span><span class="p">,</span> <span class="n">ob</span><span class="o">=</span><span class="n">h_ob</span><span class="p">)</span>
    <span class="n">emp_averg_ob_err_r</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">measure_error</span><span class="p">,</span> <span class="n">h_list</span><span class="o">=</span><span class="n">h_list</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">exact_U</span><span class="o">=</span><span class="n">exact_U</span><span class="p">,</span> <span class="n">ob</span><span class="o">=</span><span class="n">h_ob</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;average_ob_empirical&#39;</span><span class="p">,</span> <span class="n">rand_states</span><span class="o">=</span><span class="n">rand_states</span><span class="p">)</span>

    <span class="n">r_averg_emp</span> <span class="o">=</span> <span class="n">binary_search_r</span><span class="p">(</span><span class="n">r_start</span><span class="p">,</span> <span class="n">r_end</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">emp_averg_err_r</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">r_averg_ob_emp</span> <span class="o">=</span> <span class="n">binary_search_r</span><span class="p">(</span><span class="n">r_start</span><span class="p">,</span> <span class="n">r_end</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">emp_averg_ob_err_r</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">r_averg_emp_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r_averg_emp</span><span class="p">)</span>
    <span class="n">r_averg_ob_emp_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r_averg_ob_emp</span><span class="p">)</span>

<span class="n">L</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h_list</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="c1"># ising1d = transverse_field_ising_1d(n, J, h, [1], verbose=verbose)</span>
<span class="n">bar_data_12</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Worst&#39;</span><span class="p">:</span> <span class="n">r_worst_bnd</span><span class="o">*</span><span class="n">L</span><span class="p">,</span>
    <span class="s1">&#39;Average w/o ob (thm)&#39;</span><span class="p">:</span> <span class="n">r_averg_bnd</span><span class="o">*</span><span class="n">L</span><span class="p">,</span> <span class="c1"># r=15 (LC), 569</span>
    <span class="c1"># &#39;Average w/o ob (emp)&#39;: r_averg_emp*L, # r=15 (LC), 569</span>
    <span class="s1">&#39;Average w/o ob (emp)&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">r_averg_emp_list</span><span class="p">)</span><span class="o">*</span><span class="n">L</span><span class="p">,</span> <span class="c1"># r=15 (LC), 569</span>
    <span class="s1">&#39;Average w/ ob (thm)&#39;</span><span class="p">:</span> <span class="n">r_averg_ob_bnd</span><span class="o">*</span><span class="n">L</span><span class="p">,</span>
    <span class="c1"># &#39;Average w/ ob (emp)&#39;: r_averg_ob_emp*L,</span>
    <span class="s1">&#39;Average w/ ob (emp)&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">r_averg_ob_emp_list</span><span class="p">)</span><span class="o">*</span><span class="n">L</span><span class="p">,</span>
<span class="p">}</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">r_averg_emp_list</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">r_averg_ob_emp_list</span><span class="p">))</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">layout</span><span class="o">=</span><span class="s1">&#39;constrained&#39;</span><span class="p">)</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;#E64B35FF&quot;</span><span class="p">,</span> <span class="s2">&quot;#0A75C7FF&quot;</span><span class="p">,</span> <span class="s2">&quot;#F39B7FFF&quot;</span><span class="p">,</span> <span class="s2">&quot;#0A75C7FF&quot;</span><span class="p">,</span> <span class="s2">&quot;#F39B7FFF&quot;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">bar_data_12</span>

<span class="c1"># for i, k in enumerate(data.keys()):</span>
<span class="c1">#     ax.bar(k, data[k], color=colors[i], label=k, width=0.7, edgecolor = &quot;black&quot;)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="s1">&#39;Worst&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Worst&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#E64B35FF&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Worst&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="s1">&#39;Average w/o ob (thm)&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Average w/o ob (thm)&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#0A75C7FF&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Average w/o ob (thm)&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">hatch</span><span class="o">=</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="s1">&#39;Average w/ ob (thm)&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Average w/ ob (thm)&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#F39B7FFF&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Average w/ ob (thm)&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">hatch</span><span class="o">=</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="s1">&#39;Average w/o ob (emp)&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Average w/o ob (emp)&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#0A75C7FF&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Average w/o ob (emp)&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="s1">&#39;Average w/o ob (emp)&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Average w/o ob (emp)&#39;</span><span class="p">],</span> <span class="n">yerr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">r_averg_emp_list</span><span class="p">)</span><span class="o">*</span><span class="n">L</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="s1">&#39;Average w/ ob (emp)&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Average w/ ob (emp)&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#F39B7FFF&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Average w/ ob (emp)&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="s1">&#39;Average w/ ob (emp)&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Average w/ ob (emp)&#39;</span><span class="p">],</span> <span class="n">yerr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">r_averg_ob_emp_list</span><span class="p">)</span><span class="o">*</span><span class="n">L</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
<span class="c1"># ax.set_yticks(data[&#39;Average w/ ob (thm)&#39;]*np.array(range(6)))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;sci&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">scilimits</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Number of exponentials&#39;</span><span class="p">)</span>
<span class="c1"># ax.set_ylabel(f&#39;Trotter steps  $r$&#39;)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_right</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
<span class="c1"># ax.set_xlabel(&#39;Observable&#39;)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 50000
r_start: 1 ; r_end: 25000
r_start: 12500 ; r_end: 25000
r_start: 12500 ; r_end: 18750
r_start: 15625 ; r_end: 18750
r_start: 17187 ; r_end: 18750
r_start: 17968 ; r_end: 18750
r_start: 17968 ; r_end: 18359
r_start: 18163 ; r_end: 18359
r_start: 18163 ; r_end: 18261
r_start: 18163 ; r_end: 18212
r_start: 18187 ; r_end: 18212
r_start: 18199 ; r_end: 18212
r_start: 18205 ; r_end: 18212
r_start: 18205 ; r_end: 18208
r_start: 18205 ; r_end: 18206
r: 18206 ; err:  9.998962980309981e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 50000
r_start: 1 ; r_end: 25000
r_start: 1 ; r_end: 12500
r_start: 6250 ; r_end: 12500
r_start: 9375 ; r_end: 12500
r_start: 10937 ; r_end: 12500
r_start: 10937 ; r_end: 11718
r_start: 10937 ; r_end: 11327
r_start: 10937 ; r_end: 11132
r_start: 10937 ; r_end: 11034
r_start: 10985 ; r_end: 11034
r_start: 10985 ; r_end: 11009
r_start: 10997 ; r_end: 11009
r_start: 11003 ; r_end: 11009
r_start: 11003 ; r_end: 11006
r_start: 11003 ; r_end: 11004
r: 11004 ; err:  9.998918358957499e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 5000 ; r_end: 10000
r_start: 5000 ; r_end: 7500
r_start: 6250 ; r_end: 7500
r_start: 6250 ; r_end: 6875
r_start: 6250 ; r_end: 6562
r_start: 6406 ; r_end: 6562
r_start: 6406 ; r_end: 6484
r_start: 6445 ; r_end: 6484
r_start: 6445 ; r_end: 6464
r_start: 6445 ; r_end: 6454
r_start: 6449 ; r_end: 6454
r_start: 6451 ; r_end: 6454
r_start: 6451 ; r_end: 6452
r: 6452 ; err:  (9.999487309507673e-06+0j)
r_worst_bnd=18206, r_averg_bnd=11004, r_averg_ob_bnd=6452
========0 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1093 ; r_end: 1171
r_start: 1132 ; r_end: 1171
r_start: 1151 ; r_end: 1171
r_start: 1161 ; r_end: 1171
r_start: 1166 ; r_end: 1171
r_start: 1168 ; r_end: 1171
r_start: 1169 ; r_end: 1171
r_start: 1169 ; r_end: 1170
r: 1170 ; err:  9.989154221772814e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 171 ; r_end: 187
r_start: 179 ; r_end: 187
r_start: 179 ; r_end: 183
r_start: 181 ; r_end: 183
r_start: 181 ; r_end: 182
r: 182 ; err:  9.927474316152596e-06
========1 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1171 ; r_end: 1190
r_start: 1180 ; r_end: 1190
r_start: 1180 ; r_end: 1185
r_start: 1182 ; r_end: 1185
r_start: 1182 ; r_end: 1183
r: 1183 ; err:  9.990933475880887e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 171 ; r_end: 187
r_start: 171 ; r_end: 179
r_start: 171 ; r_end: 175
r_start: 171 ; r_end: 173
r_start: 171 ; r_end: 172
r: 172 ; err:  9.929433071120265e-06
========2 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1093 ; r_end: 1171
r_start: 1132 ; r_end: 1171
r_start: 1151 ; r_end: 1171
r_start: 1161 ; r_end: 1171
r_start: 1161 ; r_end: 1166
r_start: 1163 ; r_end: 1166
r_start: 1164 ; r_end: 1166
r_start: 1164 ; r_end: 1165
r: 1165 ; err:  9.98996371643846e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 156 ; r_end: 171
r_start: 163 ; r_end: 171
r_start: 163 ; r_end: 167
r_start: 165 ; r_end: 167
r_start: 166 ; r_end: 167
r: 167 ; err:  9.963925714007727e-06
========3 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1171 ; r_end: 1190
r_start: 1180 ; r_end: 1190
r_start: 1180 ; r_end: 1185
r_start: 1180 ; r_end: 1182
r_start: 1181 ; r_end: 1182
r: 1182 ; err:  9.99865833290156e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 156 ; r_end: 171
r_start: 156 ; r_end: 163
r_start: 156 ; r_end: 159
r_start: 157 ; r_end: 159
r_start: 158 ; r_end: 159
r: 159 ; err:  9.965924820535266e-06
========4 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1093 ; r_end: 1171
r_start: 1132 ; r_end: 1171
r_start: 1151 ; r_end: 1171
r_start: 1151 ; r_end: 1161
r_start: 1156 ; r_end: 1161
r_start: 1158 ; r_end: 1161
r_start: 1159 ; r_end: 1161
r_start: 1160 ; r_end: 1161
r: 1161 ; err:  9.995752704740444e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 156 ; r_end: 171
r_start: 163 ; r_end: 171
r_start: 163 ; r_end: 167
r_start: 163 ; r_end: 165
r_start: 163 ; r_end: 164
r: 164 ; err:  9.981884002297214e-06
========5 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1171 ; r_end: 1190
r_start: 1171 ; r_end: 1180
r_start: 1171 ; r_end: 1175
r_start: 1171 ; r_end: 1173
r_start: 1171 ; r_end: 1172
r: 1172 ; err:  9.99344465079141e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 171 ; r_end: 187
r_start: 171 ; r_end: 179
r_start: 175 ; r_end: 179
r_start: 177 ; r_end: 179
r_start: 178 ; r_end: 179
r: 179 ; err:  9.972707439847018e-06
========6 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1093 ; r_end: 1171
r_start: 1132 ; r_end: 1171
r_start: 1151 ; r_end: 1171
r_start: 1161 ; r_end: 1171
r_start: 1161 ; r_end: 1166
r_start: 1163 ; r_end: 1166
r_start: 1163 ; r_end: 1164
r: 1164 ; err:  9.998239362619643e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 156 ; r_end: 171
r_start: 163 ; r_end: 171
r_start: 167 ; r_end: 171
r_start: 169 ; r_end: 171
r_start: 170 ; r_end: 171
r: 171 ; err:  9.966810183334452e-06
========7 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1171 ; r_end: 1190
r_start: 1171 ; r_end: 1180
r_start: 1171 ; r_end: 1175
r_start: 1171 ; r_end: 1173
r_start: 1171 ; r_end: 1172
r: 1172 ; err:  9.998266307890196e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 156 ; r_end: 171
r_start: 163 ; r_end: 171
r_start: 163 ; r_end: 167
r_start: 163 ; r_end: 165
r_start: 164 ; r_end: 165
r: 165 ; err:  9.993825576836702e-06
========8 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1171 ; r_end: 1190
r_start: 1171 ; r_end: 1180
r_start: 1171 ; r_end: 1175
r_start: 1171 ; r_end: 1173
r_start: 1172 ; r_end: 1173
r: 1173 ; err:  9.983063551611784e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 125 ; r_end: 156
r_start: 140 ; r_end: 156
r_start: 148 ; r_end: 156
r_start: 152 ; r_end: 156
r_start: 152 ; r_end: 154
r_start: 153 ; r_end: 154
r: 154 ; err:  9.988575128045686e-06
========9 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1171 ; r_end: 1190
r_start: 1171 ; r_end: 1180
r_start: 1171 ; r_end: 1175
r_start: 1171 ; r_end: 1173
r_start: 1171 ; r_end: 1172
r: 1172 ; err:  9.990426776397534e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 187 ; r_end: 250
r_start: 187 ; r_end: 218
r_start: 187 ; r_end: 202
r_start: 187 ; r_end: 194
r_start: 190 ; r_end: 194
r_start: 192 ; r_end: 194
r_start: 192 ; r_end: 193
r: 193 ; err:  9.992753490728479e-06
========10 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1171 ; r_end: 1190
r_start: 1171 ; r_end: 1180
r_start: 1175 ; r_end: 1180
r_start: 1177 ; r_end: 1180
r_start: 1178 ; r_end: 1180
r_start: 1178 ; r_end: 1179
r: 1179 ; err:  9.993594422110337e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 171 ; r_end: 187
r_start: 179 ; r_end: 187
r_start: 179 ; r_end: 183
r_start: 181 ; r_end: 183
r_start: 182 ; r_end: 183
r: 183 ; err:  9.92634115558222e-06
========11 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1171 ; r_end: 1190
r_start: 1180 ; r_end: 1190
r_start: 1185 ; r_end: 1190
r_start: 1185 ; r_end: 1187
r_start: 1185 ; r_end: 1186
r: 1186 ; err:  9.999208868567048e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 156 ; r_end: 171
r_start: 163 ; r_end: 171
r_start: 163 ; r_end: 167
r_start: 163 ; r_end: 165
r_start: 163 ; r_end: 164
r: 164 ; err:  9.975684175531074e-06
========12 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1171 ; r_end: 1190
r_start: 1180 ; r_end: 1190
r_start: 1180 ; r_end: 1185
r_start: 1182 ; r_end: 1185
r_start: 1182 ; r_end: 1183
r: 1183 ; err:  9.987586544982539e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 171 ; r_end: 187
r_start: 171 ; r_end: 179
r_start: 171 ; r_end: 175
r_start: 173 ; r_end: 175
r_start: 173 ; r_end: 174
r: 174 ; err:  9.951521671829332e-06
========13 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1171 ; r_end: 1190
r_start: 1171 ; r_end: 1180
r_start: 1175 ; r_end: 1180
r_start: 1177 ; r_end: 1180
r_start: 1178 ; r_end: 1180
r_start: 1178 ; r_end: 1179
r: 1179 ; err:  9.984760840981358e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 156 ; r_end: 171
r_start: 156 ; r_end: 163
r_start: 159 ; r_end: 163
r_start: 161 ; r_end: 163
r_start: 162 ; r_end: 163
r: 163 ; err:  9.887017980617085e-06
========14 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1171 ; r_end: 1190
r_start: 1171 ; r_end: 1180
r_start: 1175 ; r_end: 1180
r_start: 1175 ; r_end: 1177
r_start: 1176 ; r_end: 1177
r: 1177 ; err:  9.988967891605945e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 156 ; r_end: 171
r_start: 156 ; r_end: 163
r_start: 159 ; r_end: 163
r_start: 161 ; r_end: 163
r_start: 161 ; r_end: 162
r: 162 ; err:  9.972824802103041e-06
========15 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1171 ; r_end: 1190
r_start: 1171 ; r_end: 1180
r_start: 1175 ; r_end: 1180
r_start: 1177 ; r_end: 1180
r_start: 1177 ; r_end: 1178
r: 1178 ; err:  9.991641160648423e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 171 ; r_end: 187
r_start: 171 ; r_end: 179
r_start: 175 ; r_end: 179
r_start: 177 ; r_end: 179
r_start: 178 ; r_end: 179
r: 179 ; err:  9.954542768383367e-06
========16 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1093 ; r_end: 1171
r_start: 1132 ; r_end: 1171
r_start: 1151 ; r_end: 1171
r_start: 1161 ; r_end: 1171
r_start: 1166 ; r_end: 1171
r_start: 1168 ; r_end: 1171
r_start: 1169 ; r_end: 1171
r_start: 1169 ; r_end: 1170
r: 1170 ; err:  9.98724670539688e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 171 ; r_end: 187
r_start: 171 ; r_end: 179
r_start: 175 ; r_end: 179
r_start: 175 ; r_end: 177
r_start: 175 ; r_end: 176
r: 176 ; err:  9.977563362755237e-06
========17 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1190 ; r_end: 1210
r_start: 1190 ; r_end: 1200
r_start: 1190 ; r_end: 1195
r_start: 1192 ; r_end: 1195
r_start: 1193 ; r_end: 1195
r_start: 1193 ; r_end: 1194
r: 1194 ; err:  9.998715519579221e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 171 ; r_end: 187
r_start: 171 ; r_end: 179
r_start: 175 ; r_end: 179
r_start: 175 ; r_end: 177
r_start: 176 ; r_end: 177
r: 177 ; err:  9.899451622557564e-06
========18 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1093 ; r_end: 1171
r_start: 1132 ; r_end: 1171
r_start: 1151 ; r_end: 1171
r_start: 1161 ; r_end: 1171
r_start: 1166 ; r_end: 1171
r_start: 1166 ; r_end: 1168
r_start: 1166 ; r_end: 1167
r: 1167 ; err:  9.98633881031072e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 156 ; r_end: 171
r_start: 163 ; r_end: 171
r_start: 167 ; r_end: 171
r_start: 167 ; r_end: 169
r_start: 168 ; r_end: 169
r: 169 ; err:  9.929362152607258e-06
========19 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1171 ; r_end: 1190
r_start: 1171 ; r_end: 1180
r_start: 1171 ; r_end: 1175
r_start: 1173 ; r_end: 1175
r_start: 1173 ; r_end: 1174
r: 1174 ; err:  9.991529394330756e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 171 ; r_end: 187
r_start: 171 ; r_end: 179
r_start: 171 ; r_end: 175
r_start: 173 ; r_end: 175
r_start: 173 ; r_end: 174
r: 174 ; err:  9.94170129683003e-06
========20 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1093 ; r_end: 1171
r_start: 1132 ; r_end: 1171
r_start: 1151 ; r_end: 1171
r_start: 1161 ; r_end: 1171
r_start: 1161 ; r_end: 1166
r_start: 1163 ; r_end: 1166
r_start: 1164 ; r_end: 1166
r_start: 1165 ; r_end: 1166
r: 1166 ; err:  9.987002371497266e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 125 ; r_end: 156
r_start: 140 ; r_end: 156
r_start: 148 ; r_end: 156
r_start: 148 ; r_end: 152
r_start: 148 ; r_end: 150
r_start: 148 ; r_end: 149
r: 149 ; err:  9.893487908717024e-06
========21 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1171 ; r_end: 1190
r_start: 1171 ; r_end: 1180
r_start: 1171 ; r_end: 1175
r_start: 1171 ; r_end: 1173
r_start: 1171 ; r_end: 1172
r: 1172 ; err:  9.996876871118063e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 171 ; r_end: 187
r_start: 171 ; r_end: 179
r_start: 171 ; r_end: 175
r_start: 171 ; r_end: 173
r_start: 172 ; r_end: 173
r: 173 ; err:  9.94428423694571e-06
========22 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1171 ; r_end: 1190
r_start: 1180 ; r_end: 1190
r_start: 1185 ; r_end: 1190
r_start: 1185 ; r_end: 1187
r_start: 1185 ; r_end: 1186
r: 1186 ; err:  9.990791242700101e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 156 ; r_end: 171
r_start: 156 ; r_end: 163
r_start: 159 ; r_end: 163
r_start: 161 ; r_end: 163
r_start: 162 ; r_end: 163
r: 163 ; err:  9.972975716029398e-06
========23 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1171 ; r_end: 1190
r_start: 1171 ; r_end: 1180
r_start: 1171 ; r_end: 1175
r_start: 1171 ; r_end: 1173
r_start: 1172 ; r_end: 1173
r: 1173 ; err:  9.9841755917774e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 171 ; r_end: 187
r_start: 171 ; r_end: 179
r_start: 175 ; r_end: 179
r_start: 177 ; r_end: 179
r_start: 178 ; r_end: 179
r: 179 ; err:  9.972866979435779e-06
========24 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1171 ; r_end: 1190
r_start: 1171 ; r_end: 1180
r_start: 1175 ; r_end: 1180
r_start: 1175 ; r_end: 1177
r_start: 1176 ; r_end: 1177
r: 1177 ; err:  9.990418322119385e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 156 ; r_end: 171
r_start: 163 ; r_end: 171
r_start: 167 ; r_end: 171
r_start: 169 ; r_end: 171
r_start: 169 ; r_end: 170
r: 170 ; err:  9.941173048382268e-06
========25 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1190 ; r_end: 1210
r_start: 1190 ; r_end: 1200
r_start: 1190 ; r_end: 1195
r_start: 1192 ; r_end: 1195
r_start: 1192 ; r_end: 1193
r: 1193 ; err:  9.985327438776944e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 171 ; r_end: 187
r_start: 171 ; r_end: 179
r_start: 175 ; r_end: 179
r_start: 177 ; r_end: 179
r_start: 177 ; r_end: 178
r: 178 ; err:  9.975162682552275e-06
========26 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1093 ; r_end: 1171
r_start: 1132 ; r_end: 1171
r_start: 1151 ; r_end: 1171
r_start: 1161 ; r_end: 1171
r_start: 1166 ; r_end: 1171
r_start: 1166 ; r_end: 1168
r_start: 1167 ; r_end: 1168
r: 1168 ; err:  9.995232729496031e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 156 ; r_end: 171
r_start: 156 ; r_end: 163
r_start: 159 ; r_end: 163
r_start: 159 ; r_end: 161
r_start: 159 ; r_end: 160
r: 160 ; err:  9.941632643530873e-06
========27 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1171 ; r_end: 1190
r_start: 1171 ; r_end: 1180
r_start: 1175 ; r_end: 1180
r_start: 1175 ; r_end: 1177
r_start: 1175 ; r_end: 1176
r: 1176 ; err:  9.986004791212736e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 156 ; r_end: 171
r_start: 163 ; r_end: 171
r_start: 167 ; r_end: 171
r_start: 169 ; r_end: 171
r_start: 170 ; r_end: 171
r: 171 ; err:  9.89929092191033e-06
========28 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1171 ; r_end: 1190
r_start: 1180 ; r_end: 1190
r_start: 1180 ; r_end: 1185
r_start: 1180 ; r_end: 1182
r_start: 1180 ; r_end: 1181
r: 1181 ; err:  9.995699282735009e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 156 ; r_end: 171
r_start: 163 ; r_end: 171
r_start: 163 ; r_end: 167
r_start: 165 ; r_end: 167
r_start: 166 ; r_end: 167
r: 167 ; err:  9.982262479103499e-06
========29 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1171 ; r_end: 1190
r_start: 1180 ; r_end: 1190
r_start: 1180 ; r_end: 1185
r_start: 1182 ; r_end: 1185
r_start: 1182 ; r_end: 1183
r: 1183 ; err:  9.990982907403691e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 156 ; r_end: 171
r_start: 163 ; r_end: 171
r_start: 167 ; r_end: 171
r_start: 169 ; r_end: 171
r_start: 170 ; r_end: 171
r: 171 ; err:  9.949450015988015e-06
========30 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1093 ; r_end: 1171
r_start: 1132 ; r_end: 1171
r_start: 1151 ; r_end: 1171
r_start: 1161 ; r_end: 1171
r_start: 1166 ; r_end: 1171
r_start: 1166 ; r_end: 1168
r_start: 1166 ; r_end: 1167
r: 1167 ; err:  9.98416556750137e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 125 ; r_end: 156
r_start: 140 ; r_end: 156
r_start: 148 ; r_end: 156
r_start: 152 ; r_end: 156
r_start: 152 ; r_end: 154
r_start: 153 ; r_end: 154
r: 154 ; err:  9.988938748883292e-06
========31 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1171 ; r_end: 1190
r_start: 1171 ; r_end: 1180
r_start: 1171 ; r_end: 1175
r_start: 1173 ; r_end: 1175
r_start: 1174 ; r_end: 1175
r: 1175 ; err:  9.99311289321153e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 156 ; r_end: 171
r_start: 163 ; r_end: 171
r_start: 167 ; r_end: 171
r_start: 169 ; r_end: 171
r_start: 170 ; r_end: 171
r: 171 ; err:  9.989681708507114e-06
========32 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1171 ; r_end: 1190
r_start: 1171 ; r_end: 1180
r_start: 1175 ; r_end: 1180
r_start: 1175 ; r_end: 1177
r_start: 1176 ; r_end: 1177
r: 1177 ; err:  9.99672481777295e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 156 ; r_end: 171
r_start: 163 ; r_end: 171
r_start: 163 ; r_end: 167
r_start: 165 ; r_end: 167
r_start: 165 ; r_end: 166
r: 166 ; err:  9.884534695797364e-06
========33 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1171 ; r_end: 1190
r_start: 1171 ; r_end: 1180
r_start: 1175 ; r_end: 1180
r_start: 1177 ; r_end: 1180
r_start: 1177 ; r_end: 1178
r: 1178 ; err:  9.990498921938207e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 125 ; r_end: 156
r_start: 140 ; r_end: 156
r_start: 148 ; r_end: 156
r_start: 148 ; r_end: 152
r_start: 148 ; r_end: 150
r_start: 148 ; r_end: 149
r: 149 ; err:  9.95628842301921e-06
========34 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1171 ; r_end: 1190
r_start: 1180 ; r_end: 1190
r_start: 1185 ; r_end: 1190
r_start: 1185 ; r_end: 1187
r_start: 1185 ; r_end: 1186
r: 1186 ; err:  9.998902234852213e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 171 ; r_end: 187
r_start: 179 ; r_end: 187
r_start: 179 ; r_end: 183
r_start: 179 ; r_end: 181
r_start: 180 ; r_end: 181
r: 181 ; err:  9.98250607372464e-06
========35 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1171 ; r_end: 1190
r_start: 1171 ; r_end: 1180
r_start: 1175 ; r_end: 1180
r_start: 1177 ; r_end: 1180
r_start: 1178 ; r_end: 1180
r_start: 1179 ; r_end: 1180
r: 1180 ; err:  9.983384391771454e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 171 ; r_end: 187
r_start: 171 ; r_end: 179
r_start: 171 ; r_end: 175
r_start: 173 ; r_end: 175
r_start: 174 ; r_end: 175
r: 175 ; err:  9.958592020136714e-06
========36 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1171 ; r_end: 1190
r_start: 1180 ; r_end: 1190
r_start: 1185 ; r_end: 1190
r_start: 1187 ; r_end: 1190
r_start: 1188 ; r_end: 1190
r_start: 1189 ; r_end: 1190
r: 1190 ; err:  9.995598856290783e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 171 ; r_end: 187
r_start: 179 ; r_end: 187
r_start: 183 ; r_end: 187
r_start: 185 ; r_end: 187
r_start: 185 ; r_end: 186
r: 186 ; err:  9.995710951026805e-06
========37 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1093 ; r_end: 1171
r_start: 1132 ; r_end: 1171
r_start: 1151 ; r_end: 1171
r_start: 1161 ; r_end: 1171
r_start: 1166 ; r_end: 1171
r_start: 1166 ; r_end: 1168
r_start: 1167 ; r_end: 1168
r: 1168 ; err:  9.990714194052725e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 156 ; r_end: 171
r_start: 163 ; r_end: 171
r_start: 167 ; r_end: 171
r_start: 169 ; r_end: 171
r_start: 170 ; r_end: 171
r: 171 ; err:  9.992275373674752e-06
========38 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1171 ; r_end: 1190
r_start: 1180 ; r_end: 1190
r_start: 1180 ; r_end: 1185
r_start: 1182 ; r_end: 1185
r_start: 1183 ; r_end: 1185
r_start: 1184 ; r_end: 1185
r: 1185 ; err:  9.999785475491218e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 171 ; r_end: 187
r_start: 179 ; r_end: 187
r_start: 179 ; r_end: 183
r_start: 181 ; r_end: 183
r_start: 182 ; r_end: 183
r: 183 ; err:  9.89496143420615e-06
========39 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1171 ; r_end: 1190
r_start: 1171 ; r_end: 1180
r_start: 1171 ; r_end: 1175
r_start: 1173 ; r_end: 1175
r_start: 1173 ; r_end: 1174
r: 1174 ; err:  9.990024003772724e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 171 ; r_end: 187
r_start: 171 ; r_end: 179
r_start: 175 ; r_end: 179
r_start: 177 ; r_end: 179
r_start: 178 ; r_end: 179
r: 179 ; err:  9.995434268331715e-06
========40 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1190 ; r_end: 1210
r_start: 1190 ; r_end: 1200
r_start: 1190 ; r_end: 1195
r_start: 1190 ; r_end: 1192
r_start: 1191 ; r_end: 1192
r: 1192 ; err:  9.992251467283456e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 156 ; r_end: 171
r_start: 163 ; r_end: 171
r_start: 163 ; r_end: 167
r_start: 165 ; r_end: 167
r_start: 165 ; r_end: 166
r: 166 ; err:  9.922877147567344e-06
========41 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1171 ; r_end: 1190
r_start: 1171 ; r_end: 1180
r_start: 1171 ; r_end: 1175
r_start: 1173 ; r_end: 1175
r_start: 1173 ; r_end: 1174
r: 1174 ; err:  9.991854056516753e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 171 ; r_end: 187
r_start: 179 ; r_end: 187
r_start: 179 ; r_end: 183
r_start: 179 ; r_end: 181
r_start: 179 ; r_end: 180
r: 180 ; err:  9.927949085974941e-06
========42 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1093 ; r_end: 1171
r_start: 1132 ; r_end: 1171
r_start: 1151 ; r_end: 1171
r_start: 1161 ; r_end: 1171
r_start: 1161 ; r_end: 1166
r_start: 1163 ; r_end: 1166
r_start: 1163 ; r_end: 1164
r: 1164 ; err:  9.999001905962284e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 156 ; r_end: 171
r_start: 163 ; r_end: 171
r_start: 167 ; r_end: 171
r_start: 169 ; r_end: 171
r_start: 169 ; r_end: 170
r: 170 ; err:  9.970525264805797e-06
========43 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1171 ; r_end: 1190
r_start: 1171 ; r_end: 1180
r_start: 1175 ; r_end: 1180
r_start: 1175 ; r_end: 1177
r_start: 1176 ; r_end: 1177
r: 1177 ; err:  9.990512218330928e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 156 ; r_end: 171
r_start: 163 ; r_end: 171
r_start: 167 ; r_end: 171
r_start: 169 ; r_end: 171
r_start: 169 ; r_end: 170
r: 170 ; err:  9.969592361401825e-06
========44 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1171 ; r_end: 1190
r_start: 1171 ; r_end: 1180
r_start: 1175 ; r_end: 1180
r_start: 1175 ; r_end: 1177
r_start: 1176 ; r_end: 1177
r: 1177 ; err:  9.998581046150582e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 171 ; r_end: 187
r_start: 179 ; r_end: 187
r_start: 179 ; r_end: 183
r_start: 181 ; r_end: 183
r_start: 181 ; r_end: 182
r: 182 ; err:  9.902528020472866e-06
========45 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1171 ; r_end: 1190
r_start: 1171 ; r_end: 1180
r_start: 1175 ; r_end: 1180
r_start: 1177 ; r_end: 1180
r_start: 1178 ; r_end: 1180
r_start: 1179 ; r_end: 1180
r: 1180 ; err:  9.991327318286675e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 156 ; r_end: 171
r_start: 156 ; r_end: 163
r_start: 156 ; r_end: 159
r_start: 156 ; r_end: 157
r: 157 ; err:  9.933110460097205e-06
========46 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1171 ; r_end: 1190
r_start: 1171 ; r_end: 1180
r_start: 1175 ; r_end: 1180
r_start: 1175 ; r_end: 1177
r_start: 1176 ; r_end: 1177
r: 1177 ; err:  9.990330002188044e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 125 ; r_end: 156
r_start: 140 ; r_end: 156
r_start: 148 ; r_end: 156
r_start: 152 ; r_end: 156
r_start: 154 ; r_end: 156
r_start: 155 ; r_end: 156
r: 156 ; err:  9.91656312319733e-06
========47 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1171 ; r_end: 1190
r_start: 1171 ; r_end: 1180
r_start: 1175 ; r_end: 1180
r_start: 1175 ; r_end: 1177
r_start: 1175 ; r_end: 1176
r: 1176 ; err:  9.990072904567021e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 125 ; r_end: 156
r_start: 140 ; r_end: 156
r_start: 140 ; r_end: 148
r_start: 140 ; r_end: 144
r_start: 142 ; r_end: 144
r_start: 142 ; r_end: 143
r: 143 ; err:  9.966356011600341e-06
========48 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1093 ; r_end: 1171
r_start: 1132 ; r_end: 1171
r_start: 1151 ; r_end: 1171
r_start: 1161 ; r_end: 1171
r_start: 1166 ; r_end: 1171
r_start: 1168 ; r_end: 1171
r_start: 1169 ; r_end: 1171
r_start: 1170 ; r_end: 1171
r: 1171 ; err:  9.987275271507375e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 156 ; r_end: 171
r_start: 156 ; r_end: 163
r_start: 159 ; r_end: 163
r_start: 161 ; r_end: 163
r_start: 162 ; r_end: 163
r: 163 ; err:  9.958553241567191e-06
========49 round========
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 5000
r_start: 1 ; r_end: 2500
r_start: 1 ; r_end: 1250
r_start: 625 ; r_end: 1250
r_start: 937 ; r_end: 1250
r_start: 1093 ; r_end: 1250
r_start: 1171 ; r_end: 1250
r_start: 1171 ; r_end: 1210
r_start: 1171 ; r_end: 1190
r_start: 1171 ; r_end: 1180
r_start: 1175 ; r_end: 1180
r_start: 1177 ; r_end: 1180
r_start: 1177 ; r_end: 1178
r: 1178 ; err:  9.9949449110735e-06
----binary search r (r_start=1, r_end=100)----
the initial r_end is too small, increase it by 10 times.
r_start: 1 ; r_end: 500
r_start: 1 ; r_end: 250
r_start: 125 ; r_end: 250
r_start: 125 ; r_end: 187
r_start: 156 ; r_end: 187
r_start: 156 ; r_end: 171
r_start: 156 ; r_end: 163
r_start: 159 ; r_end: 163
r_start: 159 ; r_end: 161
r_start: 160 ; r_end: 161
r: 161 ; err:  9.930172402959625e-06
121
7.652868743157693 10.307453613769018
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/1e3c9fe11f49250a4134197ff01257f578506736445861f0b4786bd05bbfc17a.png"><img alt="_images/1e3c9fe11f49250a4134197ff01257f578506736445861f0b4786bd05bbfc17a.png" src="_images/1e3c9fe11f49250a4134197ff01257f578506736445861f0b4786bd05bbfc17a.png" style="width: 511px; height: 511px;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">LARGE_SIZE</span><span class="o">+</span><span class="mi">6</span><span class="p">)</span>  <span class="c1"># controls default text sizes</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">titlesize</span><span class="o">=</span><span class="n">LARGE_SIZE</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># fontsize of the axes title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">LARGE_SIZE</span><span class="o">+</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># fontsize of the x and y labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;xtick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">LARGE_SIZE</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># fontsize of the tick labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;ytick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">LARGE_SIZE</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># fontsize of the tick labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;legend&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">MEDIUM_SIZE</span><span class="p">)</span>  <span class="c1"># legend fontsize</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;figure&#39;</span><span class="p">,</span> <span class="n">titlesize</span><span class="o">=</span><span class="n">LARGE_SIZE</span><span class="p">)</span> 
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;lines.linewidth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.5</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.linewidth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.5</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;lines.markersize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;lines.markeredgewidth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;xtick.major.width&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;ytick.major.width&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;ytick.minor.width&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;ytick.major.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;ytick.minor.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;xtick.major.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;xtick.minor.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="n">layout</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;legend&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">MEDIUM_SIZE</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>  
<span class="n">s</span> <span class="o">=</span> <span class="mi">1</span>
<span class="c1"># ax.plot(chem_data[&#39;t&#39;][::s], chem_data[&#39;worst_err&#39;][::s], &#39;D-&#39;, label=&#39;Worst-case (Empirical)&#39;, color=&#39;#E64B35FF&#39;)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">chem_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">][::</span><span class="n">s</span><span class="p">],</span> <span class="p">[</span><span class="n">worst_st_err_bnd</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="mi">2</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">chem_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">][::</span><span class="n">s</span><span class="p">]],</span> <span class="s1">&#39;s-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Worst-case (Theoretical)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#E64B35FF&#39;</span><span class="p">)</span>
<span class="c1"># ax.plot(chem_data[&#39;t&#39;], chem_data[&#39;typic_err&#39;], &#39;o-&#39;, label=&#39;Specific-case (state, l2 norm)&#39;)</span>
<span class="c1"># ax.plot(chem_data[&#39;t&#39;], chem_data[&#39;typic_err_trace&#39;], &#39;o-&#39;, label=&#39;Specific-case (state, trace norm)&#39;)</span>
<span class="c1"># ax.plot(chem_data[&#39;t&#39;], chem_data[&#39;typic_ob_err&#39;], &#39;o--&#39;, label=&#39;Specific-case (observable)&#39;)</span>

<span class="c1"># ax.plot(chem_data[&#39;t&#39;], chem_data[&#39;averg_err&#39;], &#39;^-&#39;, label=&#39;Average-case (state)&#39;)</span>
<span class="c1"># ax.plot(chem_data[&#39;t&#39;], chem_data[&#39;averg_ob_err&#39;], &#39;^--&#39;, label=&#39;Average-case (observable)&#39;)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">chem_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">][::</span><span class="n">s</span><span class="p">],</span> <span class="n">chem_data</span><span class="p">[</span><span class="s1">&#39;averg_err&#39;</span><span class="p">][::</span><span class="n">s</span><span class="p">],</span> <span class="n">chem_data</span><span class="p">[</span><span class="s1">&#39;averg_err_std&#39;</span><span class="p">][::</span><span class="n">s</span><span class="p">],</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Average w/o observable (Empirical)&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#0A75C7FF&#39;</span><span class="p">)</span>
<span class="c1"># ax.plot(chem_data[&#39;t&#39;][::s], np.array(chem_data[&#39;worst_ob_err&#39;][::s]), &#39;s--&#39;, label=&#39;Worst-case (observable)&#39;)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">chem_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">][::</span><span class="n">s</span><span class="p">],</span> <span class="n">chem_data</span><span class="p">[</span><span class="s1">&#39;averg_ob_err&#39;</span><span class="p">][::</span><span class="n">s</span><span class="p">],</span> <span class="n">chem_data</span><span class="p">[</span><span class="s1">&#39;averg_ob_err_std&#39;</span><span class="p">][::</span><span class="n">s</span><span class="p">],</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Average with observable (Empirical)&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#F39B7FFF&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">chem_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">][::</span><span class="n">s</span><span class="p">],</span> <span class="p">[</span><span class="n">averg_st_err_bnd</span><span class="o">*</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">chem_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">][::</span><span class="n">s</span><span class="p">]],</span> <span class="s1">&#39;^-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Average w/o observable (Theoretical)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#0A75C7FF&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">chem_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">][::</span><span class="n">s</span><span class="p">],</span> <span class="p">[</span><span class="n">averg_ob_err_bnd</span><span class="o">*</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">chem_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">][::</span><span class="n">s</span><span class="p">]],</span> <span class="s1">&#39;^-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Average with observable (Theoretical)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#F39B7FFF&#39;</span><span class="p">)</span>
<span class="c1"># ax.set_title(rf&#39;H{n_hydrogen} chain, init d={d}, H=H{n_hydrogen}(2d), ob=H2(d), dt={0.1}&#39;)</span>
<span class="c1"># ax.set_title(rf&#39;H{n_hydrogen} chain, init d={d}, H=H2(2d), ob=H2(d), r={r}&#39;)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">rf</span><span class="s1">&#39;Simulation time $t$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">rf</span><span class="s1">&#39;Error&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>   
<span class="c1"># ax.loglog()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center right&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.97</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">))</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1.inset_locator</span> <span class="kn">import</span> <span class="n">inset_axes</span>
<span class="c1"># mpl.rcParams[&#39;legend.frameon&#39;] = True</span>
<span class="n">ax_pow</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">1.33</span><span class="p">,</span> <span class="mf">.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">borderpad</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">axins1</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">4.5</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.15</span><span class="p">,</span> <span class="mf">.0</span><span class="p">,</span> <span class="mf">.7</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">borderpad</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">axins0</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">4.5</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.15</span><span class="p">,</span> <span class="mf">.25</span><span class="p">,</span> <span class="mf">.7</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">borderpad</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># axins2 = inset_axes(ax, width=3.5, height=&quot;100%&quot;, bbox_to_anchor=(1.05, .5, .5, 0.5), bbox_transform=ax.transAxes, loc=2, borderpad=0)</span>
<span class="n">ax_bar</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">4.5</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.15</span><span class="p">,</span> <span class="mf">.4</span><span class="p">,</span> <span class="mf">.7</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">),</span> <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">borderpad</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># axins2.plot(chem_data[&#39;t&#39;][::s], [worst_st_err_bnd*t*2 for t in chem_data[&#39;t&#39;][::s]], &#39;s-&#39;, label=&#39;Worst-case (Theoretical)&#39;, color=&#39;#E64B35FF&#39;)</span>
<span class="c1"># axins2.errorbar(chem_data[&#39;t&#39;][::s], chem_data[&#39;averg_ob_err&#39;][::s], chem_data[&#39;averg_ob_err_std&#39;][::s], fmt=&#39;o--&#39;, capsize=5, color=&#39;#F39B7FFF&#39;)</span>
<span class="c1"># axins2.plot(chem_data[&#39;t&#39;][::s], [averg_st_err_bnd*t for t in chem_data[&#39;t&#39;][::s]], &#39;^-&#39;, color=&#39;#0A75C7FF&#39;)</span>
<span class="c1"># axins2.plot(chem_data[&#39;t&#39;][::s], [averg_ob_err_bnd*t/dt for t in chem_data[&#39;t&#39;][::s]], &#39;^-&#39;, color=&#39;#F39B7FFF&#39;)</span>
<span class="c1"># axins2.legend(); axins2.grid()</span>
<span class="c1"># axins2.set_xlabel(rf&#39;Simulation time $t$&#39;); axins2.set_ylabel(rf&#39;Error&#39;)</span>
<span class="c1"># axins2.yaxis.tick_right()</span>
<span class="c1"># axins2.yaxis.set_label_position(&quot;right&quot;)</span>
<span class="c1"># axins2.ticklabel_format(style=&#39;sci&#39;, axis=&#39;y&#39;, scilimits=(0,0))</span>

<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;#E64B35FF&quot;</span><span class="p">,</span> <span class="s2">&quot;#0A75C7FF&quot;</span><span class="p">,</span> <span class="s2">&quot;#F39B7FFF&quot;</span><span class="p">,</span> <span class="s2">&quot;#0A75C7FF&quot;</span><span class="p">,</span> <span class="s2">&quot;#F39B7FFF&quot;</span><span class="p">]</span>

<span class="c1"># plt.rc(&#39;legend&#39;, fontsize=MEDIUM_SIZE-2) </span>
<span class="c1"># for i, k in enumerate(data.keys()):</span>
<span class="c1">#     ax.bar(k, data[k], color=colors[i], label=k, width=0.7, edgecolor = &quot;black&quot;)</span>
<span class="n">ax_bar</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="s1">&#39;Worst&#39;</span><span class="p">,</span> <span class="n">bar_data_12</span><span class="p">[</span><span class="s1">&#39;Worst&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#E64B35FF&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Worst-case (T)&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax_bar</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="s1">&#39;Average w/o ob (thm)&#39;</span><span class="p">,</span> <span class="n">bar_data_12</span><span class="p">[</span><span class="s1">&#39;Average w/o ob (thm)&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#0A75C7FF&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Average w/o ob (T)&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">hatch</span><span class="o">=</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax_bar</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="s1">&#39;Average w ob (thm)&#39;</span><span class="p">,</span> <span class="n">bar_data_12</span><span class="p">[</span><span class="s1">&#39;Average w/ ob (thm)&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#F39B7FFF&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Average with ob (T)&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">hatch</span><span class="o">=</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax_bar</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="s1">&#39;Average w/o ob (emp)&#39;</span><span class="p">,</span> <span class="n">bar_data_12</span><span class="p">[</span><span class="s1">&#39;Average w/o ob (emp)&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#0A75C7FF&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Average w/o ob (E)&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax_bar</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="s1">&#39;Average w/o ob (emp)&#39;</span><span class="p">,</span> <span class="n">bar_data_12</span><span class="p">[</span><span class="s1">&#39;Average w/o ob (emp)&#39;</span><span class="p">],</span> <span class="n">yerr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">r_averg_emp_list</span><span class="p">)</span><span class="o">*</span><span class="n">L</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="n">ax_bar</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="s1">&#39;Average w ob (emp)&#39;</span><span class="p">,</span> <span class="n">bar_data_12</span><span class="p">[</span><span class="s1">&#39;Average w/ ob (emp)&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#F39B7FFF&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Average with ob (E)&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax_bar</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="s1">&#39;Average w ob (emp)&#39;</span><span class="p">,</span> <span class="n">bar_data_12</span><span class="p">[</span><span class="s1">&#39;Average w/ ob (emp)&#39;</span><span class="p">],</span> <span class="n">yerr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">r_averg_ob_emp_list</span><span class="p">)</span><span class="o">*</span><span class="n">L</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="n">ax_bar</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
<span class="c1"># ax_bar.set_yticks(data[&#39;Average w/ ob (thm)&#39;]*np.array(range(6)))</span>
<span class="n">ax_bar</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax_bar</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;sci&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">scilimits</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">ax_bar</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Number of exponentials&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">LARGE_SIZE</span><span class="o">+</span><span class="mi">6</span><span class="p">)</span>
<span class="c1"># ax_bar.set_ylabel(f&#39;Trotter steps  $r$&#39;)</span>
<span class="n">ax_bar</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_right</span><span class="p">()</span>
<span class="n">ax_bar</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
<span class="c1"># ax_bar.set_xlabel(&#39;Observable&#39;)</span>
<span class="n">ax_bar</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="c1"># ax.ticklabel_format(style=&#39;sci&#39;, axis=&#39;y&#39;, scilimits=(0,0))</span>
<span class="n">axins1</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;sci&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">scilimits</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">axins1</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;sci&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">scilimits</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">axins0</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;sci&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">scilimits</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>

<span class="n">violin_data0</span><span class="p">,</span> <span class="n">violin_data1</span> <span class="o">=</span> <span class="p">[</span><span class="n">averg_st_err</span><span class="p">],</span> <span class="p">[</span><span class="n">averg_ob_err</span><span class="p">]</span>
<span class="c1"># violin_data = [[chem_data[&#39;worst_err&#39;][-1]], averg_st_err, averg_ob_err]</span>
<span class="c1"># axins1.boxplot(violin_data)</span>
<span class="n">vplots0</span> <span class="o">=</span> <span class="n">axins0</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">violin_data0</span><span class="p">,</span> <span class="n">showmeans</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">showmedians</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">vert</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">vplots1</span> <span class="o">=</span> <span class="n">axins1</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">violin_data1</span><span class="p">,</span> <span class="n">showmeans</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">showmedians</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">vert</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># axins1.set_xticks([1,2], labels=[&#39;w/o&#39;, &#39;w/&#39;])</span>
<span class="n">axins1</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;with&#39;</span><span class="p">])</span>
<span class="n">axins0</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;w/o&#39;</span><span class="p">])</span>
<span class="c1"># axins1.set_xlim([0-0.05*chem_data[&#39;worst_err&#39;][-1], 1.05*chem_data[&#39;worst_err&#39;][-1]])</span>
<span class="c1"># axins1.set_xticklabels([&#39;w/o&#39;, &#39;w/&#39;])</span>
<span class="c1"># axins1.set_yticks(2e-5 * np.array([0, 1, 2]))</span>
<span class="n">axins0</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">rf</span><span class="s1">&#39;Error&#39;</span><span class="p">)</span>
<span class="n">axins1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">rf</span><span class="s1">&#39;Error&#39;</span><span class="p">)</span>
<span class="n">axins1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_right</span><span class="p">()</span>
<span class="n">axins0</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_right</span><span class="p">()</span>
<span class="c1"># axins0.xaxis.tick_top()</span>
<span class="c1"># axins1.xaxis.tick_top()</span>
<span class="c1"># axins0.xaxis.set_label_position(&quot;top&quot;)</span>

<span class="c1"># axins1.set_xticks([1,2,3], labels=[&#39;Worst&#39;, &#39;state&#39;, &#39;ob&#39;])</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;#F39B7FFF&quot;</span><span class="p">,</span> <span class="s2">&quot;#0A75C7&quot;</span><span class="p">]</span>
<span class="c1"># colors = [&quot;#E64B35FF&quot;, &quot;#47B167&quot;, &quot;#0A75C7&quot;]</span>
<span class="c1"># colors = [&quot;#0A75C7&quot;, &quot;#F39B7FFF&quot;]</span>
<span class="c1"># Set the color of the violin patches</span>
<span class="k">for</span> <span class="n">pc</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">vplots0</span><span class="p">[</span><span class="s1">&#39;bodies&#39;</span><span class="p">],</span> <span class="n">colors</span><span class="p">):</span>
    <span class="n">pc</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">([</span><span class="s2">&quot;#0A75C7FF&quot;</span><span class="p">])</span>
    <span class="n">pc</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">pc</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">pc</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
<span class="k">for</span> <span class="n">partname</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;cbars&#39;</span><span class="p">,</span> <span class="s1">&#39;cmins&#39;</span><span class="p">,</span><span class="s1">&#39;cmaxes&#39;</span><span class="p">,</span><span class="s1">&#39;cmedians&#39;</span><span class="p">):</span>
    <span class="n">vp</span> <span class="o">=</span> <span class="n">vplots1</span><span class="p">[</span><span class="n">partname</span><span class="p">]</span>
    <span class="n">vp</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
    <span class="n">vp</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>

<span class="k">for</span> <span class="n">pc</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">vplots1</span><span class="p">[</span><span class="s1">&#39;bodies&#39;</span><span class="p">],</span> <span class="n">colors</span><span class="p">):</span>
    <span class="n">pc</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">([</span><span class="s2">&quot;#F39B7FFF&quot;</span><span class="p">])</span>
    <span class="n">pc</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">pc</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">pc</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
<span class="k">for</span> <span class="n">partname</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;cbars&#39;</span><span class="p">,</span> <span class="s1">&#39;cmins&#39;</span><span class="p">,</span><span class="s1">&#39;cmaxes&#39;</span><span class="p">,</span><span class="s1">&#39;cmedians&#39;</span><span class="p">):</span>
    <span class="n">vp</span> <span class="o">=</span> <span class="n">vplots1</span><span class="p">[</span><span class="n">partname</span><span class="p">]</span>
    <span class="n">vp</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
    <span class="n">vp</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
    <span class="n">vp</span> <span class="o">=</span> <span class="n">vplots0</span><span class="p">[</span><span class="n">partname</span><span class="p">]</span>
    <span class="n">vp</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">([</span><span class="s2">&quot;#0A75C7FF&quot;</span><span class="p">])</span>
    <span class="n">vp</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
<span class="c1"># vplots1[&#39;cmedians&#39;].set_edgecolor(&#39;k&#39;)</span>
<span class="n">vplots1</span><span class="p">[</span><span class="s1">&#39;cmedians&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">vplots1</span><span class="p">[</span><span class="s1">&#39;cmedians&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
<span class="n">vplots0</span><span class="p">[</span><span class="s1">&#39;cmedians&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">vplots0</span><span class="p">[</span><span class="s1">&#39;cmedians&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
<span class="n">quartile1</span><span class="p">,</span> <span class="n">medians</span><span class="p">,</span> <span class="n">quartile3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">violin_data1</span><span class="p">,</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># quartile1, medians, quartile3 = np.percentile([averg_st_err, averg_ob_err], [25, 50, 75], axis=1)</span>
<span class="c1"># axins1.hlines([1, 2], quartile1, quartile3, color=colors, linestyle=&#39;-&#39;, lw=5)</span>
<span class="n">axins1</span><span class="o">.</span><span class="n">hlines</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="n">quartile1</span><span class="p">,</span> <span class="n">quartile3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">quartile1</span><span class="p">,</span> <span class="n">medians</span><span class="p">,</span> <span class="n">quartile3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">violin_data0</span><span class="p">,</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">axins0</span><span class="o">.</span><span class="n">hlines</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="n">quartile1</span><span class="p">,</span> <span class="n">quartile3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="c1"># axins1.set_ylim([0-0.05*chem_data[&#39;worst_err&#39;][-1], 1.05*chem_data[&#39;worst_err&#39;][-1]])</span>
<span class="n">axins1</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span><span class="n">axins0</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="c1"># axins1.vlines([2, 3], quartile1, quartile3, color=colors[1:], linestyle=&#39;-&#39;, lw=5)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">chem_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">.2</span><span class="p">,</span> <span class="n">chem_data</span><span class="p">[</span><span class="s1">&#39;averg_err&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">0.7</span><span class="p">),</span> <span class="p">(</span><span class="n">chem_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">3</span><span class="p">,</span> <span class="n">chem_data</span><span class="p">[</span><span class="s1">&#39;averg_err&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">0.005</span><span class="p">),</span> <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad=-0.48&quot;</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">chem_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">.2</span><span class="p">,</span> <span class="n">chem_data</span><span class="p">[</span><span class="s1">&#39;averg_ob_err&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="n">chem_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">3</span><span class="p">,</span> <span class="n">chem_data</span><span class="p">[</span><span class="s1">&#39;averg_ob_err&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">0.003</span><span class="p">),</span> <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad=-0.3&quot;</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="c1"># ax.annotate(&#39;&#39;, (chem_data[&#39;t&#39;][-1]+.5, chem_data[&#39;averg_ob_err&#39;][-1]), (chem_data[&#39;t&#39;][-1]+3, chem_data[&#39;averg_ob_err&#39;][-1]*0.003), arrowprops=dict(facecolor=colors[0], shrink=0.05, lw=1,width=8, headwidth=18))</span>
<span class="c1"># for pc, color in zip(vplots1[&#39;cmedians&#39;], colors):</span>
<span class="c1">#     pc.set_colors(color)</span>
<span class="c1"># ax.indicate_inset_zoom(axins, edgecolor=&quot;black&quot;)</span>
<span class="c1"># axins.set_xticklabels([&#39;state&#39;, &#39;ob&#39;])</span>
<span class="c1"># axins1.get_xaxis().get_offset_text().set_position((1.1, 10.1))</span>

<span class="n">n_max</span> <span class="o">=</span> <span class="mi">11</span>
<span class="n">r</span> <span class="o">=</span> <span class="mi">10000</span> <span class="c1"># 5000</span>
<span class="n">eps</span> <span class="o">=</span> <span class="mf">1e-3</span>
<span class="n">n_sample</span><span class="p">,</span> <span class="n">n_round</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">10</span>
<span class="n">n_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">n_max</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># data = np.load(f&#39;{data_dir}/{prefix}_data_max={n_max}_sample={n_sample}_{suffix}.npy&#39;, allow_pickle=True).item()</span>
<span class="n">prefix</span><span class="p">,</span> <span class="n">suffix</span> <span class="o">=</span> <span class="s1">&#39;Pow&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">data_dir</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">_data_max=</span><span class="si">{</span><span class="n">n_max</span><span class="si">}</span><span class="s1">_sample=</span><span class="si">{</span><span class="n">n_sample</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">suffix</span><span class="si">}</span><span class="s1">_4norm.npy&#39;</span><span class="p">,</span> <span class="n">allow_pickle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>


<span class="c1"># ax.plot(n_list, norm4_list, &#39;s&#39;, label=&#39;Norm4&#39;)</span>
<span class="n">ax_pow</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bnd_worst&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Worst-case (Theoretical)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#E64B35FF&quot;</span><span class="p">)</span>
<span class="n">ax_pow</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bnd_averg&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Average w/o observable (Theoretical)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#0A75C7&quot;</span><span class="p">)</span>
<span class="n">ax_pow</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bnd_averg_magn&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Average with observable (Theoretical)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#F39B7FFF&quot;</span><span class="p">)</span>
<span class="c1"># ax_pow.plot(n_list[1:], data[&#39;emp_worst&#39;][1:], &#39;D&#39;, label=&#39;Worst-case (Empirical)&#39;, color=&quot;#E64B35FF&quot;)</span>
<span class="n">ax_pow</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">n_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_averg&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_averg_std&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Average w/o observable (Empirical)&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">elinewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#0A75C7&quot;</span><span class="p">)</span>
<span class="n">ax_pow</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">n_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_averg_magn&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_averg_magn_std&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Average with observable (Empirical)&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">elinewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#F39B7FFF&quot;</span><span class="p">)</span>

<span class="n">plot_fit</span><span class="p">(</span><span class="n">ax_pow</span><span class="p">,</span> <span class="n">n_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bnd_worst&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">var</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span> <span class="n">x_offset</span><span class="o">=</span><span class="mf">1.05</span><span class="p">)</span>
<span class="c1"># plot_fit(ax_pow, n_list[1:], data[&#39;emp_worst&#39;][1:], var=suffix, x_offset=1.05, y_offset=0.90)</span>
<span class="n">plot_fit</span><span class="p">(</span><span class="n">ax_pow</span><span class="p">,</span> <span class="n">n_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bnd_averg&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">var</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span> <span class="n">x_offset</span><span class="o">=</span><span class="mf">1.05</span><span class="p">)</span>
<span class="n">plot_fit</span><span class="p">(</span><span class="n">ax_pow</span><span class="p">,</span> <span class="n">n_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_averg&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">var</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span> <span class="n">x_offset</span><span class="o">=</span><span class="mf">1.05</span><span class="p">)</span>
<span class="n">plot_fit</span><span class="p">(</span><span class="n">ax_pow</span><span class="p">,</span> <span class="n">n_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bnd_averg_magn&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">var</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span> <span class="n">x_offset</span><span class="o">=</span><span class="mf">1.05</span><span class="p">)</span>
<span class="n">plot_fit</span><span class="p">(</span><span class="n">ax_pow</span><span class="p">,</span> <span class="n">n_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;emp_averg_magn&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">var</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span> <span class="n">x_offset</span><span class="o">=</span><span class="mf">1.05</span><span class="p">)</span>
<span class="n">ax_pow</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">rf</span><span class="s1">&#39;Number of qubits $n$&#39;</span><span class="p">)</span>
<span class="n">ax_pow</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">rf</span><span class="s1">&#39;Error&#39;</span><span class="p">)</span>
<span class="n">ax_pow</span><span class="o">.</span><span class="n">loglog</span><span class="p">();</span> <span class="n">ax_pow</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax_pow</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">n_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
<span class="n">ax_pow</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">ScalarFormatter</span><span class="p">())</span>
<span class="n">ax_pow</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center right&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.99</span><span class="p">,</span> <span class="mf">0.40</span><span class="p">))</span> 

<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;sans-serif&#39;</span>
<span class="n">ax_pow</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">1.43</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;(a)&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">LARGE_SIZE</span><span class="o">+</span><span class="mi">8</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">.09</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;(b)&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">LARGE_SIZE</span><span class="o">+</span><span class="mi">8</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">axins1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;(c)&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">LARGE_SIZE</span><span class="o">+</span><span class="mi">8</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">axins1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;(d)&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">LARGE_SIZE</span><span class="o">+</span><span class="mi">8</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">axins0</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;(e)&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">LARGE_SIZE</span><span class="o">+</span><span class="mi">8</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">figs_dir</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">_d=</span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s1">_r=</span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s1">_n=</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s1">_sample=</span><span class="si">{</span><span class="n">n_sample</span><span class="si">}</span><span class="s1">_merged.pdf&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/homebrew/Caskroom/miniforge/base/lib/python3.10/site-packages/matplotlib/cbook.py:1699: ComplexWarning: Casting complex values to real discards the imaginary part
  return math.isfinite(val)
/opt/homebrew/Caskroom/miniforge/base/lib/python3.10/site-packages/matplotlib/cbook.py:1345: ComplexWarning: Casting complex values to real discards the imaginary part
  return np.asarray(x, float)
/opt/homebrew/Caskroom/miniforge/base/lib/python3.10/site-packages/matplotlib/cbook.py:1699: ComplexWarning: Casting complex values to real discards the imaginary part
  return math.isfinite(val)
/opt/homebrew/Caskroom/miniforge/base/lib/python3.10/site-packages/matplotlib/cbook.py:1345: ComplexWarning: Casting complex values to real discards the imaginary part
  return np.asarray(x, float)
/opt/homebrew/Caskroom/miniforge/base/lib/python3.10/site-packages/numpy/lib/function_base.py:628: ComplexWarning: Casting complex values to real discards the imaginary part
  a = asarray(a, dtype=dtype, order=order)
/var/folders/zc/9k4hbf5n07d86qpnf8lqkw3w0000gn/T/ipykernel_48065/3583931412.py:198: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.savefig(f&#39;{figs_dir}/{prefix}_d={d}_r={r}_n={n}_sample={n_sample}_merged.pdf&#39;, dpi=150, bbox_inches=&#39;tight&#39;)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a_em: 5.307956203756592; b_em: -17.060822597203764
a_em: 4.787308227941483; b_em: -17.049310334991098
a_em: 4.722202609506421; b_em: -18.880919529861995
a_em: 4.270241047121607; b_em: -16.464379989942078
a_em: 0.7069147406738415; b_em: -15.74331795418545
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/homebrew/Caskroom/miniforge/base/lib/python3.10/site-packages/IPython/core/events.py:82: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  func(*args, **kwargs)
/opt/homebrew/Caskroom/miniforge/base/lib/python3.10/site-packages/IPython/core/pylabtools.py:152: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.canvas.print_figure(bytes_io, **kw)
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/af490d14dca3d9f7dca8cb4a6ec26e8cca8c0c9b36edc5dccd4dc4ad0deda455.png"><img alt="_images/af490d14dca3d9f7dca8cb4a6ec26e8cca8c0c9b36edc5dccd4dc4ad0deda455.png" src="_images/af490d14dca3d9f7dca8cb4a6ec26e8cca8c0c9b36edc5dccd4dc4ad0deda455.png" style="width: 2642px; height: 843px;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy.linalg</span>

<span class="n">t</span> <span class="o">=</span> <span class="mf">3.5</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">h_test</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">SparsePauliOp</span><span class="o">.</span><span class="n">from_sparse_list</span><span class="p">([(</span><span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">([</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="n">n</span><span class="p">),</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)),</span> <span class="n">n</span><span class="p">),</span> <span class="mi">1</span><span class="p">)],</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)])</span>
<span class="n">h_test_I</span> <span class="o">=</span> <span class="n">h_test</span> <span class="o">+</span> <span class="n">SparsePauliOp</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="o">*</span><span class="n">n</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">h_test</span><span class="p">,</span> <span class="n">h_test_I</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="n">h_test</span><span class="p">)</span> <span class="o">-</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="n">h_test_I</span><span class="p">),</span> <span class="nb">ord</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SparsePauliOp([&#39;IIYXZY&#39;, &#39;ZXYIZI&#39;, &#39;XZXIYX&#39;, &#39;IYXIIZ&#39;, &#39;XZZXII&#39;],
              coeffs=[1.+0.j, 1.+0.j, 1.+0.j, 1.+0.j, 1.+0.j]) SparsePauliOp([&#39;IIYXZY&#39;, &#39;ZXYIZI&#39;, &#39;XZXIYX&#39;, &#39;IYXIIZ&#39;, &#39;XZZXII&#39;, &#39;IIIIII&#39;],
              coeffs=[1.+0.j, 1.+0.j, 1.+0.j, 1.+0.j, 1.+0.j, 1.+0.j])
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.967971893747875
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chem_data</span><span class="p">[</span><span class="s1">&#39;worst_err&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">chem_data</span><span class="p">[</span><span class="s1">&#39;typic_err&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">chem_data</span><span class="p">[</span><span class="s1">&#39;typic_err_trace&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2.2302179854129235e-16, 7.19934981095077e-15, 6.097155734582679e-15, 2.339911936640563e-14, 5.248161751862041e-14, 1.956837438905832e-14, 9.55283347711449e-15, 5.769197914178396e-14, 5.5913378173338915e-14, 3.8539297720884186e-14, 1.1157255815467003e-13, 2.714059180160804e-14, 5.233572086866124e-14, 2.904999755920358e-14, 8.296034770914644e-14, 7.896582515334823e-14, 1.3376340020172536e-13, 1.2639766646870912e-13, 1.5582725515015642e-14, 7.975482479445506e-14, 3.52509499919427e-13, 1.439611259725927e-13, 1.5061516584960855e-13, 2.5717005279260285e-14, 1.1492016911829462e-13, 2.925584923831706e-13, 6.01347774565669e-14, 6.432595727019165e-14, 1.9309668423330524e-13, 5.805411046234418e-14, 8.620549947642086e-14, 3.8577144009026263e-13, 3.8603615253538854e-13, 1.382384372556575e-13, 1.0303665317849752e-13, 6.326199407291347e-13, 1.0324101292297191e-13, 1.7772808602974619e-13, 1.1230475352158088e-13, 9.550403272829116e-14]
[2.2206754384909106e-16, 7.1054504600052e-15, 6.10624636503915e-15, 2.3425708641669486e-14, 5.2624571431115865e-14, 1.9539930243043212e-14, 9.32591247763176e-15, 5.795364418687615e-14, 5.5955258776488345e-14, 3.8524745567912395e-14, 1.1146639735325127e-13, 2.653434063704391e-14, 5.2291514011802983e-14, 2.9087953992589007e-14, 8.27116293860565e-14, 7.882584253513429e-14, 1.3378187793004156e-13, 1.2645440883197973e-13, 1.2212466336154448e-14, 7.971401807573744e-14, 3.5238478837443537e-13, 1.4366286172543063e-13, 1.505462474971238e-13, 2.542410770720267e-14, 1.1479706713827493e-13, 2.9254376727434385e-13, 6.006310043052096e-14, 6.428196857115701e-14, 1.931788120777056e-13, 5.784262110554461e-14, 8.593132502706808e-14, 3.856914893519073e-13, 3.858025014401539e-13, 1.3788972115908563e-13, 1.030286983011168e-13, 6.326050834211684e-13, 1.0236257097991838e-13, 1.7752466386277476e-13, 1.12354571789841e-13, 9.470203657419879e-14]
</pre></div>
</div>
</div>
</div>
</section>
<section id="ising-model-with-three-kinds-of-observables-qiskit-code">
<h2>Ising model with three kinds of observables (Qiskit code)<a class="headerlink" href="#ising-model-with-three-kinds-of-observables-qiskit-code" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit.quantum_info</span> <span class="kn">import</span> <span class="n">SparsePauliOp</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span>

<span class="k">def</span> <span class="nf">get_hamiltonian</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="c1"># List of Hamiltonian terms as 3-tuples containing</span>
    <span class="c1"># (1) the Pauli string,</span>
    <span class="c1"># (2) the qubit indices corresponding to the Pauli string,</span>
    <span class="c1"># (3) the coefficient.</span>
    <span class="n">ZZ_tuples</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;ZZ&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">J</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
    <span class="n">Z_tuples</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;Z&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">-</span><span class="n">h</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">)]</span>
    <span class="n">X_tuples</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">-</span><span class="n">h</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">)]</span>

    <span class="c1"># We create the Hamiltonian as a SparsePauliOp, via the method</span>
    <span class="c1"># `from_sparse_list`, and multiply by the interaction term.</span>
    <span class="n">hamiltonian</span> <span class="o">=</span> <span class="n">SparsePauliOp</span><span class="o">.</span><span class="n">from_sparse_list</span><span class="p">([</span><span class="o">*</span><span class="n">ZZ_tuples</span><span class="p">,</span> <span class="o">*</span><span class="n">Z_tuples</span><span class="p">,</span> <span class="o">*</span><span class="n">X_tuples</span><span class="p">],</span> <span class="n">num_qubits</span><span class="o">=</span><span class="n">L</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">hamiltonian</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">pi</span>

<span class="n">L</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">get_hamiltonian</span><span class="p">(</span><span class="n">L</span><span class="o">=</span><span class="n">L</span><span class="p">,</span> <span class="n">J</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">8</span><span class="p">)</span>

<span class="n">H_array</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span>
<span class="c1"># H</span>

<span class="kn">from</span> <span class="nn">qiskit.quantum_info</span> <span class="kn">import</span> <span class="n">Statevector</span>
<span class="kn">from</span> <span class="nn">qiskit_algorithms</span> <span class="kn">import</span> <span class="n">TimeEvolutionProblem</span>
<span class="kn">from</span> <span class="nn">qiskit_algorithms</span> <span class="kn">import</span> <span class="n">TrotterQRTE</span>
<span class="kn">from</span> <span class="nn">qiskit.primitives</span> <span class="kn">import</span> <span class="n">Estimator</span>
<span class="kn">from</span> <span class="nn">qiskit.synthesis</span> <span class="kn">import</span> <span class="n">ProductFormula</span><span class="p">,</span> <span class="n">SuzukiTrotter</span>

<span class="c1"># final_time = 1.6</span>

<span class="c1"># # First spin up, second spin down</span>
<span class="c1"># # (remember that the labels are interpreted from right to left)</span>
<span class="c1"># initial_state = Statevector.from_label(&quot;10&quot;)</span>

<span class="c1"># problem = TimeEvolutionProblem(H, initial_state=initial_state, time=final_time)</span>

<span class="n">num_timesteps</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">trotter</span> <span class="o">=</span> <span class="n">TrotterQRTE</span><span class="p">(</span><span class="n">product_formula</span><span class="o">=</span><span class="n">SuzukiTrotter</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="n">num_timesteps</span><span class="o">=</span><span class="n">num_timesteps</span><span class="p">,</span> <span class="n">estimator</span><span class="o">=</span><span class="n">Estimator</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">trotter</span><span class="p">)</span>

<span class="n">magnetization_op</span> <span class="o">=</span> <span class="n">SparsePauliOp</span><span class="o">.</span><span class="n">from_sparse_list</span><span class="p">([(</span><span class="s2">&quot;Z&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">L</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">)],</span> <span class="n">num_qubits</span><span class="o">=</span><span class="n">L</span><span class="p">)</span>
<span class="n">correlation_op</span> <span class="o">=</span> <span class="n">SparsePauliOp</span><span class="o">.</span><span class="n">from_sparse_list</span><span class="p">([(</span><span class="s2">&quot;ZZ&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">1.0</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)],</span> <span class="n">num_qubits</span><span class="o">=</span><span class="n">L</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">L</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">final_time</span> <span class="o">=</span> <span class="mf">30.0</span>
<span class="n">initial_state</span> <span class="o">=</span> <span class="n">Statevector</span><span class="o">.</span><span class="n">from_label</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="o">*</span><span class="n">L</span><span class="p">)</span>
<span class="n">initial_state</span> <span class="o">=</span> <span class="n">random_statevector</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">L</span><span class="p">)</span>
<span class="n">problem</span> <span class="o">=</span> <span class="n">TimeEvolutionProblem</span><span class="p">(</span>
    <span class="n">H</span><span class="p">,</span>
    <span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span>
    <span class="n">time</span><span class="o">=</span><span class="n">final_time</span><span class="p">,</span>
    <span class="n">aux_operators</span><span class="o">=</span><span class="p">[</span><span class="n">H</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">H_array</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="n">magnetization_op</span><span class="p">,</span> <span class="n">correlation_op</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">trotter</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span><span class="n">problem</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">observables</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">observables</span><span class="p">)[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">observables</span><span class="o">.</span><span class="n">shape</span>

<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sc</span>


<span class="c1"># # We define a slightly denser time mesh</span>
<span class="c1"># exact_times = np.linspace(0, final_time, 101)</span>

<span class="c1"># # We compute the exact evolution using the exp</span>
<span class="c1"># exact_evolution = [initial_state.evolve(sc.linalg.expm(-1j * time * H_array)) for time in exact_times]</span>
<span class="c1"># exact_energy = np.real([sv.expectation_value(H) for sv in exact_evolution])</span>
<span class="c1"># exact_magnetization = np.real([sv.expectation_value(magnetization_op) for sv in exact_evolution])</span>
<span class="c1"># exact_correlation = np.real([sv.expectation_value(correlation_op) for sv in exact_evolution])</span>

<span class="k">def</span> <span class="nf">exact_evolution_obs</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="n">sv</span> <span class="o">=</span> <span class="n">initial_state</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="n">H_array</span><span class="p">))</span>
    <span class="n">exact_energy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">sv</span><span class="o">.</span><span class="n">expectation_value</span><span class="p">(</span><span class="n">H</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">H_array</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="mi">2</span><span class="p">)))</span>
    <span class="n">exact_magnetization</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">sv</span><span class="o">.</span><span class="n">expectation_value</span><span class="p">(</span><span class="n">magnetization_op</span><span class="p">))</span>
    <span class="n">exact_correlation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">sv</span><span class="o">.</span><span class="n">expectation_value</span><span class="p">(</span><span class="n">correlation_op</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">exact_energy</span><span class="p">,</span> <span class="n">exact_magnetization</span><span class="p">,</span> <span class="n">exact_correlation</span>

<span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">final_time</span><span class="p">,</span> <span class="n">num_timesteps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># includes initial state</span>
<span class="n">obs_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">exact_evolution_obs</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">times</span><span class="p">])</span>
<span class="c1"># print(obs_data)</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">observables</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">obs_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Empirical&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">observables</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">obs_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Empirical&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">observables</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">obs_data</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Empirical&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="c1"># axes[0].plot(exact_times, exact_energy, c=&quot;k&quot;, ls=&quot;:&quot;, label=&quot;Exact&quot;)</span>
<span class="c1"># axes[1].plot(exact_times, exact_magnetization, c=&quot;k&quot;, ls=&quot;:&quot;, label=&quot;Exact&quot;)</span>
<span class="c1"># axes[2].plot(exact_times, exact_correlation, c=&quot;k&quot;, ls=&quot;:&quot;, label=&quot;Exact&quot;)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Energy&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Magnetization&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Correlation&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Observable evolution&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;qiskit_algorithms.time_evolvers.trotterization.trotter_qrte.TrotterQRTE object at 0x10df320b0&gt;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0.98, &#39;Observable evolution&#39;)
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/36bf2f13eb8e5c980143f960e27b77dc7e1a2c1374979fe592a8258693304237.png"><img alt="_images/36bf2f13eb8e5c980143f960e27b77dc7e1a2c1374979fe592a8258693304237.png" src="_images/36bf2f13eb8e5c980143f960e27b77dc7e1a2c1374979fe592a8258693304237.png" style="width: 1060px; height: 609px;" /></a>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#power-law-interaction">Power-law interaction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nearest-neighbor-interaction">Nearest-neighbor interaction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transver-field-ising-tfi">Transver-field Ising (TFI)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#worst-input-largest-singular-value">Worst input (largest singular value)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#error-vs-time">Error VS time</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chemistry">Chemistry</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ising-model-with-three-kinds-of-observables-qiskit-code">Ising model with three kinds of observables (Qiskit code)</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jue Xu
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
       Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>